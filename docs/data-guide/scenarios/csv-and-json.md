---
title: 处理 CSV 和 JSON 文件
description: ''
author: zoinerTejada
ms.date: 02/12/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: cloud-fundamentals
ms.openlocfilehash: 52de5207a5169d2f2a7f701fbc078fb422e61e13
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/23/2019
ms.locfileid: "54486533"
---
# <a name="working-with-csv-and-json-files-for-data-solutions"></a><span data-ttu-id="a7bc5-102">处理数据解决方案的 CSV 和 JSON 文件</span><span class="sxs-lookup"><span data-stu-id="a7bc5-102">Working with CSV and JSON files for data solutions</span></span>

<span data-ttu-id="a7bc5-103">CSV 和 JSON 可能是用于引入、交换和存储非结构化或半结构化数据的最常用格式。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-103">CSV and JSON are likely the most common formats used for ingesting, exchanging, and storing unstructured or semi-structured data.</span></span>

## <a name="about-csv-format"></a><span data-ttu-id="a7bc5-104">关于 CSV 格式</span><span class="sxs-lookup"><span data-stu-id="a7bc5-104">About CSV format</span></span>

<span data-ttu-id="a7bc5-105">CSV（逗号分隔值）文件通常用于在系统之间以纯文本形式交换表格数据。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-105">CSV (comma-separated values) files are commonly used to exchange tabular data between systems in plain text.</span></span> <span data-ttu-id="a7bc5-106">它们通常包含一个提供数据列名的标头行，否则会将数据视为半结构化。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-106">They typically contain a header row that provides column names for the data, but are otherwise considered semi-structured.</span></span> <span data-ttu-id="a7bc5-107">这是因为 CSV 无法自然表示分层数据或关系数据。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-107">This is due to the fact that CSVs cannot naturally represent hierarchical or relational data.</span></span> <span data-ttu-id="a7bc5-108">数据关系通常使用多个 CSV 文件来处理，其中的外键存储在一个或多个文件的列中，但这些文件之间的关系不会由格式本身表示。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-108">Data relationships are typically handled with multiple CSV files, where foreign keys are stored in columns of one or more files, but the relationships between those files are not expressed by the format itself.</span></span> <span data-ttu-id="a7bc5-109">CSV 格式的文件可以使用除逗号以外的其他分隔符，例如制表符或空格。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-109">Files in CSV format may use other delimiters besides commas, such as tabs or spaces.</span></span>

<span data-ttu-id="a7bc5-110">尽管存在一些限制，但 CSV 文件仍是数据交换的热门选项，因为它们受众多业务、消费型和科技型应用程序的支持。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-110">Despite their limitations, CSV files are a popular choice for data exchange, because they are supported by a wide range of business, consumer, and scientific applications.</span></span> <span data-ttu-id="a7bc5-111">例如，数据库和电子表格程序可以导入和导出 CSV 文件。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-111">For example, database and spreadsheet programs can import and export CSV files.</span></span> <span data-ttu-id="a7bc5-112">同样，大多数批处理和流数据处理引擎（例如 Spark 和 Hadoop）原生支持序列化和反序列化 CSV 格式的文件，并提供相应的方式用于在读取时应用架构。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-112">Similarly, most batch and stream data processing engines, such as Spark and Hadoop, natively support serializing and deserializing CSV-formatted files and offer ways to apply a schema on read.</span></span> <span data-ttu-id="a7bc5-113">由于可以使用相应的选项查询数据并以更有效的数据格式存储信息以加速处理，因此可以更轻松地处理数据。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-113">This makes it easier to work with the data, by offering options to query against it and store the information in a more efficient data format for faster processing.</span></span>

## <a name="about-json-format"></a><span data-ttu-id="a7bc5-114">关于 JSON 格式</span><span class="sxs-lookup"><span data-stu-id="a7bc5-114">About JSON format</span></span>

<span data-ttu-id="a7bc5-115">JSON（JavaScript 对象表示法）数据表示为半结构化格式的键值对。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-115">JSON (JavaScript Object Notation) data is represented as key-value pairs in a semi-structured format.</span></span> <span data-ttu-id="a7bc5-116">人们经常将 JSON 与 XML 相对比，因为两者都能以分层格式存储数据，并且表示的子数据内联在其父级中。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-116">JSON is often compared to XML, as both are capable of storing data in hierarchical format, with child data represented inline with its parent.</span></span> <span data-ttu-id="a7bc5-117">两者都是自述性的且可供用户阅读，但 JSON 文档往往要小得多，因此在联机数据交换中非常流行，尤其是在基于 REST 的 Web 服务应用场合中。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-117">Both are self-describing and human readable, but JSON documents tend to be much smaller, leading to their popular use in online data exchange, especially with the advent of REST-based web services.</span></span>

<span data-ttu-id="a7bc5-118">与 CSV 相比，JSON 格式的文件具有以下几种优点：</span><span class="sxs-lookup"><span data-stu-id="a7bc5-118">JSON-formatted files have several benefits over CSV:</span></span>

- <span data-ttu-id="a7bc5-119">JSON 保留分层结构，使我们能够更轻松地在一个文档中保存相关数据，并表示复杂的关系。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-119">JSON maintains hierarchical structures, making it easier to hold related data in a single document and represent complex relationships.</span></span>
- <span data-ttu-id="a7bc5-120">大多数编程语言原生支持将 JSON 反序列化为对象，或提供轻量 JSON 序列化库。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-120">Most programming languages provide native support for deserializing JSON into objects, or provide lightweight JSON serialization libraries.</span></span>
- <span data-ttu-id="a7bc5-121">JSON 支持对象列表，可帮助避免杂乱无章地将列表转换为关系数据模型。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-121">JSON supports lists of objects, helping to avoid messy translations of lists into a relational data model.</span></span>
- <span data-ttu-id="a7bc5-122">JSON 是适用于 MongoDB、Couchbase 和 Azure Cosmos DB 等 NoSQL 数据库的常用文件格式。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-122">JSON is a commonly used file format for NoSQL databases, such as MongoDB, Couchbase, and Azure Cosmos DB.</span></span>

<span data-ttu-id="a7bc5-123">由于来自网络的大量数据已采用 JSON 格式，因此大多数基于 Web 的编程语言都支持本机使用 JSON，或者通过外部库序列化和反序列化 JSON 数据。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-123">Since a lot of data coming across the wire is already in JSON format, most web-based programming languages support working with JSON natively, or through the use of external libraries to serialize and deserialize JSON data.</span></span> <span data-ttu-id="a7bc5-124">由于 JSON 受到普遍支持，因此可以通过数据结构表示法、热数据交换格式和冷数据的数据存储，将它用作逻辑格式。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-124">This universal support for JSON has led to its use in logical formats through data structure representation, exchange formats for hot data, and data storage for cold data.</span></span>

<span data-ttu-id="a7bc5-125">许多批处理和流数据处理引擎原生支持 JSON 序列化和反序列化。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-125">Many batch and stream data processing engines natively support JSON serialization and deserialization.</span></span> <span data-ttu-id="a7bc5-126">尽管最终可以使用性能得到进一步优化的格式（例如 Parquet 或 Avro）存储 JSON 文档中包含的数据，但这些数据充当真实源的原始数据，在按需重新处理数据时，这种性质非常关键。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-126">Though the data contained within JSON documents may ultimately be stored in a more performance-optimized formats, such as Parquet or Avro, it serves as the raw data for source of truth, which is critical for reprocessing the data as needed.</span></span>

## <a name="when-to-use-csv-or-json-formats"></a><span data-ttu-id="a7bc5-127">何时使用 CSV 或 JSON 格式</span><span class="sxs-lookup"><span data-stu-id="a7bc5-127">When to use CSV or JSON formats</span></span>

<span data-ttu-id="a7bc5-128">CSV 更常用于导出和导入数据，或者处理数据以供分析和机器学习。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-128">CSVs are more commonly used for exporting and importing data, or processing it for analytics and machine learning.</span></span> <span data-ttu-id="a7bc5-129">JSON 格式的文件具有相同的优点，但更常用于热数据交换解决方案。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-129">JSON-formatted files have the same benefits, but are more common in hot data exchange solutions.</span></span> <span data-ttu-id="a7bc5-130">JSON 文档通常由执行联机事务的 Web 和移动设备、单向或双向通信的 IoT（物联网）设备，或者与 SaaS 和 PaaS 服务或无服务器体系结构通信的客户端应用程序发送。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-130">JSON documents are often sent by web and mobile devices performing online transactions, by IoT (internet of things) devices for one-way or bidirectional communication, or by client applications communicating with SaaS and PaaS services or serverless architectures.</span></span>

<span data-ttu-id="a7bc5-131">使用 CSV 和 JSON 文件格式都能在不同的系统或设备之间交换数据。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-131">CSV and JSON file formats both make it easy to exchange data between dissimilar systems or devices.</span></span> <span data-ttu-id="a7bc5-132">借助它们的半结构化格式可以灵活传输几乎任何类型的数据，这些格式受到的普遍支持使它们易于使用。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-132">Their semi-structured formats allow flexibility in transferring almost any type of data, and universal support for these formats make them simple to work with.</span></span> <span data-ttu-id="a7bc5-133">如果处理的数据以二进制格式存储，则可以将两者用作原始事实源，以提高查询效率。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-133">Both can be used as the raw source of truth in cases where the processed data is stored in binary formats for more efficient querying.</span></span>

## <a name="working-with-csv-and-json-data-in-azure"></a><span data-ttu-id="a7bc5-134">在 Azure 中处理 CSV 和 JSON 数据</span><span class="sxs-lookup"><span data-stu-id="a7bc5-134">Working with CSV and JSON data in Azure</span></span>

<span data-ttu-id="a7bc5-135">Azure 提供多种解决方案用于根据需要处理 CSV 和 JSON 文件。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-135">Azure provides several solutions for working with CSV and JSON files, depending on your needs.</span></span> <span data-ttu-id="a7bc5-136">这些文件的主要存储位置是 Azure 存储或 Azure Data Lake Store。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-136">The primary landing place for these files is either Azure Storage or Azure Data Lake Store.</span></span> <span data-ttu-id="a7bc5-137">处理这些文件和其他基于文本的文件的大多数 Azure 服务都与任一对象存储服务相集成。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-137">Most Azure services that work with these and other text-based files integrate with either object storage service.</span></span> <span data-ttu-id="a7bc5-138">但是，在某些情况下，可以选择将数据直接导入 Azure SQL 或其他某个数据存储。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-138">In some situations, however, you may opt to directly import the data into Azure SQL or some other data store.</span></span> <span data-ttu-id="a7bc5-139">SQL Server 原生支持存储和处理 JSON 文档，因此，可以轻松[导入和处理这些类型的文件](/sql/relational-databases/json/import-json-documents-into-sql-server)。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-139">SQL Server has native support for storing and working with JSON documents, which makes it easy to [import and process those types of files](/sql/relational-databases/json/import-json-documents-into-sql-server).</span></span> <span data-ttu-id="a7bc5-140">可以使用 SQL 批量导入等实用工具轻松[导入 CSV 文件](/sql/relational-databases/json/import-json-documents-into-sql-server)。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-140">You can use a utility like SQL Bulk Import to easily [import CSV files](/sql/relational-databases/json/import-json-documents-into-sql-server).</span></span>

<span data-ttu-id="a7bc5-141">也可直接从 Azure Blob 存储查询 JSON 文件，不需将其导入 Azure SQL 中。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-141">You can also query JSON files directly from Azure Blob Storage without importing them into Azure SQL.</span></span> <span data-ttu-id="a7bc5-142">如需此方法的完整示例，请参阅[通过 Azure SQL 使用 JSON 文件](https://medium.com/@mauridb/work-with-json-files-with-azure-sql-8946f066ddd4)。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-142">For a complete example of this approach, see [Work with JSON files with Azure SQL](https://medium.com/@mauridb/work-with-json-files-with-azure-sql-8946f066ddd4).</span></span> <span data-ttu-id="a7bc5-143">目前，此选项不适用于 CSV 文件。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-143">Currently this option isn't available for CSV files.</span></span>

<span data-ttu-id="a7bc5-144">可以根据情况对数据执行[批处理](../big-data/batch-processing.md)或[实时处理](../big-data/real-time-processing.md)。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-144">Depending on the scenario, you may perform [batch processing](../big-data/batch-processing.md) or [real-time processing](../big-data/real-time-processing.md) of the data.</span></span>

## <a name="challenges"></a><span data-ttu-id="a7bc5-145">挑战</span><span class="sxs-lookup"><span data-stu-id="a7bc5-145">Challenges</span></span>

<span data-ttu-id="a7bc5-146">使用这些格式时，需要考虑到一些难题：</span><span class="sxs-lookup"><span data-stu-id="a7bc5-146">There are some challenges to consider when working with these formats:</span></span>

- <span data-ttu-id="a7bc5-147">如果数据模型没有任何约束，则 CSV 和 JSON 文件中很容易出现数据损坏（“胡乱输入输出”）。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-147">Without any restraints on the data model, CSV and JSON files are prone to data corruption ("garbage in, garbage out").</span></span> <span data-ttu-id="a7bc5-148">例如，这两种文件都不提供日期/时间对象的表示，因此，该文件格式不会阻止在日期字段中插入“ABC123”。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-148">For instance, there's no notion of a date/time object in either file, so the file format does not prevent you from inserting "ABC123" in a date field, for example.</span></span>

- <span data-ttu-id="a7bc5-149">在处理大数据时，使用 CSV 和 JSON 文件作为冷存储解决方案无法正常缩放。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-149">Using CSV and JSON files as your cold storage solution does not scale well when working with big data.</span></span> <span data-ttu-id="a7bc5-150">在大多数情况下，这些文件将拆分成分区供并行处理，同时无法压缩为二进制格式。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-150">In most cases, they cannot be split into partitions for parallel processing, and cannot be compressed as well as binary formats.</span></span> <span data-ttu-id="a7bc5-151">这通常导致将这些数据处理和存储成 Parquet 和 ORC（优化行纵栏表）等读取优化的格式，这些格式还提供索引以及有关包含的数据的内联统计信息。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-151">This often leads to processing and storing this data into read-optimized formats such as Parquet and ORC (optimized row columnar), which also provide indexes and inline statistics about the data contained.</span></span>

- <span data-ttu-id="a7bc5-152">可能需要对半结构化数据应用架构才能更轻松地执行查询和分析。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-152">You may need to apply a schema on the semi-structured data to make it easier to query and analyze.</span></span> <span data-ttu-id="a7bc5-153">通常，这需要以符合环境数据存储需求的另一种格式存储数据，例如，在数据库中存储。</span><span class="sxs-lookup"><span data-stu-id="a7bc5-153">Typically, this requires storing the data in another form that complies with your environment's data storage needs, such as within a database.</span></span>
