---
title: 在 Azure 上加速基于数码图像的建模
titleSuffix: Azure Example Scenarios
description: 使用 Avere 和 Agisoft PhotoScan 在 Azure 上加速基于数码图像的建模
author: adamboeglin
ms.date: 01/11/2019
ms.topic: example-scenario
ms.service: architecture-center
ms.subservice: example-scenario
ms.custom: cat-team, Linux, HPC
social_image_url: /azure/architecture/example-scenario/infrastructure/media/architecture-image-modeling.png
ms.openlocfilehash: 981d9f01ef12f75d9b292196f754f3a0affa791a
ms.sourcegitcommit: 579c39ff4b776704ead17a006bf24cd4cdc65edd
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/17/2019
ms.locfileid: "59640373"
---
# <a name="accelerate-digital-image-based-modeling-on-azure"></a><span data-ttu-id="c425e-103">在 Azure 上加速基于数码图像的建模</span><span class="sxs-lookup"><span data-stu-id="c425e-103">Accelerate digital image-based modeling on Azure</span></span>

<span data-ttu-id="c425e-104">对于想要在 Azure 基础结构即服务 (IaaS) 上执行基于图像的建模的任何组织，本示例方案可以提供体系结构和设计方面的指导。</span><span class="sxs-lookup"><span data-stu-id="c425e-104">This example scenario provides architecture and design guidance for any organization that wants to perform image-based modeling on Azure infrastructure-as-a-service (IaaS).</span></span> <span data-ttu-id="c425e-105">本方案适合用于在使用高性能存储（可加速处理时间）的 Azure 虚拟机 (VM) 上运行摄影软件。</span><span class="sxs-lookup"><span data-stu-id="c425e-105">The scenario is designed for running photogrammetry software on Azure Virtual Machines (VMs) using high-performance storage that accelerates processing time.</span></span> <span data-ttu-id="c425e-106">环境可按需纵向扩展和缩减，并支持 TB 量级的存储且不牺牲性能。</span><span class="sxs-lookup"><span data-stu-id="c425e-106">The environment can be scaled up and down as needed and supports terabytes of storage without sacrificing performance.</span></span>

## <a name="relevant-use-cases"></a><span data-ttu-id="c425e-107">相关用例</span><span class="sxs-lookup"><span data-stu-id="c425e-107">Relevant use cases</span></span>

<span data-ttu-id="c425e-108">相关用例包括：</span><span class="sxs-lookup"><span data-stu-id="c425e-108">Relevant use cases include:</span></span>

- <span data-ttu-id="c425e-109">建筑物建模和测量、工程结构，以及事故现场取证。</span><span class="sxs-lookup"><span data-stu-id="c425e-109">Modeling and measuring buildings, engineering structures, and forensic accident scenes.</span></span>
- <span data-ttu-id="c425e-110">为电脑游戏和电影创建视觉效果。</span><span class="sxs-lookup"><span data-stu-id="c425e-110">Creating visual effects for computer games and movies.</span></span>
- <span data-ttu-id="c425e-111">在城市规划和其他应用中，使用数码图像间接生成不同规模的对象的测量数据。</span><span class="sxs-lookup"><span data-stu-id="c425e-111">Using digital images to indirectly generate measurements of objects of various scales as in urban planning and other applications.</span></span>

## <a name="architecture"></a><span data-ttu-id="c425e-112">体系结构</span><span class="sxs-lookup"><span data-stu-id="c425e-112">Architecture</span></span>

<span data-ttu-id="c425e-113">本示例将介绍基于 Avere vFXT 存储的 Agisoft PhotoScan 摄影软件的用法。</span><span class="sxs-lookup"><span data-stu-id="c425e-113">This example describes the use of Agisoft PhotoScan photogrammetry software backed by Avere vFXT storage.</span></span> <span data-ttu-id="c425e-114">之所以选择 PhotoScan，是因为它在地理信息系统 (GIS) 应用、文化遗产文档、游戏开发和视觉效果生成等应用中非常流行。</span><span class="sxs-lookup"><span data-stu-id="c425e-114">PhotoScan was chosen for its popularity in geographic information system (GIS) applications, cultural heritage documentation, game development, and visual effects production.</span></span> <span data-ttu-id="c425e-115">它适合用于近距离摄影和航空摄影。</span><span class="sxs-lookup"><span data-stu-id="c425e-115">It is suitable for both close-range photogrammetry and aerial photogrammetry.</span></span>

<span data-ttu-id="c425e-116">本文中的概念适用于基于计划程序的任何高性能计算 (HPC) 工作负荷以及作为基础结构管理的工作节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-116">The concepts in this article apply to any high-performance computing (HPC) workload based on a scheduler and worker nodes managed as infrastructure.</span></span>  <span data-ttu-id="c425e-117">在基准测试期间，为此工作负荷选择了 Avere vFXT，因为它的性能非常优异。</span><span class="sxs-lookup"><span data-stu-id="c425e-117">For this workload, Avere vFXT was selected for its superior performance during benchmark tests.</span></span>  <span data-ttu-id="c425e-118">但是，本方案将存储与处理相分离，以便可以使用其他存储解决方案（请本文档稍后的[替代方案](#alternatives)）。</span><span class="sxs-lookup"><span data-stu-id="c425e-118">However, the scenario decouples the storage from the processing so that other storage solutions can be used (see [alternatives](#alternatives) later in this document).</span></span>

<span data-ttu-id="c425e-119">本体系结构还包含用于控制对 Azure 资源的访问的 Active Directory 域控制器，并通过域名系统 (DNS) 提供内部名称解析。</span><span class="sxs-lookup"><span data-stu-id="c425e-119">This architecture also includes Active Directory domain controllers to control access to Azure resources and provide internal name resolution through the Domain Name System (DNS).</span></span> <span data-ttu-id="c425e-120">跳转盒提供对运行该解决方案的 Windows 和 Linux VM 的管理员访问权限。</span><span class="sxs-lookup"><span data-stu-id="c425e-120">Jump boxes provide administrator access to the Windows and Linux VMs that run the solution.</span></span>

![体系结构示意图](./media/architecture-image-modeling.png)

1. <span data-ttu-id="c425e-122">用户将多个图像提交到 PhotoScan。</span><span class="sxs-lookup"><span data-stu-id="c425e-122">User submits a number of images to PhotoScan.</span></span>
2. <span data-ttu-id="c425e-123">PhotoScan 计划程序在充当头节点的 Windows VM 上运行，并定向用户图像的处理。</span><span class="sxs-lookup"><span data-stu-id="c425e-123">The PhotoScan Scheduler runs on a Windows VM that serves as the head node and directs processing of the user's images.</span></span>
3. <span data-ttu-id="c425e-124">PhotoScan 在照片上搜索通用点，并使用 VM 上运行的 PhotoScan 处理节点和图形处理单元 (GPU) 构造几何图形（网格）。</span><span class="sxs-lookup"><span data-stu-id="c425e-124">PhotoScan searches for common points on the photographs and constructs the geometry (mesh) using the PhotoScan processing nodes running on VMs with graphics processing units (GPUs).</span></span>
4. <span data-ttu-id="c425e-125">Avere vFXT 在 Azure 上提供基于网络文件系统版本 3 (NFSv3) 的、至少包括四个 VM 的高性能存储解决方案。</span><span class="sxs-lookup"><span data-stu-id="c425e-125">Avere vFXT provides a high-performance storage solution on Azure based on Network File System version 3 (NFSv3) and comprised of at least four VMs.</span></span>
5. <span data-ttu-id="c425e-126">PhotoScan 呈现模型。</span><span class="sxs-lookup"><span data-stu-id="c425e-126">PhotoScan renders the model.</span></span>

### <a name="components"></a><span data-ttu-id="c425e-127">组件</span><span class="sxs-lookup"><span data-stu-id="c425e-127">Components</span></span>

- <span data-ttu-id="c425e-128">[Agisoft PhotoScan](http://www.agisoft.com/)：PhotoScan 计划程序在 Windows 2016 Server VM 上运行，处理节点使用五个包含 GPU 的、运行 CentOS Linux 7.5 的 VM。</span><span class="sxs-lookup"><span data-stu-id="c425e-128">[Agisoft PhotoScan](http://www.agisoft.com/): The PhotoScan Scheduler runs on a Windows 2016 Server VM, and the processing nodes use five VMs with GPUs that run CentOS Linux 7.5.</span></span>
- <span data-ttu-id="c425e-129">[Avere vFXT](/azure/avere-vfxt/avere-vfxt-overview) 是一个文件缓存解决方案，它使用对象存储和传统的网络连接存储 (NAS) 来优化大型数据集的存储。</span><span class="sxs-lookup"><span data-stu-id="c425e-129">[Avere vFXT](/azure/avere-vfxt/avere-vfxt-overview) is a file caching solution that uses object storage and traditional network-attached storage (NAS) to optimize storage of large datasets.</span></span> <span data-ttu-id="c425e-130">其中包括：</span><span class="sxs-lookup"><span data-stu-id="c425e-130">It includes:</span></span>
  - <span data-ttu-id="c425e-131">Avere 控制器。</span><span class="sxs-lookup"><span data-stu-id="c425e-131">Avere Controller.</span></span> <span data-ttu-id="c425e-132">此 VM 执行用于安装 Avere vFXT 群集和运行 Ubuntu 18.04 LTS 的脚本。</span><span class="sxs-lookup"><span data-stu-id="c425e-132">This VM executes the script that installs the Avere vFXT cluster and runs Ubuntu 18.04 LTS.</span></span> <span data-ttu-id="c425e-133">以后可以使用该 VM 来添加或删除群集节点，以及销毁群集。</span><span class="sxs-lookup"><span data-stu-id="c425e-133">The VM can be used later to add or remove cluster nodes and to destroy the cluster as well.</span></span>
  - <span data-ttu-id="c425e-134">vFXT 群集。</span><span class="sxs-lookup"><span data-stu-id="c425e-134">vFXT cluster.</span></span> <span data-ttu-id="c425e-135">至少使用三个 VM，对基于 Avere OS 5.0.2.1 的每个 Avere vFXT 节点各使用一个。</span><span class="sxs-lookup"><span data-stu-id="c425e-135">At least three VMs are used, one for each of the Avere vFXT nodes based on Avere OS 5.0.2.1.</span></span> <span data-ttu-id="c425e-136">这些 VM 构成了附加到 Azure Blob 存储的 vFXT 群集。</span><span class="sxs-lookup"><span data-stu-id="c425e-136">These VMs form the vFXT cluster, which is attached to Azure Blob storage.</span></span>
- <span data-ttu-id="c425e-137">[Microsoft Active Directory 域控制器](/windows/desktop/ad/active-directory-domain-services)可让主机访问域资源以及提供 DNS 名称解析。</span><span class="sxs-lookup"><span data-stu-id="c425e-137">[Microsoft Active Directory domain controllers](/windows/desktop/ad/active-directory-domain-services) allow the host access to domain resources and provide DNS name resolution.</span></span> <span data-ttu-id="c425e-138">Avere vFXT 中添加的记录数&mdash;等 vFXT 群集中的每个 A 记录指向 Avere vFXT 的每个节点的 IP 地址。</span><span class="sxs-lookup"><span data-stu-id="c425e-138">Avere vFXT adds a number of A records &mdash; for example, each A record in a vFXT cluster points to the IP address of each Avere vFXT node.</span></span> <span data-ttu-id="c425e-139">在此设置中，所有 VM 使用轮循模式访问 vFXT 导出内容。</span><span class="sxs-lookup"><span data-stu-id="c425e-139">In this setup, all VMs use the round-robin pattern to access vFXT exports.</span></span>
- <span data-ttu-id="c425e-140">[其他 VM](/azure/virtual-machines/) 充当跳转盒，管理员使用它们来访问计划程序和处理节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-140">[Other VMs](/azure/virtual-machines/) serve as jump boxes used by the administrator to access the scheduler and processing nodes.</span></span> <span data-ttu-id="c425e-141">必须提供 Windows 跳转盒才能让管理员通过远程桌面协议访问头节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-141">The Windows jumpbox is mandatory to allow the administrator to access the head node via remote desktop protocol.</span></span> <span data-ttu-id="c425e-142">第二个跳转盒是可选的，运行用于管理工作节点的 Linux。</span><span class="sxs-lookup"><span data-stu-id="c425e-142">The second jumpbox is optional and runs Linux for administration of the worker nodes.</span></span>
- <span data-ttu-id="c425e-143">[网络安全组](/azure/virtual-network/manage-network-security-group) (NSG) 限制对公共 IP 地址 (PIP) 的访问，并允许端口 3389 和 22 访问附加到跳转盒子网的 VM。</span><span class="sxs-lookup"><span data-stu-id="c425e-143">[Network security groups](/azure/virtual-network/manage-network-security-group) (NSGs) limit access to the public IP address (PIP) and allow ports 3389 and 22 for access to the VMs attached to the Jumpbox subnet.</span></span>
- <span data-ttu-id="c425e-144">[虚拟网络对等互连](/azure/virtual-network/virtual-network-peering-overview)将 PhotoScan 虚拟网络连接到 Avere 虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="c425e-144">[Virtual network peering](/azure/virtual-network/virtual-network-peering-overview) connects a PhotoScan virtual network to an Avere virtual network.</span></span>
- <span data-ttu-id="c425e-145">[Azure Blob 存储](/azure/storage/blobs/storage-blobs-introduction)与用作核心文件管理器的 Avere vFXT 配合工作，存储正在处理的提交数据。</span><span class="sxs-lookup"><span data-stu-id="c425e-145">[Azure Blob storage](/azure/storage/blobs/storage-blobs-introduction) works with Avere vFXT as the core filer to store the committed data being processed.</span></span> <span data-ttu-id="c425e-146">Avere vFXT 识别 Azure Blob 中存储的活动数据，并将其分层到固态硬盘 (SSD)。当 PhotoScan 作业正在运行时，SSD 用于缓存其计算节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-146">Avere vFXT identifies the active data stored in Azure Blob and tiers it into solid-state drives (SSD) used for caching in its compute nodes while a PhotoScan job is running.</span></span> <span data-ttu-id="c425e-147">如果进行了更改，数据将以异步方式提交回到核心文件管理器。</span><span class="sxs-lookup"><span data-stu-id="c425e-147">If changes are made, the data is asynchronously committed back to the core filer.</span></span>
- <span data-ttu-id="c425e-148">[Azure Key Vault](/azure/key-vault/key-vault-overview) 用于存储管理员密码和 PhotoScan 激活码。</span><span class="sxs-lookup"><span data-stu-id="c425e-148">[Azure Key Vault](/azure/key-vault/key-vault-overview) is used to store the administrator passwords and PhotoScan activation code.</span></span>

### <a name="alternatives"></a><span data-ttu-id="c425e-149">备选项</span><span class="sxs-lookup"><span data-stu-id="c425e-149">Alternatives</span></span>

- <span data-ttu-id="c425e-150">若要利用 Azure 服务来管理 HPC 群集，请使用 Azure CycleCloud 或 Azure Batch 等工具，而不要通过模板或脚本管理资源。</span><span class="sxs-lookup"><span data-stu-id="c425e-150">To take advantage of Azure services for managing an HPC cluster, use tools such as Azure CycleCloud or Azure Batch instead of managing the resources through templates or scripts.</span></span>
- <span data-ttu-id="c425e-151">在 Azure 上，部署 BeeGFS 并行虚拟文件系统而不是 Avere vFXT 作为后端存储。</span><span class="sxs-lookup"><span data-stu-id="c425e-151">Deploy the BeeGFS parallel virtual file system as the back-end storage on Azure instead of Avere vFXT.</span></span> <span data-ttu-id="c425e-152">在 Azure 上使用 [BeeGFS 模板](https://github.com/paulomarquesc/beegfs-template)部署此端到端解决方案。</span><span class="sxs-lookup"><span data-stu-id="c425e-152">Use the [BeeGFS template](https://github.com/paulomarquesc/beegfs-template) to deploy this end-to-end solution on Azure.</span></span>
- <span data-ttu-id="c425e-153">部署所选的存储解决方案，例如 GlusterFS、Lustre 或 Windows Storage Spaces Direct。</span><span class="sxs-lookup"><span data-stu-id="c425e-153">Deploy the storage solution of your choice, such as GlusterFS, Lustre, or Windows Storage Spaces Direct.</span></span> <span data-ttu-id="c425e-154">为此，请编辑 [PhotoScan 模板](https://github.com/paulomarquesc/photoscan-template)，使之能够与所需的存储解决方案配合工作。</span><span class="sxs-lookup"><span data-stu-id="c425e-154">To do this, edit the [PhotoScan template](https://github.com/paulomarquesc/photoscan-template) to work with the storage solution you want.</span></span>
- <span data-ttu-id="c425e-155">部署使用 Windows 操作系统而不是默认的 Linux 操作系统的工作节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-155">Deploy the worker nodes with the Windows operating system instead of Linux, the default option.</span></span> <span data-ttu-id="c425e-156">选择 Windows 节点时，部署模板不会执行存储集成选项。</span><span class="sxs-lookup"><span data-stu-id="c425e-156">When choosing Windows nodes, storage integration options are not executed by the deployment templates.</span></span> <span data-ttu-id="c425e-157">必须手动将环境与现有存储解决方案相集成，或者根据[存储库](https://github.com/paulomarquesc/photoscan-template/blob/master/docs/AverePostDeploymentSteps.md)中所述，自定义 PhotoScan 模板以提供此类自动化功能。</span><span class="sxs-lookup"><span data-stu-id="c425e-157">You must manually integrate the environment with an existing storage solution, or customize the PhotoScan template to provide such automation, as described in the [repository](https://github.com/paulomarquesc/photoscan-template/blob/master/docs/AverePostDeploymentSteps.md).</span></span>

## <a name="considerations"></a><span data-ttu-id="c425e-158">注意事项</span><span class="sxs-lookup"><span data-stu-id="c425e-158">Considerations</span></span>

<span data-ttu-id="c425e-159">本方案专门用来为 HPC 工作负荷（无论是部署在 Windows 还是 Linux 上）提供高性能存储。</span><span class="sxs-lookup"><span data-stu-id="c425e-159">This scenario is designed specifically to provide high-performance storage for an HPC workload, whether it is deployed on Windows or Linux.</span></span> <span data-ttu-id="c425e-160">一般而言，HPC 工作负荷的存储配置应该符合对本地部署使用的相应最佳做法。</span><span class="sxs-lookup"><span data-stu-id="c425e-160">In general, the storage configuration of the HPC workload should match the appropriate best practices used for on-premises deployments.</span></span>

<span data-ttu-id="c425e-161">部署注意事项取决于所用的应用程序和服务，但需要记住几条额外的说明：</span><span class="sxs-lookup"><span data-stu-id="c425e-161">Deployment considerations depend on the applications and services used, but a few notes apply:</span></span>

- <span data-ttu-id="c425e-162">生成高性能应用程序时，请使用 Azure 高级存储并[优化应用层](/azure/virtual-machines/windows/premium-storage-performance)。</span><span class="sxs-lookup"><span data-stu-id="c425e-162">When building high-performance applications, use Azure Premium Storage and [optimize the application layer](/azure/virtual-machines/windows/premium-storage-performance).</span></span> <span data-ttu-id="c425e-163">使用 Azure Blob 存储[热层访问](/azure/storage/blobs/storage-blob-storage-tiers)来优化频繁访问的存储。</span><span class="sxs-lookup"><span data-stu-id="c425e-163">Optimize storage for frequent access using Azure Blob [hot tier access](/azure/storage/blobs/storage-blob-storage-tiers).</span></span>
- <span data-ttu-id="c425e-164">使用存储资源[复制选项](/azure/storage/common/storage-redundancy)满足可用性和性能需求的。</span><span class="sxs-lookup"><span data-stu-id="c425e-164">Use a storage [replication option](/azure/storage/common/storage-redundancy) that meets your availability and performance requirements.</span></span> <span data-ttu-id="c425e-165">在本示例中，默认为 Avere vFXT 配置了高可用性和本地冗余存储 (LRS)。</span><span class="sxs-lookup"><span data-stu-id="c425e-165">In this example, Avere vFXT is configured for high availability by default, with locally redundant storage (LRS).</span></span> <span data-ttu-id="c425e-166">为实现负载均衡，此设置中的所有 VM 使用轮循模式访问 vFXT 导出内容。</span><span class="sxs-lookup"><span data-stu-id="c425e-166">For load balancing, all VMs in this setup use the round-robin pattern to access vFXT exports.</span></span>
- <span data-ttu-id="c425e-167">如果 Windows 客户端和 Linux 客户端都消耗后端存储，请使用 Samba 服务器来支持 Windows 节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-167">If the backend storage will be consumed by both Windows clients and Linux clients, use Samba servers to support the Windows nodes.</span></span> <span data-ttu-id="c425e-168">本示例方案的某个基于 BeeGFS 的[版本](https://github.com/paulomarquesc/beegfs-template)使用 Samba 来支持 Windows 上运行的 HPC 工作负荷 (PhotoScan) 的计划程序节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-168">A [version](https://github.com/paulomarquesc/beegfs-template) of this example scenario based on BeeGFS uses Samba to support the scheduler node of the HPC workload (PhotoScan) running on Windows.</span></span> <span data-ttu-id="c425e-169">部署的负载均衡器充当 DNS 轮循机制的智能替代项。</span><span class="sxs-lookup"><span data-stu-id="c425e-169">A load balancer is deployed to act like a smart replacement for DNS round robin.</span></span>
- <span data-ttu-id="c425e-170">使用最适合 [Windows](/azure/virtual-machines/windows/sizes-hpc) 或 [Linux](/azure/virtual-machines/linux/sizes?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) 工作负荷的 VM 类型运行 HPC 应用程序。</span><span class="sxs-lookup"><span data-stu-id="c425e-170">Run HPC applications using the VM type best suited for your [Windows](/azure/virtual-machines/windows/sizes-hpc) or [Linux](/azure/virtual-machines/linux/sizes?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) workload.</span></span>
- <span data-ttu-id="c425e-171">若要将 HPC 工作负荷与存储资源相隔离，请将其部署在其自身的虚拟网络中，然后使用虚拟网络[对等互连](/azure/virtual-network/virtual-network-peering-overview)连接两者。</span><span class="sxs-lookup"><span data-stu-id="c425e-171">To isolate the HPC workload from the storage resources, deploy each in its own virtual network, then use virtual network [peering](/azure/virtual-network/virtual-network-peering-overview) to connect the two.</span></span> <span data-ttu-id="c425e-172">对等互连可在不同虚拟网络中的资源之间创建低延迟、高带宽连接，并仅通过专用 IP 地址在 Microsoft 主干基础结构中路由流量。</span><span class="sxs-lookup"><span data-stu-id="c425e-172">Peering creates a low-latency, high-bandwidth connection between resources in different virtual networks and routes traffic through the Microsoft backbone infrastructure through private IP addresses only.</span></span>

### <a name="security"></a><span data-ttu-id="c425e-173">安全</span><span class="sxs-lookup"><span data-stu-id="c425e-173">Security</span></span>

<span data-ttu-id="c425e-174">本示例重点描述如何为 HPC 工作负荷部署高性能存储解决方案，而不是安全解决方案。</span><span class="sxs-lookup"><span data-stu-id="c425e-174">This example focuses on deploying a high-performance storage solution for an HPC workload and is not a security solution.</span></span> <span data-ttu-id="c425e-175">如需进行任何更改，请务必与安全团队协商。</span><span class="sxs-lookup"><span data-stu-id="c425e-175">Make sure to involve your security team for any changes.</span></span>

<span data-ttu-id="c425e-176">为提高安全性，本示例基础结构允许所有 Windows VM 加入域，并使用 Active Directory 进行集中式身份验证。</span><span class="sxs-lookup"><span data-stu-id="c425e-176">For added security, this example infrastructure enables all the Windows VMs to be domain-joined and uses Active Directory for central authentication.</span></span> <span data-ttu-id="c425e-177">它还为所有 VM 提供自定义 DNS 服务。</span><span class="sxs-lookup"><span data-stu-id="c425e-177">It also provides custom DNS services for all VMs.</span></span> <span data-ttu-id="c425e-178">为了帮助保护环境，此模板依赖于[网络安全组 (NSG)](/azure/virtual-network/security-overview)。</span><span class="sxs-lookup"><span data-stu-id="c425e-178">To help protect the environment, this template relies on [network security groups (NSGs)](/azure/virtual-network/security-overview).</span></span> <span data-ttu-id="c425e-179">NSG 提供基本的流量筛选器和安全规则。</span><span class="sxs-lookup"><span data-stu-id="c425e-179">NSGs offer basic traffic filters and security rules.</span></span>

<span data-ttu-id="c425e-180">请考虑使用以下选项来进一步提高本方案的安全性：</span><span class="sxs-lookup"><span data-stu-id="c425e-180">Consider the following options to further improve security in this scenario:</span></span>

- <span data-ttu-id="c425e-181">使用 Fortinet、Checkpoint 和 Juniper 等网络虚拟设备。</span><span class="sxs-lookup"><span data-stu-id="c425e-181">Use network virtual appliances such as Fortinet, Checkpoint, and Juniper.</span></span>
- <span data-ttu-id="c425e-182">对资源组应用[基于角色的访问控制](/azure/role-based-access-control/overview)。</span><span class="sxs-lookup"><span data-stu-id="c425e-182">Apply [role-based access control](/azure/role-based-access-control/overview) to the resource groups.</span></span>
- <span data-ttu-id="c425e-183">如果通过 Internet 访问跳转盒，请启用 VM [JIT](/azure/security-center/security-center-just-in-time)。</span><span class="sxs-lookup"><span data-stu-id="c425e-183">Enable VM [JIT](/azure/security-center/security-center-just-in-time) access if jump boxes are accessed via the Internet.</span></span>
- <span data-ttu-id="c425e-184">使用 [Azure Key Vault](/azure/key-vault/quick-create-portal) 存储管理员帐户使用的密码。</span><span class="sxs-lookup"><span data-stu-id="c425e-184">Use [Azure Key Vault](/azure/key-vault/quick-create-portal) to store the passwords used by administrator accounts.</span></span>

## <a name="pricing"></a><span data-ttu-id="c425e-185">定价</span><span class="sxs-lookup"><span data-stu-id="c425e-185">Pricing</span></span>

<span data-ttu-id="c425e-186">运行此方案的成本可以极大地改变取决于多种因素。</span><span class="sxs-lookup"><span data-stu-id="c425e-186">The cost of running this scenario can vary greatly depending on multiple factors.</span></span>  <span data-ttu-id="c425e-187">具体的成本取决于 VM 的数量和大小、所需的存储量以及完成作业所需的时间。</span><span class="sxs-lookup"><span data-stu-id="c425e-187">The number and size of VMs, how much storage is required, and the amount of time to complete a job will determine your cost.</span></span>

<span data-ttu-id="c425e-188">[Azure 定价计算器](https://azure.com/e/42362ddfd2e245a28a8e78bc609c80f3)中的以下示例成本配置文件基于 Avere vFXT 和 PhotoScan 的典型配置：</span><span class="sxs-lookup"><span data-stu-id="c425e-188">The following sample cost profile in the [Azure pricing calculator](https://azure.com/e/42362ddfd2e245a28a8e78bc609c80f3) is based on a typical configuration for Avere vFXT and PhotoScan:</span></span>

- <span data-ttu-id="c425e-189">1 个 A1\_v2 Ubuntu VM，用于运行 Avere 控制器。</span><span class="sxs-lookup"><span data-stu-id="c425e-189">1 A1\_v2 Ubuntu VM to run the Avere controller.</span></span>
- <span data-ttu-id="c425e-190">3 个 D16s\_v3 Avere OS VM，构成 vFXT 群集的每个 Avere vFXT 节点各使用 1 个。</span><span class="sxs-lookup"><span data-stu-id="c425e-190">3 D16s\_v3 Avere OS VMs, one for each of the Avere vFXT nodes that form the vFXT cluster.</span></span>
- <span data-ttu-id="c425e-191">5 个 NC24\_v2 Linux VM，用于提供 PhotoScan 处理节点所需的 GPU。</span><span class="sxs-lookup"><span data-stu-id="c425e-191">5 NC24\_v2 Linux VMs to provide the GPUs needed by the PhotoScan processing nodes.</span></span>
- <span data-ttu-id="c425e-192">1 个 D8s\_v3 CentOS VM，用于 PhotoScan 计划程序节点。</span><span class="sxs-lookup"><span data-stu-id="c425e-192">1 D8s\_v3 CentOS VM for the PhotoScan scheduler node.</span></span>
- <span data-ttu-id="c425e-193">1 个 DS2\_v2 CentOS，用作管理员跳转盒。</span><span class="sxs-lookup"><span data-stu-id="c425e-193">1 DS2\_v2 CentOS used as administrator jumpbox.</span></span>
- <span data-ttu-id="c425e-194">2 个 DS2\_v2 VM，用于 Active Directory 域控制器。</span><span class="sxs-lookup"><span data-stu-id="c425e-194">2 DS2\_v2 VMs for the Active Directory domain controllers.</span></span>
- <span data-ttu-id="c425e-195">高级托管磁盘。</span><span class="sxs-lookup"><span data-stu-id="c425e-195">Premium managed disks.</span></span>
- <span data-ttu-id="c425e-196">常规用途 v2 (GPv2) Blob 存储，使用 LRS 并支持热层访问（只有 GPv2 存储帐户能够公开访问层属性）。</span><span class="sxs-lookup"><span data-stu-id="c425e-196">General purpose v2 (GPv2) Blob storage with LRS and hot tier access (only GPv2 storage accounts expose the Access Tier attribute).</span></span>
- <span data-ttu-id="c425e-197">支持 10 TB 数据传输的虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="c425e-197">Virtual network with support for 10 TB data transfer.</span></span>

<span data-ttu-id="c425e-198">有关本体系结构的详细信息，请参阅[电子书](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/)。</span><span class="sxs-lookup"><span data-stu-id="c425e-198">For details about this architecture, see the [ebook](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/).</span></span> <span data-ttu-id="c425e-199">若要了解特定用例的定价变化，请根据预期部署在定价计算器中选择不同的 VM 大小。</span><span class="sxs-lookup"><span data-stu-id="c425e-199">To see how the pricing would change for your particular use case, choose different VM sizes in the pricing calculator to match your expected deployment.</span></span>

## <a name="deployment"></a><span data-ttu-id="c425e-200">部署</span><span class="sxs-lookup"><span data-stu-id="c425e-200">Deployment</span></span>

<span data-ttu-id="c425e-201">有关部署本体系结构的分步说明，包括使用 Avere FxT 或 BeeGFS 所在满足的所有先决条件，请下载电子书：[使用 Avere vFXT for Azure 或 BeeGFS 在 Azure 上部署 Agisoft PhotoScan](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/)。</span><span class="sxs-lookup"><span data-stu-id="c425e-201">For step-by-step instructions for deploying this architecture, including all the prerequisites for using either Avere FxT or BeeGFS, download the ebook: [Deploy Agisoft PhotoScan on Azure With Avere vFXT for Azure or BeeGFS](https://azure.microsoft.com/en-us/resources/deploy-agisoft-photoscan-on-azure-with-azere-vfxt-for-azure-or-beegfs/).</span></span>

## <a name="related-resources"></a><span data-ttu-id="c425e-202">相关资源</span><span class="sxs-lookup"><span data-stu-id="c425e-202">Related resources</span></span>

<span data-ttu-id="c425e-203">以下资源提供了有关本方案中使用的组件的详细信息，以及 Azure 上的批量计算的替代方法。</span><span class="sxs-lookup"><span data-stu-id="c425e-203">The following resources will provide more information on the components utilized in this scenario, along with alternative approaches for batch computing on Azure.</span></span>

- <span data-ttu-id="c425e-204">[Avere vFXT for Azure](/azure/avere-vfxt/avere-vfxt-overview) 概述</span><span class="sxs-lookup"><span data-stu-id="c425e-204">Overview of [Avere vFXT for Azure](/azure/avere-vfxt/avere-vfxt-overview)</span></span>
- <span data-ttu-id="c425e-205">[Agisoft PhotoScan](https://www.agisoft.com/) 主页</span><span class="sxs-lookup"><span data-stu-id="c425e-205">[Agisoft PhotoScan](https://www.agisoft.com/) home Page</span></span>
- [<span data-ttu-id="c425e-206">Azure 存储性能和可伸缩性清单</span><span class="sxs-lookup"><span data-stu-id="c425e-206">Azure Storage Performance and Scalability Checklist</span></span>](/azure/storage/common/storage-performance-checklist)
- <span data-ttu-id="c425e-207">[Microsoft Azure 上的并行虚拟文件系统：Lustre、GlusterFS 和 BeeGFS 的性能测试](https://azure.microsoft.com/mediahandler/files/resourcefiles/parallel-virtual-file-systems-on-microsoft-azure/Parallel_Virtual_File_Systems_on_Microsoft_Azure.pdf) (PDF)</span><span class="sxs-lookup"><span data-stu-id="c425e-207">[Parallel Virtual File Systems on Microsoft Azure: Performance tests of Lustre, GlusterFS, and BeeGFS](https://azure.microsoft.com/mediahandler/files/resourcefiles/parallel-virtual-file-systems-on-microsoft-azure/Parallel_Virtual_File_Systems_on_Microsoft_Azure.pdf) (PDF)</span></span>
- <span data-ttu-id="c425e-208">[Azure 上的计算机辅助工程 (CAE)](/azure/architecture/example-scenario/apps/hpc-saas) 示例方案</span><span class="sxs-lookup"><span data-stu-id="c425e-208">An example scenario for [computer-aided engineering (CAE) on Azure](/azure/architecture/example-scenario/apps/hpc-saas)</span></span>
- <span data-ttu-id="c425e-209">[HPC on Azure](https://azure.microsoft.com/en-us/solutions/high-performance-computing/) 主页</span><span class="sxs-lookup"><span data-stu-id="c425e-209">[HPC on Azure](https://azure.microsoft.com/en-us/solutions/high-performance-computing/) home page</span></span>
- <span data-ttu-id="c425e-210">[大型计算：HPC 和 Microsoft Batch](https://azure.microsoft.com/en-us/solutions/big-compute/) 概述</span><span class="sxs-lookup"><span data-stu-id="c425e-210">Overview of [Big Compute: HPC &amp; Microsoft Batch](https://azure.microsoft.com/en-us/solutions/big-compute/)</span></span>