---
title: 建筑行业中的 IoT 和数据分析
titleSuffix: Azure Example Scenarios
description: 使用 IoT 设备和数据分析提供建筑项目的全面管理和运营。
author: alexbuckgit
ms.date: 08/29/2018
ms.topic: example-scenario
ms.service: architecture-center
ms.subservice: example-scenario
ms.custom: IoT, data-analytics
social_image_url: /azure/architecture/example-scenario/data/media/architecture-big-data-with-iot.png
ms.openlocfilehash: bf963c0467acd4ecbb4bdca6272385d7532167f2
ms.sourcegitcommit: c053e6edb429299a0ad9b327888d596c48859d4a
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/20/2019
ms.locfileid: "58244768"
---
# <a name="iot-and-data-analytics-in-the-construction-industry"></a><span data-ttu-id="b2939-103">建筑行业中的 IoT 和数据分析</span><span class="sxs-lookup"><span data-stu-id="b2939-103">IoT and data analytics in the construction industry</span></span>

<span data-ttu-id="b2939-104">本示例方案与需要将数据从许多 IoT 设备集成到综合性数据分析体系结构，以改善和自动化决策的建筑业组织解决方案相关。</span><span class="sxs-lookup"><span data-stu-id="b2939-104">This example scenario is relevant to organizations building solutions that integrate data from many IoT devices into a comprehensive data analysis architecture to improve and automate decision making.</span></span> <span data-ttu-id="b2939-105">潜在的应用范围包括建筑、采矿、制造，或涉及到从多个基于 IoT 的数据输入中引入大量数据的行业。</span><span class="sxs-lookup"><span data-stu-id="b2939-105">Potential applications include construction, mining, manufacturing, or other industry solutions involving large volumes of data from many IoT-based data inputs.</span></span>

<span data-ttu-id="b2939-106">在本方案中，某家建筑设备制造商需要制造一些使用 IoT 和 GPS 技术发出遥测数据的车辆、仪表和无人机。</span><span class="sxs-lookup"><span data-stu-id="b2939-106">In this scenario, a construction equipment manufacturer builds vehicles, meters, and drones that use IoT and GPS technologies to emit telemetry data.</span></span> <span data-ttu-id="b2939-107">该公司希望将其数据体系结构现代化，以便更好地监视工作条件和设备运行状况。</span><span class="sxs-lookup"><span data-stu-id="b2939-107">The company wants to modernize their data architecture to better monitor operating conditions and equipment health.</span></span> <span data-ttu-id="b2939-108">使用本地基础设施取代公司的旧式解决方案不仅费时费力，而且不能提供足够的可伸缩性来应对预期的数据量。</span><span class="sxs-lookup"><span data-stu-id="b2939-108">Replacing the company's legacy solution using on-premises infrastructure would be both time and labor intensive, and would not be able to scale sufficiently to handle the anticipated data volume.</span></span>

<span data-ttu-id="b2939-109">该公司希望构建一个基于云的“智能建筑”解决方案。</span><span class="sxs-lookup"><span data-stu-id="b2939-109">The company wants to build a cloud-based "smart construction" solution.</span></span> <span data-ttu-id="b2939-110">该解决方案全面收集建筑场地的数据集，并将场地中各个要素的操作和维护自动化。</span><span class="sxs-lookup"><span data-stu-id="b2939-110">It should gather a comprehensive set of data for a construction site and automate the operation and maintenance of the various elements of the site.</span></span> <span data-ttu-id="b2939-111">该公司的目标包括：</span><span class="sxs-lookup"><span data-stu-id="b2939-111">The company's goals include:</span></span>

- <span data-ttu-id="b2939-112">集成并分析所有建筑场地的设备和数据，以尽量减少设备停机和失窃情况。</span><span class="sxs-lookup"><span data-stu-id="b2939-112">Integrating and analyzing all construction site equipment and data to minimize equipment downtime and reduce theft.</span></span>
- <span data-ttu-id="b2939-113">远程自动控制建筑设备，以缓解劳动力短缺造成的影响，最终减少工人数目，并使技能不足的工人能够胜任。</span><span class="sxs-lookup"><span data-stu-id="b2939-113">Remotely and automatically controlling construction equipment to mitigate the effects of a labor shortage, ultimately requiring fewer workers and enabling lower-skilled workers to succeed.</span></span>
- <span data-ttu-id="b2939-114">尽量降低支持性基础设施的工作成本和人力要求，同时提高生产率和安全性。</span><span class="sxs-lookup"><span data-stu-id="b2939-114">Minimizing the operating costs and labor requirements for the supporting infrastructure, while increasing productivity and safety.</span></span>
- <span data-ttu-id="b2939-115">轻松扩展基础设施，以应对遥测数据的不断增加。</span><span class="sxs-lookup"><span data-stu-id="b2939-115">Easily scaling the infrastructure to support increases in telemetry data.</span></span>
- <span data-ttu-id="b2939-116">在不损害系统可用性的前提下，通过预配资源来符合国家/地区的所有相关法律要求。</span><span class="sxs-lookup"><span data-stu-id="b2939-116">Complying with all relevant legal requirements by provisioning resources in-country without compromising system availability.</span></span>
- <span data-ttu-id="b2939-117">使用开源软件，最大化对当前工人技能的投资回报。</span><span class="sxs-lookup"><span data-stu-id="b2939-117">Using open-source software to maximize the investment in workers' current skills.</span></span>

<span data-ttu-id="b2939-118">客户可以使用 IoT 中心和 HDInsight 等 Azure 托管服务快速生成和部署综合性解决方案，同时较低运营成本。</span><span class="sxs-lookup"><span data-stu-id="b2939-118">Using managed Azure services such as IoT Hub and HDInsight will allow the customer to rapidly build and deploy a comprehensive solution with a lower operating cost.</span></span> <span data-ttu-id="b2939-119">如果你有其他数据分析方面的需求，应该查看 [Azure 中提供的完全托管式数据分析服务][product-category]列表。</span><span class="sxs-lookup"><span data-stu-id="b2939-119">If you have additional data analytics needs, you should review the list of available [fully managed data analytics services in Azure][product-category].</span></span>

## <a name="relevant-use-cases"></a><span data-ttu-id="b2939-120">相关用例</span><span class="sxs-lookup"><span data-stu-id="b2939-120">Relevant use cases</span></span>

<span data-ttu-id="b2939-121">其他相关用例包括：</span><span class="sxs-lookup"><span data-stu-id="b2939-121">Other relevant use cases include:</span></span>

- <span data-ttu-id="b2939-122">建筑、采矿或设备制造方案</span><span class="sxs-lookup"><span data-stu-id="b2939-122">Construction, mining, or equipment manufacturing scenarios</span></span>
- <span data-ttu-id="b2939-123">要存储和分析的大规模设备数据集合</span><span class="sxs-lookup"><span data-stu-id="b2939-123">Large-scale collection of device data for storage and analysis</span></span>
- <span data-ttu-id="b2939-124">引入和分析大型数据集</span><span class="sxs-lookup"><span data-stu-id="b2939-124">Ingestion and analysis of large datasets</span></span>

## <a name="architecture"></a><span data-ttu-id="b2939-125">体系结构</span><span class="sxs-lookup"><span data-stu-id="b2939-125">Architecture</span></span>

![建筑行业中 IoT 和数据分析的体系结构][architecture]

<span data-ttu-id="b2939-127">数据流经解决方案的情形如下所示：</span><span class="sxs-lookup"><span data-stu-id="b2939-127">The data flows through the solution as follows:</span></span>

1. <span data-ttu-id="b2939-128">建筑设备定期收集传感器数据，并将施工结果数据发送到 Azure 虚拟机群集上托管的负载均衡 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="b2939-128">Construction equipment collects sensor data and sends the construction results data at regular intervals to load balanced web services hosted on a cluster of Azure virtual machines.</span></span>
2. <span data-ttu-id="b2939-129">自定义 Web 服务引入施工结果数据，并将其存储在同样运行于 Azure 虚拟机上的 Apache Cassandra 群集中。</span><span class="sxs-lookup"><span data-stu-id="b2939-129">The custom web services ingest the construction results data and store it in an Apache Cassandra cluster also running on Azure virtual machines.</span></span>
3. <span data-ttu-id="b2939-130">另一个数据集由不同建筑设备上的 IoT 传感器收集，并发送到 IoT 中心。</span><span class="sxs-lookup"><span data-stu-id="b2939-130">Another dataset is gathered by IoT sensors on various construction equipment and sent to IoT Hub.</span></span>
4. <span data-ttu-id="b2939-131">收集的原始数据直接从 IoT 中心发送到 Azure Blob 存储，并立即可供查看和分析。</span><span class="sxs-lookup"><span data-stu-id="b2939-131">Raw data collected is sent directly from IoT Hub to Azure blob storage and is immediately available for viewing and analysis.</span></span>
5. <span data-ttu-id="b2939-132">通过 IoT 中心收集的数据由 Azure 流分析作业以近实时的速度进行处理，并存储在 Azure SQL 数据库中。</span><span class="sxs-lookup"><span data-stu-id="b2939-132">Data collected via IoT Hub is processed in near real time by an Azure Stream Analytics job and stored in an Azure SQL database.</span></span>
6. <span data-ttu-id="b2939-133">分析师和最终用户可以使用 Smart Construction Cloud Web 应用程序来查看和分析传感器数据与图像。</span><span class="sxs-lookup"><span data-stu-id="b2939-133">The Smart Construction Cloud web application is available to analysts and end users to view and analyze sensor data and imagery.</span></span>
7. <span data-ttu-id="b2939-134">Web 应用程序的用户按需启动批处理作业。</span><span class="sxs-lookup"><span data-stu-id="b2939-134">Batch jobs are initiated on demand by users of the web application.</span></span> <span data-ttu-id="b2939-135">批处理作业在 Apache Spark on HDInsight 中运行，可分析 Cassandra 群集中存储的新数据。</span><span class="sxs-lookup"><span data-stu-id="b2939-135">The batch job runs in Apache Spark on HDInsight and analyzes new data stored in the Cassandra cluster.</span></span>

### <a name="components"></a><span data-ttu-id="b2939-136">组件</span><span class="sxs-lookup"><span data-stu-id="b2939-136">Components</span></span>

- <span data-ttu-id="b2939-137">[IoT 中心](/azure/iot-hub/about-iot-hub)充当一个中心消息枢纽，可以使用每个设备的标识在云平台与建筑设备和其他场地要素之间实现安全的双向通信。</span><span class="sxs-lookup"><span data-stu-id="b2939-137">[IoT Hub](/azure/iot-hub/about-iot-hub) acts as a central message hub for secure bi-directional communication with per-device identity between the cloud platform and the construction equipment and other site elements.</span></span> <span data-ttu-id="b2939-138">IoT 中心可以快速收集每个设备的数据，以便引入到数据分析管道。</span><span class="sxs-lookup"><span data-stu-id="b2939-138">IoT Hub can rapidly collect data for each device for ingestion into the data analytics pipeline.</span></span>
- <span data-ttu-id="b2939-139">[Azure 流分析](/azure/stream-analytics/stream-analytics-introduction)是一个事件处理引擎，可以分析从设备和其他数据源流式传输的大量数据。</span><span class="sxs-lookup"><span data-stu-id="b2939-139">[Azure Stream Analytics](/azure/stream-analytics/stream-analytics-introduction) is an event-processing engine that can analyze high volumes of data streaming from devices and other data sources.</span></span> <span data-ttu-id="b2939-140">它还支持从数据流提取信息，以便确定模式和关系。</span><span class="sxs-lookup"><span data-stu-id="b2939-140">It also supports extracting information from data streams to identify patterns and relationships.</span></span> <span data-ttu-id="b2939-141">在本方案中，流分析将引入并分析来自 IoT 设备的数据，并将结果存储在 Azure SQL 数据库中。</span><span class="sxs-lookup"><span data-stu-id="b2939-141">In this scenario, Stream Analytics ingests and analyzes data from IoT devices and stores the results in Azure SQL Database.</span></span>
- <span data-ttu-id="b2939-142">[Azure SQL 数据库](/azure/sql-database/sql-database-technical-overview)包含来自 IoT 设备和仪表的分析数据的结果，分析师和用户可以通过基于 Azure 的 Web 应用程序查看这些结果。</span><span class="sxs-lookup"><span data-stu-id="b2939-142">[Azure SQL Database](/azure/sql-database/sql-database-technical-overview) contains the results of analyzed data from IoT devices and meters, which can be viewed by analysts and users via an Azure-based Web application.</span></span>
- <span data-ttu-id="b2939-143">[Blob 存储](/azure/storage/blobs/storage-blobs-introduction)存储从 IoT 中心设备收集的图像数据。</span><span class="sxs-lookup"><span data-stu-id="b2939-143">[Blob storage](/azure/storage/blobs/storage-blobs-introduction) stores image data gathered from the IoT hub devices.</span></span> <span data-ttu-id="b2939-144">可以通过 Web 应用程序查看图像数据。</span><span class="sxs-lookup"><span data-stu-id="b2939-144">The image data can be viewed via the web application.</span></span>
- <span data-ttu-id="b2939-145">[流量管理器](/azure/traffic-manager/traffic-manager-overview)控制不同 Azure 区域中服务终结点的用户流量分配。</span><span class="sxs-lookup"><span data-stu-id="b2939-145">[Traffic Manager](/azure/traffic-manager/traffic-manager-overview) controls the distribution of user traffic for service endpoints in different Azure regions.</span></span>
- <span data-ttu-id="b2939-146">[负载均衡器](/azure/load-balancer/load-balancer-overview)在基于 VM 的 Web 服务之间分配建筑设备提交的数据，以提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="b2939-146">[Load Balancer](/azure/load-balancer/load-balancer-overview) distributes data submissions from construction equipment devices across the VM-based web services to provide high availability.</span></span>
- <span data-ttu-id="b2939-147">[Azure 虚拟机](/azure/virtual-machines)托管可在 Apache Cassandra 数据库中接收和引入施工结果数据的 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="b2939-147">[Azure Virtual Machines](/azure/virtual-machines) host the web services that receive and ingest the construction results data into the Apache Cassandra database.</span></span>
- <span data-ttu-id="b2939-148">[Apache Cassandra](https://cassandra.apache.org) 是一个分布式 NoSQL 数据库，用于存储施工数据，以便稍后由 Apache Spark 进行处理。</span><span class="sxs-lookup"><span data-stu-id="b2939-148">[Apache Cassandra](https://cassandra.apache.org) is a distributed NoSQL database used to store construction data for later processing by Apache Spark.</span></span>
- <span data-ttu-id="b2939-149">[Web 应用](/azure/app-service/app-service-web-overview)托管可用于查询和查看源数据与图像的最终用户 Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="b2939-149">[Web Apps](/azure/app-service/app-service-web-overview) hosts the end-user web application, which can be used to query and view source data and images.</span></span> <span data-ttu-id="b2939-150">用户也可以通过应用程序在 Apache Spark 中启动批处理作业。</span><span class="sxs-lookup"><span data-stu-id="b2939-150">Users can also initiate batch jobs in Apache Spark via the application.</span></span>
- <span data-ttu-id="b2939-151">[Apache Spark on HDInsight](/azure/hdinsight/spark/apache-spark-overview) 支持使用内存中处理来提升大数据分析应用程序的性能。</span><span class="sxs-lookup"><span data-stu-id="b2939-151">[Apache Spark on HDInsight](/azure/hdinsight/spark/apache-spark-overview) supports in-memory processing to boost the performance of big-data analytic applications.</span></span> <span data-ttu-id="b2939-152">本方案使用 Spark 针对 Apache Cassandra 中存储的数据运行复杂算法。</span><span class="sxs-lookup"><span data-stu-id="b2939-152">In this scenario, Spark is used to run complex algorithms over the data stored in Apache Cassandra.</span></span>

### <a name="alternatives"></a><span data-ttu-id="b2939-153">备选项</span><span class="sxs-lookup"><span data-stu-id="b2939-153">Alternatives</span></span>

- <span data-ttu-id="b2939-154">[Cosmos DB](/azure/cosmos-db/introduction) 是一种 NoSQL 数据库替代技术。</span><span class="sxs-lookup"><span data-stu-id="b2939-154">[Cosmos DB](/azure/cosmos-db/introduction) is an alternative NoSQL database technology.</span></span> <span data-ttu-id="b2939-155">Cosmos DB 提供[全球规模的多主数据库支持](/azure/cosmos-db/multi-region-writers)，并提供[多个妥善定义的一致性级别](/azure/cosmos-db/consistency-levels)，以满足各种客户要求。</span><span class="sxs-lookup"><span data-stu-id="b2939-155">Cosmos DB provides [multi-master support at global scale](/azure/cosmos-db/multi-region-writers) with [multiple well-defined consistency levels](/azure/cosmos-db/consistency-levels) to meet various customer requirements.</span></span> <span data-ttu-id="b2939-156">它还支持 [Cassandra API](/azure/cosmos-db/cassandra-introduction)。</span><span class="sxs-lookup"><span data-stu-id="b2939-156">It also supports the [Cassandra API](/azure/cosmos-db/cassandra-introduction).</span></span>
- <span data-ttu-id="b2939-157">[Azure Databricks](/azure/azure-databricks/what-is-azure-databricks) 是针对 Azure 优化的基于 Apache Spark 的分析平台。</span><span class="sxs-lookup"><span data-stu-id="b2939-157">[Azure Databricks](/azure/azure-databricks/what-is-azure-databricks) is an Apache Spark-based analytics platform optimized for Azure.</span></span> <span data-ttu-id="b2939-158">它与 Azure 集成，可提供一键式安装、简化的工作流和交互式协作工作区。</span><span class="sxs-lookup"><span data-stu-id="b2939-158">It is integrated with Azure to provide one-click setup, streamlined workflows, and an interactive collaborative workspace.</span></span>
- <span data-ttu-id="b2939-159">[Data Lake Storage](/azure/storage/data-lake-storage) 可以取代 Blob 存储。</span><span class="sxs-lookup"><span data-stu-id="b2939-159">[Data Lake Storage](/azure/storage/data-lake-storage) is an alternative to Blob storage.</span></span> <span data-ttu-id="b2939-160">对于本方案，Data Lake Storage 在目标区域中不可用。</span><span class="sxs-lookup"><span data-stu-id="b2939-160">For this scenario, Data Lake Storage was not available in the targeted region.</span></span>
- <span data-ttu-id="b2939-161">还可以使用 [Web 应用](/azure/app-service)来托管用于引入施工结果数据的 Web 服务。</span><span class="sxs-lookup"><span data-stu-id="b2939-161">[Web Apps](/azure/app-service) could also be used to host the web services for ingesting construction results data.</span></span>
- <span data-ttu-id="b2939-162">进行实时消息引入、数据存储、流处理、分析数据存储以及分析和报告时，有许多技术选项。</span><span class="sxs-lookup"><span data-stu-id="b2939-162">Many technology options are available for real-time message ingestion, data storage, stream processing, storage of analytical data, and analytics and reporting.</span></span> <span data-ttu-id="b2939-163">有关这些选项及其功能和主要选择标准的概述，请参阅 Azure 数据体系结构指南中的[大数据体系结构：实时处理](/azure/architecture/data-guide/technology-choices/real-time-ingestion)中[Azure 数据体系结构指南](/azure/architecture/data-guide)。</span><span class="sxs-lookup"><span data-stu-id="b2939-163">For an overview of these options, their capabilities, and key selection criteria, see [Big data architectures: Real-time processing](/azure/architecture/data-guide/technology-choices/real-time-ingestion) in the [Azure Data Architecture Guide](/azure/architecture/data-guide).</span></span>

## <a name="considerations"></a><span data-ttu-id="b2939-164">注意事项</span><span class="sxs-lookup"><span data-stu-id="b2939-164">Considerations</span></span>

<span data-ttu-id="b2939-165">Azure 区域的广泛可用性是本方案的一个重要考虑因素。</span><span class="sxs-lookup"><span data-stu-id="b2939-165">The broad availability of Azure regions is an important factor for this scenario.</span></span> <span data-ttu-id="b2939-166">在一个国家/地区设立多个区域不仅可以实现灾难恢复，而且还能遵从合同义务和执法要求。</span><span class="sxs-lookup"><span data-stu-id="b2939-166">Having more than one region in a single country can provide disaster recovery while also enabling compliance with contractual obligations and law enforcement requirements.</span></span> <span data-ttu-id="b2939-167">在本方案中，Azure 区域之间的高速通信也是一个重要考虑因素。</span><span class="sxs-lookup"><span data-stu-id="b2939-167">Azure's high-speed communication between regions is also an important factor in this scenario.</span></span>

<span data-ttu-id="b2939-168">Azure 支持开源技术，可让客户利用其现有的劳动力技能。</span><span class="sxs-lookup"><span data-stu-id="b2939-168">Azure support for open-source technologies allowed the customer to take advantage of their existing workforce skills.</span></span> <span data-ttu-id="b2939-169">与使用本地解决方案相比，客户还能以更低的成本和更少的工作负荷加速新技术的采用。</span><span class="sxs-lookup"><span data-stu-id="b2939-169">The customer can also accelerate the adoption of new technologies with lower costs and operating workloads compared to an on-premises solution.</span></span>

## <a name="pricing"></a><span data-ttu-id="b2939-170">定价</span><span class="sxs-lookup"><span data-stu-id="b2939-170">Pricing</span></span>

<span data-ttu-id="b2939-171">以下因素与本解决方案的绝大部分成本相关。</span><span class="sxs-lookup"><span data-stu-id="b2939-171">The following considerations will drive a substantial portion of the costs for this solution.</span></span>

- <span data-ttu-id="b2939-172">预配更多的实例时，Azure 虚拟机的成本将呈线性增加。</span><span class="sxs-lookup"><span data-stu-id="b2939-172">Azure virtual machine costs will increase linearly as additional instances are provisioned.</span></span> <span data-ttu-id="b2939-173">已解除分配的虚拟机只会产生存储成本，而不产生计算成本。</span><span class="sxs-lookup"><span data-stu-id="b2939-173">Virtual machines that are deallocated will only incur storage costs, and not compute costs.</span></span> <span data-ttu-id="b2939-174">今后在需求提高时，可以重新分配这些已解除分配的虚拟机。</span><span class="sxs-lookup"><span data-stu-id="b2939-174">These deallocated machines can then be reallocated when demand is high.</span></span>
- <span data-ttu-id="b2939-175">[IoT 中心](https://azure.microsoft.com/pricing/details/iot-hub)成本由预配的 IoT 单元数以及所选的服务层驱动，后者决定了每个单元每天可以发送的消息数。</span><span class="sxs-lookup"><span data-stu-id="b2939-175">[IoT Hub](https://azure.microsoft.com/pricing/details/iot-hub) costs are driven by the number of IoT units provisioned as well as the service tier chosen, which determines the number of messages per day per unit allowed.</span></span>
- <span data-ttu-id="b2939-176">[流分析](https://azure.microsoft.com/pricing/details/stream-analytics)的定价依据是在服务中处理数据所需的流单元数。</span><span class="sxs-lookup"><span data-stu-id="b2939-176">[Stream Analytics](https://azure.microsoft.com/pricing/details/stream-analytics) is priced by the number of streaming units required to process the data into the service.</span></span>

## <a name="related-resources"></a><span data-ttu-id="b2939-177">相关资源</span><span class="sxs-lookup"><span data-stu-id="b2939-177">Related resources</span></span>

<span data-ttu-id="b2939-178">若要查看类似体系结构的实现，请阅读 [Komatsu 客户案例][customer-story]。</span><span class="sxs-lookup"><span data-stu-id="b2939-178">To see an implementation of a similar architecture, read the [Komatsu customer story][customer-story].</span></span>

<span data-ttu-id="b2939-179">[Azure 数据体系结构指南](/azure/architecture/data-guide)中提供了大数据体系结构的指导。</span><span class="sxs-lookup"><span data-stu-id="b2939-179">Guidance for big data architectures is available in the [Azure Data Architecture Guide](/azure/architecture/data-guide).</span></span>

<!-- links -->

[product-category]: https://azure.microsoft.com/product-categories/analytics/
[customer-site]: https://home.komatsu/en/
[customer-story]: https://customers.microsoft.com/story/komatsu-manufacturing-azure-iot-hub-japan
[architecture]: ./media/architecture-big-data-with-iot.png
