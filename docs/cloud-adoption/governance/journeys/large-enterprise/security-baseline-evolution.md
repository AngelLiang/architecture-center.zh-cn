---
title: 'CAF：大型企业 - 安全基线演变 '
titleSuffix: Microsoft Cloud Adoption Framework for Azure
ms.service: architecture-center
ms.subservice: enterprise-cloud-adoption
ms.custom: governance
ms.date: 02/11/2019
description: 大型企业 - 安全基线演变
author: BrianBlanchard
ms.openlocfilehash: 59fb3655f1ff2a5f0a30abc760c27c77b8f802af
ms.sourcegitcommit: 273e690c0cfabbc3822089c7d8bc743ef41d2b6e
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/08/2019
ms.locfileid: "55900647"
---
# <a name="large-enterprise-security-baseline-evolution"></a>大型企业：安全基线演变

本文通过添加支持将受保护的数据移动到云的安全控制来演化叙述性内容。

## <a name="evolution-of-the-narrative"></a>叙述性内容的演变

首席信息官花了几个月与同事和公司的法律人员合作。 一名具有网络安全专业知识的管理顾问参与其中，以帮助现有的 IT 安全和 IT 治理团队起草有关受保护数据的新策略。 该小组能够促进董事会支持以取代现有策略，允许 PII 和财务数据由经过批准的云提供商托管。 这需要采用一组安全要求和治理流程来验证和记录对这些策略的遵守情况。

在过去的 12 个月中，云采用团队已经清除了两个数据中心的 5,000 个资产中的大部分资产。 350 个不兼容资产已移到备用数据中心。 仅保留包含受保护数据的 1,250 个虚拟机。

### <a name="evolution-of-the-cloud-governance-team"></a>云治理团队的演变

云治理团队随着叙述性内容继续演变。 该团队的两位创始成员现在是该公司最著名的云架构师。 随着新团队应对创新的新部署，配置脚本的集合也在不断增加。 云治理团队也在发展壮大。 最近，IT 运营团队的成员加入了云治理团队活动，为云运营做好准备。 帮助促进该社区的云架构师被视为云保护者和云加速器。

尽管这种差异很微妙，但在构建以管理为中心的 IT 文化时，这是一个重要区别。 云管理者清理由创新云架构师制造的混乱，这两个角色天生冲突，目标对立。 云保护者可以帮助保护云的安全，因此其他云架构师可以更快地移动，减少混乱。 云加速器执行这两项功能，但也参与模板的创建以加速部署和采用，成为创新加速器以及五个云规则的捍卫者。

### <a name="evolution-of-the-current-state"></a>当前状态的演变

在这段叙述性内容的前一阶段，该公司已经开始停用两个数据中心的过程。 这项持续的工作包括迁移一些具有旧身份验证要求的应用，这需要标识基线的演变，如[前篇文章](identity-baseline-evolution.md)中所述。

自此，一些事态已改变，将会影响到治理：

- 数以千计的 IT 和业务资产已部署到云中。
- 应用程序开发团队实施了持续集成和持续部署 (CI/CD) 管道，以部署具有改进用户体验的云原生应用程序。 该应用程序尚未与受保护的数据进行交互，因此还不可用于生产。
- IT 中的商业智能团队积极管理云中来自物流、库存和第三方的数据。 这些数据被用来推动新预测，可用于调整业务流程。 然而，在客户和财务数据能够集成到数据平台之前，这些预测和见解是不可操作的。
- IT 团队正在推进 CIO 和 CFO 停用两个数据中心的计划。 这两个数据中心中有近 3,500 个资产已被停用或迁移。
- 改进了有关 PII 和财务数据的策略。 然而，新的公司策略取决于相关安全和管理策略的实现。 团队仍停滞不前。

### <a name="evolution-of-the-future-state"></a>未来状态的演变

- 应用程序开发和 BI 团队的早期试验显示，客户体验和数据驱动决策方面存在潜在改进。 这两个团队都想要在未来 18 个月将这些解决方案部署到生产环境中，从而扩大云的应用范围。
- IT 已经开发了将另外五个数据中心迁移到 Azure 的业务理由，这将进一步降低 IT 成本并提供更高的业务灵活性。 虽然规模较小，但这些数据中心的停用预计会使总成本节省增加一倍。
- 资本支出和运营支出预算已获得批准，实现所需的安全和管理策略、工具和进程。 数据中心停用后的预期成本节约足以支付这项新举措的费用。 IT 和业务领导层相信，这项投资将加速实现其他领域的回报。 基层云治理团队成为了一支具有专职领导和人员配备的公认团队。
- 云采用团队、云治理团队、IT 安全团队和 IT 管理团队将共同实现安全和管理要求，以允许云采用团队将受保护的数据迁移到云中。

## <a name="evolution-of-tangible-risks"></a>有形风险的演变

**数据泄露**：在采用任何新数据平台时，与数据泄露相关的责任都会增加。 采用云技术的技术人员需要承担更多责任来实现可以减少这种风险的解决方案。 必须实现可靠的安全和管理策略，以确保这些技术人员履行这些职责。

此业务风险可以扩展为几种技术风险：

- 可能会无意部署任务关键型应用或受保护的数据。
- 由于糟糕的加密决策，受保护的数据可能在存储期间被公开。
- 未经授权的用户可能会访问受保护的数据。
- 外部入侵可能导致对受保护数据的访问。
- 外部入侵或拒绝服务攻击可能导致业务中断。
- 组织或雇用变化可能允许未经授权访问受保护的数据。
- 新攻击可能会为入侵或未经授权的访问创造机会。
- 不一致的部署流程可能会导致安全漏洞，从而导致数据泄露或中断。
- 配置偏差或缺少修补程序可能会导致意外安全漏洞，从而导致数据泄露或中断。
- 不同的边缘设备可能会增加网络运营成本。
- 不同的设备配置可能会导致配置过度和安全性受损。
- 网络安全团队坚持认为，在单个云提供商的平台上生成加密密钥存在供应商锁定的风险。 虽然这一说法没有得到证实，但该团队暂时接受了这一说法。

## <a name="evolution-of-the-policy-statements"></a>策略语句的演变

以下策略的更改将有助于缓解新的风险，同时有助于实施指南。 此清单内容看起来很多，但要采用这些策略并没有想象的那么困难。

1. 所有已部署的资产必须按照重要程度和数据分类进行分类。 在部署到云之前，云治理团队和应用程序将对分类进行审查。
2. 存储或访问受保护数据的应用程序的管理方式与不支持的应用程序的管理方式不同。 至少应对它们进行分段，以避免意外地访问受保护的数据。
3. 所有受保护的数据都必须在静态时加密。
4. 在任何包含受保护数据的段中提升权限可以是个例外。 任何此类异常都将由云治理团队记录并定期审核。
5. 包含受保护数据的网络子网必须独立于任何其他子网。 将定期审核受保护数据子网之间的网络流量。
6. 不允许通过公共 Internet 或跨数据中心直接访问包含受保护数据的子网。 对这些子网的访问必须通过中间子网工作进行路由。 所有对这些子网的访问都必须通过防火墙解决方案，该解决方案可以执行包扫描和拦截功能。
7. 治理工具必须审核和强制执行安全管理团队定义的网络配置要求。
8. 治理工具必须仅将 VM 部署限制为已批准的映像。
9. 节点配置管理应尽量将策略要求应用于任何来宾操作系统的配置。 节点配置管理应遵循组策略对象 (GPO) 中的现有投资以进行资源配置。
10. 治理工具将审核所有已部署资产的自动更新。 如果可能，将强制实施自动更新。 如果未通过工具强制执行，必须与运营管理团队协同审查违规行为，并根据运营策略进行补救。 不自动更新的资产必须包含在 IT 运营部门的流程中。
11. 为任何任务关键型应用程序或受保护数据创建新的订阅或管理组都需要云治理团队的审核，以确保分配了适当的蓝图。
12. 最小特权访问模型将应用于任何包含任务关键型应用程序或受保护数据的订阅。
13. 云提供商必须能够集成由现有本地解决方案管理的加密密钥。
14. 云提供商必须能够支持现有的边缘设备解决方案和任何所需的配置，以保护任何公开的网络边界。
15. 云提供商必须能够支持与全球 WAN 的共享连接，并通过现有边缘设备解决方案路由数据。
16. 安全团队应定期检查可能影响云部署的趋势和攻击，以更新云中使用的安全基线工具。
17. 部署工具必须得到云治理团队的批准，以确保对部署的资产进行持续管理。
18. 必须在云治理团队可访问的中央存储库中对部署脚本进行维护，以便进行定期检查和审核。
19. 治理过程必须包括部署时的审核和周期性审核，以确保所有资产的一致性。
20. 任何需要客户身份验证的应用程序的部署都必须使用与内部用户的主标识提供者兼容的已批准的标识提供者。
21. 云治理流程必须包括与标识基线团队的季度审核，以识别云资产配置应阻止的恶意执行组件或使用模式。

## <a name="evolution-of-the-best-practices"></a>最佳做法的演变

本文的这一部分将改进治理 MVP 设计，以包括新的 Azure 策略和 Azure 成本管理的实现。 这两项设计变更将共同实现新的公司策略语句。

新的最佳做法分为两类：企业 IT（中心）和云采用（分支）。

**建立企业 IT 中心/分支订阅以集中安全基准**：在此最佳做法中，现有的治理能力由[中心辐射拓扑和共享服务][shared-services]包围，其中包含一些来自云治理团队的重要补充。

1. Azure DevOps 存储库。 在 Azure DevOps 中创建一个存储库来存储和版本化所有相关的 Azure 资源管理器模板和脚本化的配置
2. 中心辐射型模板。
    1. [中心辐射和共享服务参考体系结构][ shared-services]中的指南可用于为公司 IT 中心所需的资产生成资源管理器模板。
    2. 使用这些模板，可将这种结构设计为可重复，作为中央管理策略的一部分。
    3. 除了当前的参考体系结构之外，建议创建网络安全组 (NSG) 模板，为承载防火墙的 VNet 捕获任何阻止要求或将要求纳入允许列表的端口。 此 NSG 将与之前的 NSG 不同，因为它将是第一个允许公共流量进入 VNet 的 NSG。
3. 创建 Azure 策略。 创建名为 `Hub NSG Enforcement` 的策略以强制配置分配给在此订阅中创建的任何 VNet 的 NSG。 为来宾配置应用内置策略，如下所示：
    1. 审核 Windows Web 服务器是否在使用安全通信协议。
    2. 审核 Linux 和 Windows 计算机内是否正确设置密码安全设置。
4. 企业 IT 蓝图
    1. 创建名为 `corporate-it-subscription` 的 Azure 蓝图。
    2. 添加中心/辐射模板和中心 NSG 策略。
5. 扩展初始管理组层次结构。
    1. 对于请求支持受保护数据的每个管理组，`corporate-it-subscription-blueprint` 蓝图提供了加速的中心解决方案。
    2. 因为在此虚拟示例中，除了业务单元层次结构之外，管理组还包括区域层次结构，所以该蓝图将部署在每个区域中。
    3. 对于管理组层次结构中的每个区域，请创建名为 `Corporate IT Subscription` 的订阅。
    4. 将 `corporate-it-subscription-blueprint` 蓝图应用于每个区域实例。
    5. 这将为每个区域的业务部门建立一个中心。 注意：可以进一步节省成本，但是在每个区域的业务单元之间共享中心。
6. 通过 Desired State Configuration (DSC) 集成组策略对象 (GPO)：
    1. 将 GPO 转换为 DSC - Github 中的 [Microsoft 基线管理项目](https://github.com/Microsoft/BaselineManagement)可以加速这项工作。 * 确保将 DSC 与资源管理器模板并行存储在存储库中。
    2. 将 Azure 自动化状态配置部署到企业 IT 订阅的任何实例。 Azure 自动化可用于将 DSC 应用于在管理组内受支持的订阅中部署的 VM。
    3. 当前的路线图计划启用自定义来宾虚拟机配置策略。 发布该功能后，将不再需要在此最佳做法中使用 Azure 自动化。

**对云采用订阅（分支）应用其他管理**：在 `Corporate IT Subscription` 的基础上，对每个订阅（旨在支持应用程序原型）的治理 MVP 进行微小更改即可产生快速的演变。

在最佳做法的先前演变中，定义了 NSG，阻止了公共流量并将内部流量列入了允许列表。 此外，Azure 蓝图临时创建了 DMZ 和 Active Directory 功能。 在该演变中，我们将略微调整这些资产，创建 Azure 蓝图的新版本。

1. 网络对等互连模板。 此模板将使用企业 IT 订阅中的中心 VNet 将每个订阅中的 VNet 对等。
    1. 在前一部分[中心辐射和共享服务参考体系结构][shared-services]中，指导生成了资源管理器模板，可用于启用 VNet 对等互连。
    2. 该模板可用作指南，修改先前的管理演变中的 DMZ 模板。
    3. 从根本上讲，我们现在会将 VNet 对等互连添加到之前通过 VPN 连接到本地边缘设备的 DMZ VNet。
    4. ***此外，还建议从此模板中删除 VPN，以确保没有流量直接路由到本地数据中心，而无需通过企业 IT 订阅和防火墙解决方案。
    5. Azure 自动化将需要额外的[网络配置](/azure/automation/automation-dsc-overview#network-planning)以将 DSC 应用于托管的 VM。
2. 修改 NSG。 阻止 NSG 中的所有公共和直接本地流量。 唯一的入站流量应来自企业 IT 订阅中的 VNet 对等体。
    1. 在之前的演变中，创建了阻止所有公共流量并将所有内部流量列入允许列表的 NSG。 现在我们想要改变这个 NSG。
    2. 新的 NSG 配置应阻止来自本地数据中心的所有公共流量和所有流量。
    3. 进入此 VNet 的流量应仅来自 VNet 对等体另一侧的 VNet。
3. Azure 安全中心实现
    1. 为包含受保护数据分类的任何管理组配置 Azure 安全中心。
    2. 默认情况下，将自动配置设置为“启用”，以确保修补符合要求。
    3. 建立 OS 安全配置。 定义配置的 IT 安全性。
    4. 在 Azure 安全中心的初始使用中支持 IT 安全性。 从安全中心过渡到 IT 安全性的使用，但保持访问以实现管理持续改进的目的
    5. 创建资源管理器模板，用于反映订阅中 Azure 安全中心配置所需的更改。
4. 更新所有订阅的 Azure 策略。
    1. 在所有管理组和订阅之间审核和执行重要程度和数据分类，以识别具有受保护数据分类的任何订阅。
    2. 仅审核和强制使用已批准的 OS 映像。
    3. 根据每个节点的安全要求审核并强制实施来宾配置。
5. 为所有包含受保护数据分类的订阅更新 Azure策略。
    1. 仅审核并强制使用标准角色
    2. 审核和强制应用程序加密每个节点上的所有存储帐户和静态文件。
    3. 审核并执行新版 DMZ NSG 的应用。
    4. 审核并强制每个网络接口使用已批准的网络子网和 VNet。
    5. 审核并强制实施用户定义路由表的限制。
6. Azure 蓝图：
    1. 创建名为 `protected-data` 的 Azure 蓝图。
    2. 将 VNet peer、NSG 和 Azure 安全中心模板添加到该蓝图。
    3. 确保蓝图中不包含先前演变中的 Active Directory 模板。 公司 IT 订阅将提供对 Active Directory 的任何依赖项。
    4. 终止在先前演变中部署的任何现有 Active Directory VM。
    5. 为受保护的数据订阅添加新策略。
    6. 将蓝图发布到任何旨在托管受保护数据的管理组。
    7. 将新蓝图应用于每个受影响的订阅以及现有蓝图。

## <a name="conclusion"></a>结束语

将这些流程和更改添加到治理 MVP 有助于缓解与安全管理相关联的许多风险。 它们将一起添加保护数据所需的网络、标识和安全监视工具。

## <a name="next-steps"></a>后续步骤

随着云应用的不断演进和提供额外的业务价值，风险和云管理需求也在不断发展。 对于这一过程中的虚构公司，下一步是支持任务关键型工作负载。 这种情况下将需要资源一致性控制。

> [!div class="nextstepaction"]
> [资源一致性演变](./resource-consistency-evolution.md)

<!-- links -->

[shared-services]: ../../../../reference-architectures/hybrid-networking/shared-services.md