---
title: 企业云的采用：Azure 中针对多个团队的治理设计
description: 有关为多个团队、多个工作负荷和多个环境配置 Azure 调控措施的指南
author: petertaylor9999
ms.date: 09/10/2018
ms.openlocfilehash: ac2a63ad6ced1039290dc0bf5132b0d87a2c79cf
ms.sourcegitcommit: c49aeef818d7dfe271bc4128b230cfc676f05230
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/11/2018
ms.locfileid: "44389411"
---
# <a name="enterprise-cloud-adoption-governance-design-for-multiple-teams"></a><span data-ttu-id="89412-103">企业云的采用：针对多个团队的治理设计</span><span class="sxs-lookup"><span data-stu-id="89412-103">Enterprise Cloud Adoption: Governance design for multiple teams</span></span>

<span data-ttu-id="89412-104">本指南旨在介绍在 Azure 中设计资源治理模型，以便为多个团队、多个工作负荷和多个环境提供支持这一过程。</span><span class="sxs-lookup"><span data-stu-id="89412-104">The goal of this guidance is to help you learn the process for designing a resource governance model in Azure to support multiple teams, multiple workloads, and multiple environments.</span></span>  <span data-ttu-id="89412-105">其中探讨了一系列假设性的调控要求，然后详细讲解满足这些要求的几个示例实现。</span><span class="sxs-lookup"><span data-stu-id="89412-105">We'll look at a set of hypothetical governance requirements, then go through several example implementations that satisfy those requirements.</span></span>

<span data-ttu-id="89412-106">要求如下：</span><span class="sxs-lookup"><span data-stu-id="89412-106">The requirements are:</span></span>
* <span data-ttu-id="89412-107">企业计划将新的云角色和职责转移给一组用户，因此需要对在 Azure 中具有不同资源访问需求的多个团队进行标识管理。</span><span class="sxs-lookup"><span data-stu-id="89412-107">The enterprise plans to transition new cloud roles and responsibilities to a set of users and therefore requires identity management for multiple teams with different resource access needs in Azure.</span></span> <span data-ttu-id="89412-108">此标识管理系统是存储以下用户的标识所需的：</span><span class="sxs-lookup"><span data-stu-id="89412-108">This identity management system is required to store the identity of the following users:</span></span>
  1. <span data-ttu-id="89412-109">组织中负责**订阅**所有权的个人。</span><span class="sxs-lookup"><span data-stu-id="89412-109">The individual in your organization responsible for ownership of **subscriptions**.</span></span>
  2. <span data-ttu-id="89412-110">组织中负责**共享基础结构资源**（用于将本地网络连接到 Azure 虚拟网络）的个人。</span><span class="sxs-lookup"><span data-stu-id="89412-110">The individual in your organization responsible for the **shared infrastructure resources** used to connect your on-premises network to an Azure virtual network.</span></span> 
  3. <span data-ttu-id="89412-111">组织中负责管理**工作负荷**的两个人。</span><span class="sxs-lookup"><span data-stu-id="89412-111">Two individuals in your organization responsible for managing a **workload**.</span></span> 
* <span data-ttu-id="89412-112">支持多个**环境**。</span><span class="sxs-lookup"><span data-stu-id="89412-112">Support for multiple **environments**.</span></span> <span data-ttu-id="89412-113">环境是对虚拟机、虚拟网络、网络流量路由服务等资源的逻辑分组。</span><span class="sxs-lookup"><span data-stu-id="89412-113">An environment is a logical grouping of resources, such as virtual machines, virtual networking, and network traffic routing services.</span></span> <span data-ttu-id="89412-114">这些资源组有相似的管理和安全要求，通常用于特定的目的，例如测试或生产。</span><span class="sxs-lookup"><span data-stu-id="89412-114">These groups of resources have similar management and security requirements and are typically used for a specific purpose such as testing or production.</span></span> <span data-ttu-id="89412-115">在此示例中，该要求适用于三个环境：</span><span class="sxs-lookup"><span data-stu-id="89412-115">In this example, the  requirement is for three environments:</span></span>
  1. <span data-ttu-id="89412-116">一个**共享基础结构环境**，包含其他环境中工作负荷共享的资源。</span><span class="sxs-lookup"><span data-stu-id="89412-116">A **shared infrastructure environment** that includes resources shared by workloads in other environments.</span></span> <span data-ttu-id="89412-117">例如，包含用于建立本地连接的网关子网的虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="89412-117">For example, a virtual network with a gateway subnet that provides connectivity to on-premises.</span></span>
  2. <span data-ttu-id="89412-118">一个**生产环境**，包含限制性最强的安全策略。</span><span class="sxs-lookup"><span data-stu-id="89412-118">A **production environment** with the most restrictive security policies.</span></span> <span data-ttu-id="89412-119">可以包含面向内部或外部的工作负荷。</span><span class="sxs-lookup"><span data-stu-id="89412-119">May include internal or external facing workloads.</span></span>
  3. <span data-ttu-id="89412-120">一个**开发环境**，用于概念证明和测试工作。</span><span class="sxs-lookup"><span data-stu-id="89412-120">A **development environment** for proof-of-concept and testing work.</span></span> <span data-ttu-id="89412-121">此环境的安全、符合性和成本策略不同于生产环境中的策略。</span><span class="sxs-lookup"><span data-stu-id="89412-121">This environment has security, compliance, and cost policies that differ from those in the production environment.</span></span>
* <span data-ttu-id="89412-122">一个**最低特权的权限模型**，其中的用户默认没有任何权限。</span><span class="sxs-lookup"><span data-stu-id="89412-122">A **permissions model of least privilege** in which users have no permissions by default.</span></span> <span data-ttu-id="89412-123">该模型必须支持：</span><span class="sxs-lookup"><span data-stu-id="89412-123">The model must support the following:</span></span>
  * <span data-ttu-id="89412-124">位于订阅范围的、有权分配资源访问权限的单个受信任用户。</span><span class="sxs-lookup"><span data-stu-id="89412-124">A single trusted user at the subscription scope with permission to assign resource access rights.</span></span>
  * <span data-ttu-id="89412-125">默认情况下，拒绝每个工作负荷所有者访问资源。</span><span class="sxs-lookup"><span data-stu-id="89412-125">Each workload owner is denied access to resources by default.</span></span> <span data-ttu-id="89412-126">资源访问权限由单个受信任用户在订阅范围显式授予。</span><span class="sxs-lookup"><span data-stu-id="89412-126">Resource access rights are granted explicitly by the single trusted user at the subscription scope.</span></span>
  * <span data-ttu-id="89412-127">仅限共享基础结构所有者对共享基础结构资源进行管理访问。</span><span class="sxs-lookup"><span data-stu-id="89412-127">Management access for the shared infrastructure resources limited to the shared infrastructure owner.</span></span>  
  * <span data-ttu-id="89412-128">仅限工作负荷所有者对每个工作负荷进行管理访问。</span><span class="sxs-lookup"><span data-stu-id="89412-128">Management access for each workload restricted to the workload owner.</span></span>
  * <span data-ttu-id="89412-129">企业不希望在这三个环境的每一个中对角色进行单独的管理，因此要求只使用[内置的 RBAC 角色][rbac-built-in-roles]。</span><span class="sxs-lookup"><span data-stu-id="89412-129">The enterprise does not want to have to manage roles independently in each of the three environments, therefore requires the use of [built-in RBAC roles][rbac-built-in-roles] only.</span></span> <span data-ttu-id="89412-130">如果企业要使用自定义 RBAC 角色，则需通过另一过程同步这三个环境中的自定义角色。</span><span class="sxs-lookup"><span data-stu-id="89412-130">If the enterprise were to use custom RBAC roles, an additional process is required to synchronize custom roles across the three environments.</span></span> 
* <span data-ttu-id="89412-131">按工作负荷所有者名称和/或环境进行成本跟踪。</span><span class="sxs-lookup"><span data-stu-id="89412-131">Cost tracking by workload owner name, environment, or both.</span></span> 

## <a name="identity-management"></a><span data-ttu-id="89412-132">身份管理</span><span class="sxs-lookup"><span data-stu-id="89412-132">Identity management</span></span>

<span data-ttu-id="89412-133">在为治理模型设计标识管理之前，必须了解它附带的四个要素：</span><span class="sxs-lookup"><span data-stu-id="89412-133">Before we can design identity management for your governance model, it's important to understand the four major areas it encompasses:</span></span>

* <span data-ttu-id="89412-134">管理：用于创建、编辑和删除用户标识的过程与工具。</span><span class="sxs-lookup"><span data-stu-id="89412-134">Administration: the processes and tools for creating, editing, and deleting user identity.</span></span>
* <span data-ttu-id="89412-135">身份验证：通过验证凭据（例如用户名和密码）来验证用户的身份。</span><span class="sxs-lookup"><span data-stu-id="89412-135">Authentication: verifying user identity by validating credentials, such as a user name and password.</span></span>
* <span data-ttu-id="89412-136">授权：确定已经过身份验证的用户可以访问哪些资源，或者他们有权执行哪些操作。</span><span class="sxs-lookup"><span data-stu-id="89412-136">Authorization: determining which resources an authenticated user is allowed to access or what operations they have permission to perform.</span></span>
* <span data-ttu-id="89412-137">审核：定期审查日志和其他信息，以发现用户标识相关的安全问题。</span><span class="sxs-lookup"><span data-stu-id="89412-137">Auditing: periodically reviewing logs and other information to discover security issues related to user identity.</span></span> <span data-ttu-id="89412-138">这包括审查可疑的使用模式、定期审查用户权限以验证是否准确，以及其他功能。</span><span class="sxs-lookup"><span data-stu-id="89412-138">This includes reviewing suspicious usage patterns, periodically reviewing user permissions to verify they are accurate, and other functions.</span></span>

<span data-ttu-id="89412-139">Azure 只信任一个标识服务，即 Azure Active Directory (Azure AD)。</span><span class="sxs-lookup"><span data-stu-id="89412-139">There is only one service trusted by Azure for identity, and that is Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="89412-140">我们会将用户添加到 Azure AD，并对上面列出的所有功能使用 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="89412-140">We'll be adding users to Azure AD and using it for all of the functions listed above.</span></span> <span data-ttu-id="89412-141">但是，在了解如何配置 Azure AD 之前，必须了解用于管理对这些服务的访问的特权帐户。</span><span class="sxs-lookup"><span data-stu-id="89412-141">But before we look at how we'll configure Azure AD, it's important to understand the privileged accounts that are used to manage access to these services.</span></span>

<span data-ttu-id="89412-142">组织注册 Azure 帐户时，系统分配了至少一个 Azure **帐户所有者**。</span><span class="sxs-lookup"><span data-stu-id="89412-142">When your organization signed up for an Azure account, at least one Azure **account owner** was assigned.</span></span> <span data-ttu-id="89412-143">另外还会创建一个 Azure AD **租户**，除非现有的租户已经与组织使用的其他 Microsoft 服务（例如 Office 365）相关联。</span><span class="sxs-lookup"><span data-stu-id="89412-143">Also, an Azure AD **tenant** was created, unless an existing tenant was already associated with your organization's use of other Microsoft services such as Office 365.</span></span> <span data-ttu-id="89412-144">创建 Azure AD 租户时，会在该租户中关联一个具有完全权限的**全局管理员**。</span><span class="sxs-lookup"><span data-stu-id="89412-144">A **global administrator** with full permissions on the Azure AD tenant was associated when it was created.</span></span> 

<span data-ttu-id="89412-145">Azure 帐户所有者和 Azure AD 全局管理员的用户标识存储在 Microsoft 管理的高度安全的标识系统中。</span><span class="sxs-lookup"><span data-stu-id="89412-145">The user identities for both the Azure Account Owner and the Azure AD global administrator are stored in a highly secure identity system that is managed by Microsoft.</span></span> <span data-ttu-id="89412-146">Azure 帐户所有者有权创建、更新和删除订阅。</span><span class="sxs-lookup"><span data-stu-id="89412-146">The Azure Account Owner is authorized to create, update, and delete subscriptions.</span></span> <span data-ttu-id="89412-147">Azure AD 全局管理员有权在 Azure AD 中执行许多操作，但本设计指南侧重于用户标识的创建和删除。</span><span class="sxs-lookup"><span data-stu-id="89412-147">The Azure AD global administrator is authorized to perform many actions in Azure AD, but for this design guide we'll focus on the creation and deletion of user identity.</span></span> 

> [!NOTE]
> <span data-ttu-id="89412-148">如果帐户已关联了现有的 Office 365 或 Intune 许可证，则组织可能已有现有的 Azure AD 租户。</span><span class="sxs-lookup"><span data-stu-id="89412-148">Your organization may already have an existing Azure AD tenant if there's an existing Office 365 or Intune license associated with your account.</span></span>

<span data-ttu-id="89412-149">Azure 帐户所有者有权创建、更新和删除订阅：</span><span class="sxs-lookup"><span data-stu-id="89412-149">The Azure Account Owner has permission to create, update, and delete subscriptions:</span></span> 

<span data-ttu-id="89412-150">![充当 Azure 帐户管理者和 Azure AD 全局管理员的 Azure 帐户](../_images/governance-3-0.png)
*图 1.充当 Azure 帐户管理者和 Azure AD 全局管理员的 Azure 帐户。*</span><span class="sxs-lookup"><span data-stu-id="89412-150">![Azure account with Azure Account Manager and Azure AD global admin](../_images/governance-3-0.png)
*Figure 1. An Azure account with an Account Manager and Azure AD Global Administrator.*</span></span>

<span data-ttu-id="89412-151">Azure AD **全局管理员**有权创建用户帐户：</span><span class="sxs-lookup"><span data-stu-id="89412-151">The Azure AD **global administrator** has permission to create user accounts:</span></span>  

<span data-ttu-id="89412-152">![充当 Azure 帐户管理者和 Azure AD 全局管理员的 Azure 帐户](../_images/governance-3-0a.png)
*图 2.Azure AD 全局管理员在租户中创建所需的用户帐户。*</span><span class="sxs-lookup"><span data-stu-id="89412-152">![Azure account with Azure Account Manager and Azure AD global admin](../_images/governance-3-0a.png)
*Figure 2. The Azure AD Global Administrator creates the required user accounts in the tenant.*</span></span>

<span data-ttu-id="89412-153">前两个帐户（**App1 工作负荷所有者**和 **App2 工作负荷所有者**）各自与组织中负责管理工作负荷的个人相关联。</span><span class="sxs-lookup"><span data-stu-id="89412-153">The first two accounts, **App1 Workload Owner** and **App2 Workload Owner** are each associated with an individual in your organization responsible for managing a workload.</span></span> <span data-ttu-id="89412-154">**网络操作**帐户由负责共享基础结构资源的个人拥有。</span><span class="sxs-lookup"><span data-stu-id="89412-154">The **network operations** account is owned by the individual that is responsible for the shared infrastructure resources.</span></span> <span data-ttu-id="89412-155">最后，**订阅所有者**帐户与拥有订阅的负责人相关联。</span><span class="sxs-lookup"><span data-stu-id="89412-155">Finally, the **subscription owner** account is associated with the individual responsible for ownership of subscriptions.</span></span>

## <a name="resource-access-permissions-model-of-least-privilege"></a><span data-ttu-id="89412-156">最低特权的资源访问权限模型</span><span class="sxs-lookup"><span data-stu-id="89412-156">Resource access permissions model of least privilege</span></span>

<span data-ttu-id="89412-157">创建标识管理系统和用户帐户后，必须确定如何将基于角色的访问控制 (RBAC) 角色应用到每个帐户，以支持最低特权的权限模型。</span><span class="sxs-lookup"><span data-stu-id="89412-157">Now that your identity management system and user accounts have been created, we have to decide how we'll apply role-based access control (RBAC) roles to each account to support a permissions model of least privilege.</span></span>

<span data-ttu-id="89412-158">其他要求包括，与每个工作负荷关联的资源应相互隔离，防止某个工作负荷所有者对其不拥有的其他任何工作负荷进行管理访问。</span><span class="sxs-lookup"><span data-stu-id="89412-158">There's another requirement stating the resources associated with each workload be isolated from one another such that no one workload owner has management access to any other workload they do not own.</span></span> <span data-ttu-id="89412-159">另外还要求只使用 [Azure RBAC 的内置角色][rbac-built-in-roles]实现此模型。</span><span class="sxs-lookup"><span data-stu-id="89412-159">There's also a requirement to implement this model using only [built-in roles for Azure RBAC][rbac-built-in-roles].</span></span>

<span data-ttu-id="89412-160">每个 RBAC 角色在 Azure 中的三个范围之一应用：**订阅**、**资源组**和个人**资源**。</span><span class="sxs-lookup"><span data-stu-id="89412-160">Each RBAC role is applied at one of three scopes in Azure: **subscription**, **resource group**, then an individual **resource**.</span></span> <span data-ttu-id="89412-161">角色在较低的范围继承。</span><span class="sxs-lookup"><span data-stu-id="89412-161">Roles are inherited at lower scopes.</span></span> <span data-ttu-id="89412-162">例如，如果在订阅级别为某个用户分配了[内置的所有者角色][rbac-built-in-owner]，则该角色也会在资源组和个人资源级别分配到该用户，除非该级别被覆盖。</span><span class="sxs-lookup"><span data-stu-id="89412-162">For example, if a user is assigned the [built-in owner role][rbac-built-in-owner] at the subscription level, that role is also assigned to that user at the resource group and individual resource level unless it's overridden.</span></span>

<span data-ttu-id="89412-163">因此，若要创建最低特权访问模型，必须确定特定类型的用户能够在上述每个范围执行的操作。</span><span class="sxs-lookup"><span data-stu-id="89412-163">Therefore, to create a model of least privilege access we have to decide the actions a particular type of user is allowed to take at each of these three scopes.</span></span> <span data-ttu-id="89412-164">例如，对工作负荷所有者的要求是，只有权管理对与其工作负荷相关联的资源的访问，而不能管理对任何其他资源的访问。</span><span class="sxs-lookup"><span data-stu-id="89412-164">For example, the requirement is for a workload owner to have permission to manage access to only the resources associated with their workload and no others.</span></span> <span data-ttu-id="89412-165">如果在订阅范围分配了[内置的所有者角色][rbac-built-in-owner]，则每个工作负荷所有者对所有工作负荷都拥有管理访问权限。</span><span class="sxs-lookup"><span data-stu-id="89412-165">If we were to assign the [built-in owner role][rbac-built-in-owner] at the subscription scope, each workload owner would have management access to all workloads.</span></span>

<span data-ttu-id="89412-166">让我们看看两个示例权限模型，以更好地理解这一概念。</span><span class="sxs-lookup"><span data-stu-id="89412-166">Let's take a look at two example permission models to understand this concept a little better.</span></span> <span data-ttu-id="89412-167">在第一个示例中，模型仅信任服务管理员来创建资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-167">In the first example, the model trusts only the service administrator to create resource groups.</span></span> <span data-ttu-id="89412-168">在第二个示例中，模型在订阅范围将内置的所有者角色分配到每个工作负荷所有者。</span><span class="sxs-lookup"><span data-stu-id="89412-168">In the second example, the model assigns the built-in owner role to each workload owner at the subscription scope.</span></span> 

<span data-ttu-id="89412-169">这两个示例都在订阅范围为订阅服务管理员分配了[内置的所有者角色][rbac-built-in-owner]。</span><span class="sxs-lookup"><span data-stu-id="89412-169">In both examples, we have a subscription service administrator that is assigned the [built-in owner role][rbac-built-in-owner] at the subscription scope.</span></span> <span data-ttu-id="89412-170">前文提到，[内置的所有者角色][rbac-built-in-owner]会授予所有权限，包括资源访问权限的管理。</span><span class="sxs-lookup"><span data-stu-id="89412-170">Recall that the [built-in owner role][rbac-built-in-owner] grants all permissions including the management of access to resources.</span></span>
<span data-ttu-id="89412-171">![充当所有者角色的订阅服务管理员](../_images/governance-2-1.png)
*图 3.具有分配了内置所有者角色的服务管理员的订阅。*</span><span class="sxs-lookup"><span data-stu-id="89412-171">![subscription service administrator with owner role](../_images/governance-2-1.png)
*Figure 3. A subscription with a service administrator assigned the built-in owner role.*</span></span> 

1. <span data-ttu-id="89412-172">在第一个示例中，**工作负荷所有者 A** 在订阅范围没有任何权限 - 默认情况下，没有资源访问管理权限。</span><span class="sxs-lookup"><span data-stu-id="89412-172">In the first example, we have **workload owner A** with no permissions at the subscription scope - they have no resource access management rights by default.</span></span> <span data-ttu-id="89412-173">此用户想要为其工作负荷部署和管理资源。</span><span class="sxs-lookup"><span data-stu-id="89412-173">This user wants to deploy and manage the resources for their workload.</span></span> <span data-ttu-id="89412-174">他（她）必须联系**服务管理员**来请求创建资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-174">They must contact the **service administrator** to request creation of a resource group.</span></span>
<span data-ttu-id="89412-175">![工作负荷所有者请求创建资源组 A](../_images/governance-2-2.png)</span><span class="sxs-lookup"><span data-stu-id="89412-175">![workload owner requests creation of resource group A](../_images/governance-2-2.png)</span></span>  

2. <span data-ttu-id="89412-176">**服务管理员**审查其请求，然后创建**资源组 A**。此时，**工作负荷所有者 A** 仍然无权执行任何操作。</span><span class="sxs-lookup"><span data-stu-id="89412-176">The **service administrator** reviews their request and creates **resource group A**. At this point, **workload owner A** still doesn't have permission to do anything.</span></span>
<span data-ttu-id="89412-177">![服务管理员创建资源组 A](../_images/governance-2-3.png)</span><span class="sxs-lookup"><span data-stu-id="89412-177">![service administrator creates resource group A](../_images/governance-2-3.png)</span></span>

3. <span data-ttu-id="89412-178">**服务管理员**将**工作负荷所有者 A** 添加到**资源组 A**，并分配[内置的参与者角色](/azure/role-based-access-control/built-in-roles#contributor)。</span><span class="sxs-lookup"><span data-stu-id="89412-178">The **service administrator** adds **workload owner A** to **resource group A** and assigns the [built-in contributor role](/azure/role-based-access-control/built-in-roles#contributor).</span></span> <span data-ttu-id="89412-179">参与者角色授予**资源组 A** 中的所有权限，但无法管理访问权限。</span><span class="sxs-lookup"><span data-stu-id="89412-179">The contributor role grants all permissions on **resource group A** except managing access permission.</span></span>
<span data-ttu-id="89412-180">![服务管理员将工作负荷所有者 A 添加到资源组 A](../_images/governance-2-4.png)</span><span class="sxs-lookup"><span data-stu-id="89412-180">![service administrator adds workload owner a to resource group a](../_images/governance-2-4.png)</span></span>

4. <span data-ttu-id="89412-181">假设**工作负荷所有者 A** 要求在进行工作负荷的容量规划时，安排两个团队成员来查看 CPU 和网络流量监视数据。</span><span class="sxs-lookup"><span data-stu-id="89412-181">Let's assume that **workload owner A** has a requirement for a pair of team members to view the CPU and network traffic monitoring data as part of capacity planning for the workload.</span></span> <span data-ttu-id="89412-182">由于**工作负荷所有者 A** 充当参与者角色，因此无权将用户添加到**资源组 A**。他（她）必须将此请求发送到**服务管理员**。</span><span class="sxs-lookup"><span data-stu-id="89412-182">Because **workload owner A** is assigned the contributor role, they do not have permission to add a user to **resource group A**. They must send this request to the **service administrator**.</span></span>
<span data-ttu-id="89412-183">![工作负荷所有者请求将工作负荷参与者添加到资源组](../_images/governance-2-5.png)</span><span class="sxs-lookup"><span data-stu-id="89412-183">![workload owner requests workload contributors be added to resource group](../_images/governance-2-5.png)</span></span>

5. <span data-ttu-id="89412-184">**服务管理员**审查请求，并将两个**工作负荷参与者**用户添加到**资源组 A**。这两个用户都不需要资源的管理权限，因此为他们分配了[内置的读取者角色](/azure/role-based-access-control/built-in-roles#contributor)。</span><span class="sxs-lookup"><span data-stu-id="89412-184">The **service administrator** reviews the request, and adds the two **workload contributor** users to **resource group A**. Neither of these two users require permission to manage resources, so they are assigned the [built-in reader role](/azure/role-based-access-control/built-in-roles#contributor).</span></span> 
<span data-ttu-id="89412-185">![服务管理员将工作负荷参与者添加到资源组 A](../_images/governance-2-6.png)</span><span class="sxs-lookup"><span data-stu-id="89412-185">![service administrator adds workload contributors to resource group A](../_images/governance-2-6.png)</span></span>

6. <span data-ttu-id="89412-186">接下来，**工作负荷所有者 B** 还需要创建一个资源组来包含其工作负荷的资源。</span><span class="sxs-lookup"><span data-stu-id="89412-186">Next, **workload owner B** also requires a resource group to contain the resources for their workload.</span></span> <span data-ttu-id="89412-187">与**工作负荷所有者 A** 一样，**工作负荷所有者 B** 最初无权在订阅范围执行任何操作，因此，他（她）必须将请求发送到**服务管理员**。</span><span class="sxs-lookup"><span data-stu-id="89412-187">As with **workload owner A**, **workload owner B** initially does not have permission to take any action at the subscription scope so they must send a request to the **service administrator**.</span></span> 
<span data-ttu-id="89412-188">![工作负荷所有者 B 请求创建资源组 B](../_images/governance-2-7.png)</span><span class="sxs-lookup"><span data-stu-id="89412-188">![workload owner B requests creation of resource group B](../_images/governance-2-7.png)</span></span>

7. <span data-ttu-id="89412-189">**服务管理员**审查请求，然后创建**资源组 B**。![服务管理员创建资源组 B](../_images/governance-2-8.png)</span><span class="sxs-lookup"><span data-stu-id="89412-189">The **service administrator** reviews the request and creates **resource group B**. ![Service Administrator creates resource group B](../_images/governance-2-8.png)</span></span>

8. <span data-ttu-id="89412-190">然后，**服务管理员**将**工作负荷所有者 B** 添加到**资源组 B**，并分配[内置的参与者角色](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor)。</span><span class="sxs-lookup"><span data-stu-id="89412-190">The **service administrator** then adds **workload owner B** to **resource group B** and assigns the [built-in contributor role](https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#contributor).</span></span> 
<span data-ttu-id="89412-191">![服务管理员将工作负荷所有者 B 添加到资源组 B](../_images/governance-2-9.png)</span><span class="sxs-lookup"><span data-stu-id="89412-191">![Service Administrator adds Workload Owner B to resource group B](../_images/governance-2-9.png)</span></span>

<span data-ttu-id="89412-192">此时，每个工作负荷所有者在其自身的资源组中是隔离的。</span><span class="sxs-lookup"><span data-stu-id="89412-192">At this point, each of the workload owners is isolated in their own resource group.</span></span> <span data-ttu-id="89412-193">工作负荷所有者或其团队成员对其他任何资源组中的资源拥有管理访问权限。</span><span class="sxs-lookup"><span data-stu-id="89412-193">None of the workload owners or their team members have management access to the resources in any other resource group.</span></span> 

<span data-ttu-id="89412-194">![包含资源组 A 和 B 的订阅](../_images/governance-2-10.png)
*图 4.两个工作负荷所有者在其自身资源组中保持隔离的订阅。*</span><span class="sxs-lookup"><span data-stu-id="89412-194">![subscription with resource groups A and B](../_images/governance-2-10.png)
*Figure 4. A subscription with two workload owners isolated with their own resource group.*</span></span>

<span data-ttu-id="89412-195">此模型属于最低特权模型 - 在正确的资源管理范围为每个用户分配了正确的权限。</span><span class="sxs-lookup"><span data-stu-id="89412-195">This model is a least privilege model - each user is assigned the correct permission at the correct resource management scope.</span></span>

<span data-ttu-id="89412-196">但是，请考虑本示例中由**服务管理员**执行的每项任务。</span><span class="sxs-lookup"><span data-stu-id="89412-196">However, consider that every task in this example was performed by the **service administrator**.</span></span> <span data-ttu-id="89412-197">这是一个很简单的示例。由于只有两个工作负荷所有者，因此看上去不会有任何问题。但是，很容易就能想像到，在大型组织中会出现哪种问题。</span><span class="sxs-lookup"><span data-stu-id="89412-197">While this is a simple example and may not appear to be an issue because there were only two workload owners, it's easy to imagine the types of issues that would result for a large organization.</span></span> <span data-ttu-id="89412-198">例如，如果存在大量导致延迟的积压请求，则**服务管理员**可能成为瓶颈。</span><span class="sxs-lookup"><span data-stu-id="89412-198">For example, the **service administrator** can become a bottleneck with a large backlog of requests that result in delays.</span></span>  

<span data-ttu-id="89412-199">让我们看看第二个示例，其中演示了如何减少**服务管理员**执行的任务数目。</span><span class="sxs-lookup"><span data-stu-id="89412-199">Let's take a look at second example that reduces the number of tasks performed by the **service administrator**.</span></span> 

1. <span data-ttu-id="89412-200">在此模型中，在订阅范围为**工作负荷所有者 A** 分配了[内置的所有者角色][rbac-built-in-owner]，使他（她）能够创建自己的资源组：**资源组 A**。![服务管理员将工作负荷所有者 A 添加到订阅](../_images/governance-2-11.png)</span><span class="sxs-lookup"><span data-stu-id="89412-200">In this model, **workload owner A** is assigned the [built-in owner role][rbac-built-in-owner] at the subscription scope, enabling them to create their own resource group: **resource group A**. ![Service Administrator adds Workload Owner A to subscription](../_images/governance-2-11.png)</span></span>

2. <span data-ttu-id="89412-201">创建**资源组 A** 后，**工作负荷所有者 A** 默认会添加，并继承角色订阅范围的[内置所有者][rbac-built-in-owner]。</span><span class="sxs-lookup"><span data-stu-id="89412-201">When **resource group A** is created, **workload owner A** is added by default and inherits the [built-in owner][rbac-built-in-owner] role from the subscription scope.</span></span>
<span data-ttu-id="89412-202">![工作负荷所有者 A 创建资源组 A](../_images/governance-2-12.png)</span><span class="sxs-lookup"><span data-stu-id="89412-202">![Workload Owner A creates resource group A](../_images/governance-2-12.png)</span></span>

3. <span data-ttu-id="89412-203">[内置所有者角色][rbac-built-in-owner]为**工作负荷所有者 A** 授予资源组的管理访问权限。</span><span class="sxs-lookup"><span data-stu-id="89412-203">The [built-in owner role][rbac-built-in-owner] grants **workload owner A** permission to manage access to the resource group.</span></span> <span data-ttu-id="89412-204">**工作负荷所有者 A** 添加两个**工作负荷参与者**，并为每个参与者分配[内置的读取者角色][rbac-built-in-owner]。</span><span class="sxs-lookup"><span data-stu-id="89412-204">**Workload owner A** adds two **workload contributors** and assigns the [built-in reader role][rbac-built-in-owner] to each of them.</span></span> 
<span data-ttu-id="89412-205">![工作负荷所有者 A 添加工作负荷参与者](../_images/governance-2-13.png)</span><span class="sxs-lookup"><span data-stu-id="89412-205">![Workload Owner A adds Workload Contributors](../_images/governance-2-13.png)</span></span>

4. <span data-ttu-id="89412-206">现在，**服务管理员**将**工作负荷所有者 B** 添加到具有内置所有者角色的订阅。</span><span class="sxs-lookup"><span data-stu-id="89412-206">**Service administrator** now adds **workload owner B** to the subscription with the built-in owner role.</span></span> 
<span data-ttu-id="89412-207">![服务管理员将工作负荷所有者 B 添加到订阅](../_images/governance-2-14.png)</span><span class="sxs-lookup"><span data-stu-id="89412-207">![Service Administrator adds Workload Owners B to subscription](../_images/governance-2-14.png)</span></span>

5. <span data-ttu-id="89412-208">**工作负荷所有者 B** 创建**资源组 B**，并按默认添加。</span><span class="sxs-lookup"><span data-stu-id="89412-208">**Workload owner B** creates **resource group B** and is added by default.</span></span> <span data-ttu-id="89412-209">同样，**工作负荷所有者 B** 继承订阅范围的内置所有者角色。</span><span class="sxs-lookup"><span data-stu-id="89412-209">Again, **workload owner B** inherits the built-in owner role from the subscription scope.</span></span>
<span data-ttu-id="89412-210">![工作负荷所有者 B 创建资源组 B](../_images/governance-2-15.png)</span><span class="sxs-lookup"><span data-stu-id="89412-210">![Workload Owner B creates resource group B](../_images/governance-2-15.png)</span></span>

<span data-ttu-id="89412-211">请注意，在此模型中，**服务管理员**执行的操作要比第一个示例中要少，因为管理访问权限委托给了每个工作负荷所有者。</span><span class="sxs-lookup"><span data-stu-id="89412-211">Note that in this model, the **service administrator** performed fewer actions than they did in the first example due to the delegation of management access to each of the individual workload owners.</span></span>

<span data-ttu-id="89412-212">![包含资源组 A 和 B 的订阅](../_images/governance-2-16.png)
*图 5.具有一个服务管理员和两个工作负荷所有者（都分配有内置的所有者角色）的订阅。*</span><span class="sxs-lookup"><span data-stu-id="89412-212">![subscription with resource groups A and B](../_images/governance-2-16.png)
*Figure 5. A subscription with a service administrator and two workload owners, all assigned the built-in owner role.*</span></span>

<span data-ttu-id="89412-213">但是，由于**工作负荷所有者 A** 和**工作负荷所有者 B** 都在订阅范围分配有内置的所有者角色，因此他们都继承了对方资源组的内置所有者角色。</span><span class="sxs-lookup"><span data-stu-id="89412-213">However, because both **workload owner A** and **workload owner B** are assigned the built-in owner role at the subscription scope, they have each inherited the built-in owner role for each other's resource group.</span></span> <span data-ttu-id="89412-214">这意味着，他们不仅对对方的资源拥有完全访问权限，而且还能委托对方资源组的管理访问权限。</span><span class="sxs-lookup"><span data-stu-id="89412-214">This means that not only do they have full access to one another's resources, they are also able to delegate management access to each other's resource groups.</span></span> <span data-ttu-id="89412-215">例如，**工作负荷所有者 B** 有权将其他任何用户添加到**资源组 A**，并可以向该用户分配任何角色，包括内置的所有者角色。</span><span class="sxs-lookup"><span data-stu-id="89412-215">For example, **workload owner B** has rights to add any other user to **resource group A** and can assign any role to them, including the built-in owner role.</span></span>

<span data-ttu-id="89412-216">如果根据要求比较每个示例，可以看到，这两个示例支持订阅范围的单个受信任用户，该用户有权向两个工作负荷所有者授予资源访问权限。</span><span class="sxs-lookup"><span data-stu-id="89412-216">If we compare each example to the requirements, we see that both examples support a single trusted user at the subscription scope with permission to grant resource access rights to the two workload owners.</span></span> <span data-ttu-id="89412-217">默认情况下，其中的两个工作负荷所有者没有资源管理访问权限，要求**服务管理员**显式向其分配权限。</span><span class="sxs-lookup"><span data-stu-id="89412-217">Each of the two workload owners did not have access to resource management by default and required the **service administrator** to explicitly assign permissions to them.</span></span> <span data-ttu-id="89412-218">但是，只有第一个示例能够满足以下要求：与每个工作负荷关联的资源相互隔离，防止任何工作负荷所有者有权访问其他任何工作负荷的的资源。</span><span class="sxs-lookup"><span data-stu-id="89412-218">However, only the first example supports the requirement that the resources associated with each workload are isolated from one another such that no workload owner has access to the resources of any other workload.</span></span>

## <a name="resource-management-model"></a><span data-ttu-id="89412-219">资源管理模型</span><span class="sxs-lookup"><span data-stu-id="89412-219">Resource management model</span></span>

<span data-ttu-id="89412-220">设计最低特权的权限模型后，让我们继续了解这些调控模型的一些实际应用。</span><span class="sxs-lookup"><span data-stu-id="89412-220">Now that we've designed a permissions model of least privilege, let's move on to take a look at some practical applications of these governance models.</span></span> <span data-ttu-id="89412-221">回顾前面所述的要求，我们必须支持以下三个环境：</span><span class="sxs-lookup"><span data-stu-id="89412-221">Recall from the requirements that we must support the following three environments:</span></span>
1. <span data-ttu-id="89412-222">**共享基础结构：** 包含所有工作负荷共享的资源的单个组。</span><span class="sxs-lookup"><span data-stu-id="89412-222">**Shared infrastructure:** a single group of resources shared by all workloads.</span></span> <span data-ttu-id="89412-223">这些资源包括网络网关、防火墙和安全服务等。</span><span class="sxs-lookup"><span data-stu-id="89412-223">These are resources such as network gateways, firewalls, and security services.</span></span>  
2. <span data-ttu-id="89412-224">**开发：** 包含表示多个非生产就绪工作负荷的资源的多个组。</span><span class="sxs-lookup"><span data-stu-id="89412-224">**Development:** multiple groups of resources representing multiple non-production ready workloads.</span></span> <span data-ttu-id="89412-225">这些资源用于概念证明、测试和其他开发人员活动。</span><span class="sxs-lookup"><span data-stu-id="89412-225">These resources are used for proof-of-concept, testing, and other developer activities.</span></span> <span data-ttu-id="89412-226">这些资源可能有更宽松的治理模型，目的是提高开发敏捷性。</span><span class="sxs-lookup"><span data-stu-id="89412-226">These resources may have a more relaxed governance model to enable increased developer agility.</span></span>
3. <span data-ttu-id="89412-227">**生产：** 包含表示多个生产工作负荷的资源的多个组。</span><span class="sxs-lookup"><span data-stu-id="89412-227">**Production:** multiple groups of resources representing multiple production workloads.</span></span> <span data-ttu-id="89412-228">这些资源用于托管私用和公用的应用程序项目。</span><span class="sxs-lookup"><span data-stu-id="89412-228">These resources are used to host the private and public facing application artifacts.</span></span> <span data-ttu-id="89412-229">这些资源通常具有最严格的调控和安全模型，以防未经授权访问资源、应用程序代码和数据。</span><span class="sxs-lookup"><span data-stu-id="89412-229">These resources typically have the tightest governance and security models to protect the resources, application code, and data from unauthorized access.</span></span>

<span data-ttu-id="89412-230">对于上述每个环境，我们的要求是按**工作负荷所有者**和/或**环境**跟踪成本数据。</span><span class="sxs-lookup"><span data-stu-id="89412-230">For each of these three environments, we have a requirement to track cost data by **workload owner**, **environment**, or both.</span></span> <span data-ttu-id="89412-231">也就是说，我们需要了解**共享基础结构**的持续成本、**开发**和**生产**环境中的个人产生的成本，以及**开发**和**生产**的总体成本。</span><span class="sxs-lookup"><span data-stu-id="89412-231">That is, we want to know the ongoing cost of the **shared infrastructure**, the costs incurred by individuals in both the **development** and **production** environments, and finally the overall cost of **development** and **production**.</span></span> 

<span data-ttu-id="89412-232">我们知道资源划分为两个级别：**订阅**和**资源组**。</span><span class="sxs-lookup"><span data-stu-id="89412-232">You have already learned that resources are scoped to two levels: **subscription** and **resource group**.</span></span> <span data-ttu-id="89412-233">因此，首先要确定如何按**订阅**组织环境。</span><span class="sxs-lookup"><span data-stu-id="89412-233">Therefore, the first decision is how to organize environments by **subscription**.</span></span> <span data-ttu-id="89412-234">只存在两种可能：单个订阅或多个订阅。</span><span class="sxs-lookup"><span data-stu-id="89412-234">There are only two possibilities: a single subscription, or, multiple subscriptions.</span></span> 

<span data-ttu-id="89412-235">在学习其中每个模型的示例之前，让我们看看 Azure 中订阅的管理结构。</span><span class="sxs-lookup"><span data-stu-id="89412-235">Before we look at examples of each of these models, let's review the management structure for subscriptions in Azure.</span></span> 

<span data-ttu-id="89412-236">回顾前面所述的要求：组织中有一个人负责订阅，此用户在 Azure AD 租户中拥有**订阅所有者**帐户。</span><span class="sxs-lookup"><span data-stu-id="89412-236">Recall from the requirements that we have an individual in the organization who is responsible for subscriptions, and this user owns the **subscription owner** account in the Azure AD tenant.</span></span> <span data-ttu-id="89412-237">但是，此帐户无权创建订阅。</span><span class="sxs-lookup"><span data-stu-id="89412-237">However, this account does not have permission to create subscriptions.</span></span> <span data-ttu-id="89412-238">只有 **Azure 帐户所有者**有权执行此操作：![](../_images/governance-3-0b.png)
*图 6.Azure 帐户所有者创建订阅。*</span><span class="sxs-lookup"><span data-stu-id="89412-238">Only the **Azure Account Owner** has permission to do this: ![](../_images/governance-3-0b.png)
*Figure 6. An Azure Account Owner creates a subscription.*</span></span>

<span data-ttu-id="89412-239">创建订阅后，**Azure 帐户所有者**可将具有**所有者**角色的**订阅所有者**帐户添加到订阅：</span><span class="sxs-lookup"><span data-stu-id="89412-239">Once the subscription has been created, the **Azure Account Owner** can add the **subscription owner** account to the subscription with the **owner** role:</span></span>

<span data-ttu-id="89412-240">![](../_images/governance-3-0c.png)
*图 7.Azure 帐户所有者将具有**所有者**角色的**订阅所有者**用户帐户添加到订阅。*</span><span class="sxs-lookup"><span data-stu-id="89412-240">![](../_images/governance-3-0c.png)
*Figure 7. The Azure Account Owner adds the **subscription owner** user account to the subscription with the **owner** role.*</span></span>

<span data-ttu-id="89412-241">现在，**订阅所有者**可以创建**资源组**，并委托资源访问管理权限。</span><span class="sxs-lookup"><span data-stu-id="89412-241">The **subscription owner** can now create **resource groups** and delegate resource access management.</span></span>

<span data-ttu-id="89412-242">让我们探讨一个使用单个订阅的资源管理模型示例。</span><span class="sxs-lookup"><span data-stu-id="89412-242">First let's look at an example resource management model using a single subscription.</span></span> <span data-ttu-id="89412-243">首先确定如何使资源组与三个环境相符。</span><span class="sxs-lookup"><span data-stu-id="89412-243">The first decision is how to align resource groups to the three environments.</span></span> <span data-ttu-id="89412-244">有两种做法：</span><span class="sxs-lookup"><span data-stu-id="89412-244">We have two options:</span></span>
1. <span data-ttu-id="89412-245">使每个环境与单个资源组相符。</span><span class="sxs-lookup"><span data-stu-id="89412-245">Align each environment to a single resource group.</span></span> <span data-ttu-id="89412-246">将所有共享基础结构资源部署到单个**共享基础结构**资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-246">All shared infrastructure resources are deployed to a single **shared infrastructure** resource group.</span></span> <span data-ttu-id="89412-247">将与开发工作负荷关联的所有资源部署到单个**开发**资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-247">All resources associated with development workloads are deployed to a single **development** resource group.</span></span> <span data-ttu-id="89412-248">将与生产工作负荷关联的所有资源部署到**生产**环境的单个**生产**资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-248">All resources associated with production workloads are deployed into a single **production** resource group for the **production** environment.</span></span> 
2. <span data-ttu-id="89412-249">为每个工作负荷创建单独的资源组，使用命名约定和标记，使资源组与三个环境中的每个相符。</span><span class="sxs-lookup"><span data-stu-id="89412-249">Create separate resource groups for each workload, using a naming convention and tags to align resource groups with each of the three environments.</span></span>  

<span data-ttu-id="89412-250">首先让我们评估第一种做法。</span><span class="sxs-lookup"><span data-stu-id="89412-250">Let's begin by evaluating the first option.</span></span> <span data-ttu-id="89412-251">我们将使用上一部分所述的权限模型，其中的单个订阅服务管理员创建了资源组，并将具有内置**参与者**或**读取者**角色的用户添加到这些资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-251">We'll be using the permissions model that we discussed in the previous section, with a single subscription service administrator who creates resource groups and adds users to them with either the built-in **contributor** or **reader** role.</span></span> 

1. <span data-ttu-id="89412-252">部署的第一个资源组表示**共享基础结构**环境。</span><span class="sxs-lookup"><span data-stu-id="89412-252">The first resource group deployed represents the **shared infrastructure** environment.</span></span> <span data-ttu-id="89412-253">**订阅所有者**为共享基础结构资源创建名为 **netops-shared-rg** 的资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-253">The **subscription owner** creates a resource group for the shared infrastructure resources named **netops-shared-rg**.</span></span> 
![](../_images/governance-3-0d.png)
2. <span data-ttu-id="89412-254">**订阅所有者**将**网络操作用户**帐户添加到资源组，并分配**参与者**角色。</span><span class="sxs-lookup"><span data-stu-id="89412-254">The **subscription owner** adds the **network operations user** account to the resource group and assigns the **contributor** role.</span></span> 
![](../_images/governance-3-0e.png)
3. <span data-ttu-id="89412-255">**网络操作用户**创建 [VPN 网关](/azure/vpn-gateway/vpn-gateway-about-vpngateways)，并将其配置为连接到本地 VPN 设备。</span><span class="sxs-lookup"><span data-stu-id="89412-255">The **network operations user** creates a [VPN gateway](/azure/vpn-gateway/vpn-gateway-about-vpngateways) and configures it to connect to the on-premises VPN appliance.</span></span> <span data-ttu-id="89412-256">**网络操作**用户还对每个资源应用一对[标记](/azure/azure-resource-manager/resource-group-using-tags)：*environment:shared* 和 *managedBy:netOps*。</span><span class="sxs-lookup"><span data-stu-id="89412-256">The **network operations** user also applies a pair of [tags](/azure/azure-resource-manager/resource-group-using-tags) to each of the resources: *environment:shared* and *managedBy:netOps*.</span></span> <span data-ttu-id="89412-257">当**订阅服务管理员**导出成本报告时，成本将与其中的每个标记相符。</span><span class="sxs-lookup"><span data-stu-id="89412-257">When the **subscription service administrator** exports a cost report, costs will be aligned with each of these tags.</span></span> <span data-ttu-id="89412-258">这样，**订阅服务管理员**便可以使用 *environment* 标记和 *managedBy* 标记来透视成本。</span><span class="sxs-lookup"><span data-stu-id="89412-258">This allows the **subscription service administrator** to pivot costs using the *environment* tag and the *managedBy* tag.</span></span> <span data-ttu-id="89412-259">请注意插图右上方的**资源限制**计数器。</span><span class="sxs-lookup"><span data-stu-id="89412-259">Notice the **resource limits** counter at the top right-hand side of the figure.</span></span> <span data-ttu-id="89412-260">每个 Azure 订阅都有[服务限制](/azure/azure-subscription-service-limits)，旨在帮助你了解这些限制的影响，我们会遵守每个订阅的虚拟网络限制。</span><span class="sxs-lookup"><span data-stu-id="89412-260">Each Azure subscription has [service limits](/azure/azure-subscription-service-limits), and to help you understand the effect of these limits we'll follow the virtual network limit for each subscription.</span></span> <span data-ttu-id="89412-261">每个订阅的虚拟网络数默认限制为 50 个，部署第一个虚拟网络后，还有 49 个虚拟网络可用。</span><span class="sxs-lookup"><span data-stu-id="89412-261">There is a default limit of 50 virtual networks per subscription, and after the first virtual network is deployed there are now 49 available.</span></span>
![](../_images/governance-3-1.png)
4. <span data-ttu-id="89412-262">再部署两个资源组，其中的第一个资源组名为 *prod-rg*。</span><span class="sxs-lookup"><span data-stu-id="89412-262">Two more resource groups are deployed, the first is named *prod-rg*.</span></span> <span data-ttu-id="89412-263">此资源组与**生产**环境相符。</span><span class="sxs-lookup"><span data-stu-id="89412-263">This resource group is aligned with the **production** environment.</span></span> <span data-ttu-id="89412-264">第二个资源组名为 *dev-rg*，与**开发**环境相符。</span><span class="sxs-lookup"><span data-stu-id="89412-264">The second is named *dev-rg* and is aligned with the **development** environment.</span></span> <span data-ttu-id="89412-265">与生产工作负荷关联的所有资源部署到**生产**环境，与开发工作负荷关联的所有资源部署到**开发**环境。</span><span class="sxs-lookup"><span data-stu-id="89412-265">All resources associated with production workloads are deployed to the **production** environment and all resources associated with development workloads are deployed to the **development** environment.</span></span> <span data-ttu-id="89412-266">本示例只将两个工作负荷部署到这两种环境，因此，我们不会遇到任何 Azure 订阅服务限制。</span><span class="sxs-lookup"><span data-stu-id="89412-266">In this example we'll only deploy two workloads to each of these two environments so we won't encounter any Azure subscription service limits.</span></span> <span data-ttu-id="89412-267">但是，请务必注意，每个资源组的资源数限制为 800 个。</span><span class="sxs-lookup"><span data-stu-id="89412-267">However, it's important to consider that each resource group has a limit of 800 resources per resource group.</span></span> <span data-ttu-id="89412-268">因此，如果我们不断地将工作负荷添加到每个资源组，则有可能会达到此限制。</span><span class="sxs-lookup"><span data-stu-id="89412-268">Therefore, if we keep adding workloads to each resource group it is possible that this limit will be reached.</span></span> 
![](../_images/governance-3-2.png)
5. <span data-ttu-id="89412-269">第一个**工作负荷所有者**将请求发送到**订阅服务管理员**，并已添加到具有**参与者**角色的每个**开发**和**生产**环境资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-269">The first **workload owner** sends a request to the **subscription service administrator** and is added to each of the **development** and **production** environment resource groups with the **contributor** role.</span></span> <span data-ttu-id="89412-270">如前所述，**参与者**角色允许用户执行任何操作，但不允许向其他用户分配角色。</span><span class="sxs-lookup"><span data-stu-id="89412-270">As you learned earlier, the **contributor** role allows the user to perform any operation other than assigning a role to another user.</span></span> <span data-ttu-id="89412-271">第一个**工作负荷所有者**现在可以创建与其工作负荷关联的资源。</span><span class="sxs-lookup"><span data-stu-id="89412-271">The first **workload owner** can now create the resources associated with their workload.</span></span>
![](../_images/governance-3-3.png)
6. <span data-ttu-id="89412-272">第一个**工作负荷所有者**在每个资源组（共两个）中创建一个虚拟网络，其中的每个虚拟网络包含一对虚拟机。</span><span class="sxs-lookup"><span data-stu-id="89412-272">The first **workload owner** creates a virtual network in each of the two resource groups with a pair of virtual machines in each.</span></span> <span data-ttu-id="89412-273">第一个**工作负荷所有者**向所有资源应用 *environment* 和 *managedBy* 标记。</span><span class="sxs-lookup"><span data-stu-id="89412-273">The first **workload owner** applies the *environment* and *managedBy* tags to all resources.</span></span> <span data-ttu-id="89412-274">请注意，Azure 服务限制计数器现在显示剩余 47 个虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="89412-274">Note that the Azure service limit counter is now at 47 virtual networks remaining.</span></span>
![](../_images/governance-3-4.png)
7. <span data-ttu-id="89412-275">创建每个虚拟网络时，该网络并未建立本地连接。</span><span class="sxs-lookup"><span data-stu-id="89412-275">Each of the virtual networks does not have connectivity to on-premises when they are created.</span></span> <span data-ttu-id="89412-276">在此类体系结构中，每个虚拟网络必须对等互连到**共享基础结构**环境中的 *hub-vnet*。</span><span class="sxs-lookup"><span data-stu-id="89412-276">In this type of architecture, each virtual network must be peered to the *hub-vnet* in the **shared infrastructure** environment.</span></span> <span data-ttu-id="89412-277">虚拟网络对等互连在两个独立的虚拟网络之间创建连接，并允许网络流量在两者之间遍历。</span><span class="sxs-lookup"><span data-stu-id="89412-277">Virtual network peering creates a connection between two separate virtual networks and allows network traffic to travel between them.</span></span> <span data-ttu-id="89412-278">请注意，虚拟网络对等互连在本质上并非是可传递的。</span><span class="sxs-lookup"><span data-stu-id="89412-278">Note that virtual network peering is not inherently transitive.</span></span> <span data-ttu-id="89412-279">必须在连接的两个虚拟网络中指定对等互连；如果只有一个虚拟网络指定了对等互连，则连接是不完整的。</span><span class="sxs-lookup"><span data-stu-id="89412-279">A peering must be specified in each of the two virtual networks that are connected, and if only one of the virtual networks specifies a peering the connection is incomplete.</span></span> <span data-ttu-id="89412-280">为了演示这种效果，第一个**工作负荷所有者**在 **prod-vnet** 与 **hub-vnet** 之间指定了对等互连。</span><span class="sxs-lookup"><span data-stu-id="89412-280">To illustrate the effect of this, the first **workload owner** specifies a peering between **prod-vnet** and **hub-vnet**.</span></span> <span data-ttu-id="89412-281">已创建第一个对等互连，但流量并未流动，因为尚未指定从 **hub-vnet** 到 **prod-vnet** 的互补性对等互连。</span><span class="sxs-lookup"><span data-stu-id="89412-281">The first peering is created, but no traffic flows because the complementary peering from **hub-vnet** to **prod-vnet** has not yet been specified.</span></span> <span data-ttu-id="89412-282">第一个**工作负荷所有者**联系**网络操作**用户，并请求建立这种互补性对等连接。</span><span class="sxs-lookup"><span data-stu-id="89412-282">The first **workload owner** contacts the **network operations** user and requests this complementary peering connection.</span></span>
![](../_images/governance-3-5.png)
8. <span data-ttu-id="89412-283">**网络操作**用户审查请求，批准请求，然后在 **hub-vnet** 的设置中指定对等互连。</span><span class="sxs-lookup"><span data-stu-id="89412-283">The **network operations** user reviews the request, approves it, then specifies the peering in the settings for the **hub-vnet**.</span></span> <span data-ttu-id="89412-284">对等连接现在是完整的，网络流量可在两个虚拟网络之间流动。</span><span class="sxs-lookup"><span data-stu-id="89412-284">The peering connection is now complete and network traffic flows between the two virtual networks.</span></span>
![](../_images/governance-3-6.png)
9. <span data-ttu-id="89412-285">现在，第二个**工作负荷所有者**将请求发送到**订阅服务管理员**，并已添加到具有**参与者**角色的现有**生产**和**开发**环境资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-285">Now, a second **workload owner** sends a request to the **subscription service administrator** and is added to the existing **production** and **development** environment resource groups with the **contributor** role.</span></span> <span data-ttu-id="89412-286">第二个**工作负荷所有者**对每个资源组中的所有资源的权限与第一个**工作负荷所有者**相同。</span><span class="sxs-lookup"><span data-stu-id="89412-286">The second **workload owner** has the same permissions on all resources as the first **workload owner** in each resource group.</span></span> 
![](../_images/governance-3-7.png)
10. <span data-ttu-id="89412-287">第二个**工作负荷所有者**在 **prod-vnet** 虚拟网络中创建子网，然后添加两个虚拟机。</span><span class="sxs-lookup"><span data-stu-id="89412-287">The second **workload owner** creates a subnet in the **prod-vnet** virtual network, then adds two virtual machines.</span></span> <span data-ttu-id="89412-288">第二个**工作负荷所有者**向每个资源应用 *environment* 和 *managedBy* 标记。</span><span class="sxs-lookup"><span data-stu-id="89412-288">The second **workload owner** applies the *environment* and *managedBy* tags to each resource.</span></span>
![](../_images/governance-3-8.png) 

<span data-ttu-id="89412-289">此示例资源管理模型使我们能够管理三个所需环境中的资源。</span><span class="sxs-lookup"><span data-stu-id="89412-289">This example resource management model enables us to manage resources in the three required environments.</span></span> <span data-ttu-id="89412-290">共享基础结构资源受到保护，因为订阅中只有一个用户有权访问这些资源。</span><span class="sxs-lookup"><span data-stu-id="89412-290">The shared infrastructure resources are protected because there's only a single user in the subscription with permission to access those resources.</span></span> <span data-ttu-id="89412-291">每个工作负荷所有者能够利用共享基础结构资源，但对于实际的共享资源本身没有任何权限。</span><span class="sxs-lookup"><span data-stu-id="89412-291">Each of the workload owners is able to utilize the share infrastructure resources without having any permissions on the actual shared resources themselves.</span></span> <span data-ttu-id="89412-292">但是，此管理模型并不符合工作负荷隔离的要求 - 两个**工作负荷所有者**都能访问对方工作负荷的资源。</span><span class="sxs-lookup"><span data-stu-id="89412-292">However, This management model fails the requirement for workload isolation - each of the two **workload owners** are able to access the resources of the other's workload.</span></span> 

<span data-ttu-id="89412-293">对于此模型，还有一个重要的考虑因素比较容易忽略。</span><span class="sxs-lookup"><span data-stu-id="89412-293">There's another important consideration with this model that may not be immediately obvious.</span></span> <span data-ttu-id="89412-294">在本示例中，**app1 工作负荷所有者**请求与 **hub-vnet** 建立网络对等互连连接，以便连接到本地。</span><span class="sxs-lookup"><span data-stu-id="89412-294">In the example, it was **app1 workload owner** that requested the network peering connection with the **hub-vnet** to provide connectivity to on-premises.</span></span> <span data-ttu-id="89412-295">**网络操作**用户已根据连同工作负荷一起部署的资源评估该请求。</span><span class="sxs-lookup"><span data-stu-id="89412-295">The **network operations** user evaluated that request based on the resources deployed with that workload.</span></span> <span data-ttu-id="89412-296">当**订阅所有者**添加具有**参与者**角色的 **app2 工作负荷所有者**时，该工作负荷所有者用户对 **prod-rg** 资源组中的所有资源拥有管理访问权限。</span><span class="sxs-lookup"><span data-stu-id="89412-296">When the **subscription owner** added **app2 workload owner** with the **contributor** role, that user had management access rights to all resources in the **prod-rg** resource group.</span></span> 

![](../_images/governance-3-10.png)

<span data-ttu-id="89412-297">这意味着，**app2 工作负荷所有者**有权在 **prod-vnet** 虚拟网络中部署自己的包含虚拟机的子网。</span><span class="sxs-lookup"><span data-stu-id="89412-297">This means **app2 workload owner** had permission to deploy their own subnet with virtual machines in the **prod-vnet** virtual network.</span></span> <span data-ttu-id="89412-298">默认情况下，这些虚拟机现在有权访问本地网络。</span><span class="sxs-lookup"><span data-stu-id="89412-298">By default, those virtual machines now have access to the on-premises network.</span></span> <span data-ttu-id="89412-299">**网络操作**用户并不知道这些虚拟机，并且未批准建立本地连接。</span><span class="sxs-lookup"><span data-stu-id="89412-299">The **network operations** user is not aware of those machines and did not approve their connectivity to on-premises.</span></span>

<span data-ttu-id="89412-300">接下来，让我们探讨单个订阅，其中包含不同环境和工作负荷的多个资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-300">Next, let's look at a single subscription with multiple resources groups for different environments and workloads.</span></span> <span data-ttu-id="89412-301">请注意，在前面的示例中，每个环境的资源很容易识别，因为它们在同一个资源组中。</span><span class="sxs-lookup"><span data-stu-id="89412-301">Note that in the previous example, the resources for each environment were easily identifiable because they were in the same resource group.</span></span> <span data-ttu-id="89412-302">既然我们不再使用这种分组，因此需要依赖于资源组命名约定来提供该功能。</span><span class="sxs-lookup"><span data-stu-id="89412-302">Now that we no longer have that grouping, we will have to rely on a resource group naming convention to provide that functionality.</span></span> 

1. <span data-ttu-id="89412-303">在此模型中，**共享基础结构**资源仍具有单独的资源组，因此没有变化。</span><span class="sxs-lookup"><span data-stu-id="89412-303">The **shared infrastructure** resources will still have a separate resource group in this model, so that remains the same.</span></span> <span data-ttu-id="89412-304">每个工作负荷需要两个资源组 - 每个**开发**和**生产**环境各有一个资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-304">Each workload requires two resource groups - one for each of the **development** and **production** environments.</span></span> <span data-ttu-id="89412-305">针对第一个工作负荷，**订阅所有者**创建了两个资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-305">For the first workload, the **subscription owner** creates two resource groups.</span></span> <span data-ttu-id="89412-306">第一个资源组名为 **app1-prod-rg**，第二个资源组名为 **app1-dev-rg**。</span><span class="sxs-lookup"><span data-stu-id="89412-306">The first is named **app1-prod-rg** and the second one is named **app1-dev-rg**.</span></span> <span data-ttu-id="89412-307">如前所述，此命名约定分别将资源标识为与第一个工作负荷 **app1**，以及 **dev** 或 **prod** 环境相关联。</span><span class="sxs-lookup"><span data-stu-id="89412-307">As discussed earlier, this naming convention identifies the resources as being associated with the first workload, **app1**, and either the **dev** or **prod** environment.</span></span> <span data-ttu-id="89412-308">同样，*订阅*所有者将具有**参与者**角色的 **app1 工作负荷所有者**添加到资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-308">Again, the *subscription* owner adds **app1 workload owner** to the resource group with the **contributor** role.</span></span>
![](../_images/governance-3-12.png)
2. <span data-ttu-id="89412-309">类似于第一个示例，**app1 工作负荷所有者**将名为 **app1-prod-vnet** 的虚拟网络部署到**生产**环境中，将名为 **app1-dev-vnet** 的另一个虚拟网络部署到**开发**环境。</span><span class="sxs-lookup"><span data-stu-id="89412-309">Similar to the first example, **app1 workload owner** deploys a virtual network named **app1-prod-vnet** to the **production** environment, and another named **app1-dev-vnet** to the **development** environment.</span></span> <span data-ttu-id="89412-310">同样，**app1 工作负荷所有者**将请求发送到**网络操作**用户，以创建对等连接。</span><span class="sxs-lookup"><span data-stu-id="89412-310">Again, **app1 workload owner** sends a request to the **network operations** user to create a peering connection.</span></span> <span data-ttu-id="89412-311">请注意，**app1 工作负荷所有者**添加了与第一个示例中相同的标记，限制计数器显示订阅中剩余的虚拟网络数递减到 47 个。</span><span class="sxs-lookup"><span data-stu-id="89412-311">Note that **app1 workload owner** adds the same tags as in the first example, and the limit counter has been decremented to 47 virtual networks remaining in the subscription.</span></span>
![](../_images/governance-3-13.png)
3. <span data-ttu-id="89412-312">现在，**订阅所有者**为 **app2 工作负荷所有者**创建两个资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-312">The **subscription owner** now creates two resource groups for **app2 workload owner**.</span></span> <span data-ttu-id="89412-313">遵循适用于**app1 工作负荷所有者**的相同约定，将资源组命名为 **app2-prod-rg** 和 **app2-dev-rg**。</span><span class="sxs-lookup"><span data-stu-id="89412-313">Following the same conventions as for **app1 workload owner**, the resource groups are named **app2-prod-rg** and **app2-dev-rg**.</span></span> <span data-ttu-id="89412-314">**订阅所有者**将具有**参与者**角色的 **app2 工作负荷所有者**添加到每个资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-314">The **subscription owner** adds **app2 workload owner** to each of the resource groups with the **contributor** role.</span></span>
![](../_images/governance-3-14.png)
4. <span data-ttu-id="89412-315">*app2 工作负荷所有者*使用相同的命名约定将虚拟网络和虚拟机部署到资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-315">*App2 workload owner* deploys virtual networks and virtual machines to the resource groups with the same naming conventions.</span></span> <span data-ttu-id="89412-316">添加标记，限制计数器显示*订阅*中剩余的虚拟网络数递减到 45 个。</span><span class="sxs-lookup"><span data-stu-id="89412-316">Tags are added and the limit counter has been decremented to 45 virtual networks remaining in the *subscription*.</span></span>
![](../_images/governance-3-15.png)
5. <span data-ttu-id="89412-317">*app2 工作负荷所有者*将请求发送到*网络操作*用户，以便在 *app2-prod-vnet* 与 *hub-vnet* 之间建立对等互连。</span><span class="sxs-lookup"><span data-stu-id="89412-317">*App2 workload owner* sends a request to the *network operations* user to peer the *app2-prod-vnet* with the *hub-vnet*.</span></span> <span data-ttu-id="89412-318">*网络操作*用户创建对等连接。</span><span class="sxs-lookup"><span data-stu-id="89412-318">The *network operations* user creates the peering connection.</span></span>
![](../_images/governance-3-16.png)

<span data-ttu-id="89412-319">生成的管理模型类似于第一个示例，但两者存在一些重要差别：</span><span class="sxs-lookup"><span data-stu-id="89412-319">The resulting management model is similar to the first example, with several key differences:</span></span>
* <span data-ttu-id="89412-320">已按工作负载和环境将两个工作负荷相隔离。</span><span class="sxs-lookup"><span data-stu-id="89412-320">Each of the two workloads is isolated by workload and by environment.</span></span>
* <span data-ttu-id="89412-321">与第一个示例模型不同，此模型需要两个额外的虚拟网络。</span><span class="sxs-lookup"><span data-stu-id="89412-321">This model required two more virtual networks than the first example model.</span></span> <span data-ttu-id="89412-322">尽管这与只使用两个工作负荷没有重大的差别，但此模型的工作负荷数目理论限制为 24 个。</span><span class="sxs-lookup"><span data-stu-id="89412-322">While this is not an important distinction with only two workloads, the theoretical limit on the number of workloads for this model is 24.</span></span> 
* <span data-ttu-id="89412-323">资源不再分组到每个环境的单个资源组中。</span><span class="sxs-lookup"><span data-stu-id="89412-323">Resources are no longer grouped in a single resource group for each environment.</span></span> <span data-ttu-id="89412-324">将资源分组需要了解每个环境使用的命名约定。</span><span class="sxs-lookup"><span data-stu-id="89412-324">Grouping resources requires an understanding of the naming conventions used for each environment.</span></span> 
* <span data-ttu-id="89412-325">*网络操作*用户已审查并批准每个虚拟网络对等互连。</span><span class="sxs-lookup"><span data-stu-id="89412-325">Each of the peered virtual network connections was reviewed and approved by the *network operations* user.</span></span>

<span data-ttu-id="89412-326">现在，让我们探讨一个使用多个订阅的资源管理模型。</span><span class="sxs-lookup"><span data-stu-id="89412-326">Now let's look at a resource management model using multiple subscriptions.</span></span> <span data-ttu-id="89412-327">在此模型中，我们要使以下每个环境与单独的订阅相符：**共享服务**订阅、**生产**订阅和**开发**订阅。</span><span class="sxs-lookup"><span data-stu-id="89412-327">In this model, we'll align each of the three environments to a separate subscription: a **shared services** subscription, **production** subscription, and finally a **development** subscription.</span></span> <span data-ttu-id="89412-328">此模型的考虑因素与使用单个订阅的模型类似，两者都需要确定如何使资源组与工作负荷相符。</span><span class="sxs-lookup"><span data-stu-id="89412-328">The considerations for this model are similar to a model using a single subscription in that we have to decide how to align resource groups to workloads.</span></span> <span data-ttu-id="89412-329">我们已确定，为每个工作负荷创建资源组能够满足工作负荷隔离要求，因此，我们会在此示例中继续使用该模型。</span><span class="sxs-lookup"><span data-stu-id="89412-329">We've already determined that creating a resource group for each workload satisfies the workload isolation requirement, so we'll stick with that model in this example.</span></span>

1. <span data-ttu-id="89412-330">此模型包含三个*订阅*：*共享基础结构*、*生产*和*开发*。</span><span class="sxs-lookup"><span data-stu-id="89412-330">In this model, there are three *subscriptions*: *shared infrastructure*, *production*, and *development*.</span></span> <span data-ttu-id="89412-331">这三个订阅中的每一个都需要一个*订阅所有者*。本示例为简单起见，对所有三个订阅使用了相同的用户帐户。</span><span class="sxs-lookup"><span data-stu-id="89412-331">Each of these three subscriptions requires a *subscription owner*, and in the simple example we'll use the same user account for all three.</span></span> <span data-ttu-id="89412-332">*共享基础结构*资源的管理方式类似于前两个示例，第一个工作负荷与*生产*环境中的 *app1-rg*，以及*开发*环境中的同名资源组相关联。</span><span class="sxs-lookup"><span data-stu-id="89412-332">The *shared infrastructure* resources are managed similarly to the first two examples above, and the first workload is associated with the *app1-rg* in the *production* environment and the same-named resource group in the *development* environment.</span></span> <span data-ttu-id="89412-333">*app1 工作负荷所有者*已添加到具有*参与者*角色的每个资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-333">The *app1 workload owner* is added to each of the resource group with the *contributor* role.</span></span> 
![](../_images/governance-3-17.png)
2. <span data-ttu-id="89412-334">与前面的示例一样，*app1 工作负荷所有者*创建了资源，并请求与*共享基础结构*虚拟网络建立对等连接。</span><span class="sxs-lookup"><span data-stu-id="89412-334">As with the earlier examples, *app1 workload owner* creates the resources and requests the peering connection with the *shared infrastructure* virtual network.</span></span> <span data-ttu-id="89412-335">*app1 工作负荷所有者*仅添加了 *managedBy* 标记，因为不再需要 *environment* 标记。</span><span class="sxs-lookup"><span data-stu-id="89412-335">*App1 workload owner* adds only the *managedBy* tag because there is no longer a need for the *environment* tag.</span></span> <span data-ttu-id="89412-336">因此，每个环境的资源现已分组到相同的*订阅*，而 *environment* 标记是多余的。</span><span class="sxs-lookup"><span data-stu-id="89412-336">That is, resources are for each environment are now grouped in the same *subscription* and the *environment* tag is redundant.</span></span> <span data-ttu-id="89412-337">限制计数器显示剩余的虚拟网络数递减到 49 个。</span><span class="sxs-lookup"><span data-stu-id="89412-337">The limit counter is decremented to 49 virtual networks remaining.</span></span>
![](../_images/governance-3-18.png)
3. <span data-ttu-id="89412-338">最后，*订阅所有者*针对第二个工作负荷重复上述过程添加资源组，其中包含具有 \*参与者角色的 *app2 工作负荷所有者*。</span><span class="sxs-lookup"><span data-stu-id="89412-338">Finally, the *subscription owner* repeats the process for the second workload, adding the resource groups with the *app2 workload owner* in the \*contributor role.</span></span> <span data-ttu-id="89412-339">每个环境订阅的限制计数器显示剩余的虚拟网络数递减到 48 个。</span><span class="sxs-lookup"><span data-stu-id="89412-339">The limit counter for each of the environment subscriptions is decremented to 48 virtual networks remaining.</span></span> 

<span data-ttu-id="89412-340">相比上面的第二个示例，此管理模型存在一定的优势。</span><span class="sxs-lookup"><span data-stu-id="89412-340">This management model has the benefits of the second example above.</span></span> <span data-ttu-id="89412-341">但是，重要差别在于，限制不是一个很大的问题，因为虚拟网络分散在两个*订阅*之间。</span><span class="sxs-lookup"><span data-stu-id="89412-341">However, the key difference is that limits are less of an issue due to the fact that they are spread over two *subscriptions*.</span></span> <span data-ttu-id="89412-342">缺点是，必须跨所有三个*订阅*聚合按标记跟踪的成本数据。</span><span class="sxs-lookup"><span data-stu-id="89412-342">The drawback is that the cost data tracked by tags must be aggregated across all three *subscriptions*.</span></span> 

<span data-ttu-id="89412-343">因此，可以根据要求的优先级选择这两个示例资源管理模型中的任何一个。</span><span class="sxs-lookup"><span data-stu-id="89412-343">Therefore, you can select any of these two examples resource management models depending on the priority of your requirements.</span></span> <span data-ttu-id="89412-344">如果你预见到组织不会达到单个订阅的服务限制，则可以使用包含多个资源组的单个订阅。</span><span class="sxs-lookup"><span data-stu-id="89412-344">If you anticipate that your organization will not reach the service limits for a single subscription, you can use a single subscription with multiple resource groups.</span></span> <span data-ttu-id="89412-345">相反，如果预计组织中会出现许多工作负载，则对每个环境使用多个订阅可能会更好。</span><span class="sxs-lookup"><span data-stu-id="89412-345">Conversely, if your organization anticipates many workloads, multiple subscriptions for each environment may be better.</span></span>

## <a name="implementing-the-resource-management-model"></a><span data-ttu-id="89412-346">实现资源管理模型</span><span class="sxs-lookup"><span data-stu-id="89412-346">Implementing the resource management model</span></span>

<span data-ttu-id="89412-347">你已了解用于调控 Azure 资源访问权限的多个不同模型。</span><span class="sxs-lookup"><span data-stu-id="89412-347">You've learned about several different models for governing access to Azure resources.</span></span> <span data-ttu-id="89412-348">现在，让我们执行所需的每个步骤，针对设计指南中的每个**共享基础结构**、**生产**和**开发**环境，实施包含一个订阅的资源管理模型。</span><span class="sxs-lookup"><span data-stu-id="89412-348">Now we'll walk through the steps necessary to implement the resource management model with one subscription for each of the **shared infrastructure**, **production**, and **development** environments from the design guide.</span></span> <span data-ttu-id="89412-349">我们将为所有三个环境创建一个**订阅所有者**。</span><span class="sxs-lookup"><span data-stu-id="89412-349">We'll have one **subscription owner** for all three environments.</span></span> <span data-ttu-id="89412-350">每个工作负荷将在某个**资源组**中隔离，该资源组包含具有**参与者**角色的**工作负荷所有者**。</span><span class="sxs-lookup"><span data-stu-id="89412-350">Each workload will be isolated in a **resource group** with a **workload owner** added with the **contributor** role.</span></span>

> [!NOTE]
> <span data-ttu-id="89412-351">请阅读[了解 Azure 中的资源访问][understand-resource-access-in-azure]，详细了解 Azure 帐户与订阅之间的关系。</span><span class="sxs-lookup"><span data-stu-id="89412-351">Read [understanding resource access in Azure][understand-resource-access-in-azure] to learn more about the relationship between Azure Accounts and subscriptions.</span></span> 

<span data-ttu-id="89412-352">执行以下步骤:</span><span class="sxs-lookup"><span data-stu-id="89412-352">Follow these steps:</span></span>

1. <span data-ttu-id="89412-353">如果组织没有 [Azure 帐户](/azure/active-directory/sign-up-organization)，请创建一个帐户。</span><span class="sxs-lookup"><span data-stu-id="89412-353">Create an [Azure account](/azure/active-directory/sign-up-organization) if your organization doesn't already have one.</span></span> <span data-ttu-id="89412-354">注册 Azure 帐户的人员将成为 Azure 帐户管理员，组织的领导层必须选择一个充当此角色的人员。</span><span class="sxs-lookup"><span data-stu-id="89412-354">The person who signs up for the Azure account becomes the Azure account administrator, and your organization's leadership must select an individual to assume this role.</span></span> <span data-ttu-id="89412-355">此人将会负责：</span><span class="sxs-lookup"><span data-stu-id="89412-355">This individual will be responsible for:</span></span>
    * <span data-ttu-id="89412-356">创建订阅，以及</span><span class="sxs-lookup"><span data-stu-id="89412-356">Creating subscriptions, and</span></span>
    * <span data-ttu-id="89412-357">创建和管理用于存储这些订阅的用户标识的 [Azure Active Directory (AD)](/azure/active-directory/active-directory-whatis) 租户。</span><span class="sxs-lookup"><span data-stu-id="89412-357">Creating and administering [Azure Active Directory (AD)](/azure/active-directory/active-directory-whatis) tenants that store user identity for those subscriptions.</span></span>    
2. <span data-ttu-id="89412-358">组织领导团队确定哪个人员承担以下责任：</span><span class="sxs-lookup"><span data-stu-id="89412-358">Your organization's leadership team decides which people are responsible for:</span></span>
    * <span data-ttu-id="89412-359">管理用户标识；创建组织的 Azure 帐户时，默认会创建 [Azure AD 租户](/azure/active-directory/develop/active-directory-howto-tenant)，并且默认会将帐户管理员添加为 [Azure AD 全局管理员](/azure/active-directory/active-directory-assign-admin-roles-azure-portal#details-about-the-global-administrator-role)。</span><span class="sxs-lookup"><span data-stu-id="89412-359">Management of user identity; an [Azure AD tenant](/azure/active-directory/develop/active-directory-howto-tenant) is created by default when your organization's Azure Account is created, and the account administrator is added as the [Azure AD global administrator](/azure/active-directory/active-directory-assign-admin-roles-azure-portal#details-about-the-global-administrator-role) by default.</span></span> <span data-ttu-id="89412-360">组织可以选择另一个用户来管理用户标识，只需[将 Azure AD 全局管理员角色分配到该用户](/azure/active-directory/active-directory-users-assign-role-azure-portal)即可。</span><span class="sxs-lookup"><span data-stu-id="89412-360">Your organization can choose another user to manage user identity by [assigning the Azure AD global administrator role to that user](/azure/active-directory/active-directory-users-assign-role-azure-portal).</span></span> 
    * <span data-ttu-id="89412-361">订阅，表示这些用户将负责：</span><span class="sxs-lookup"><span data-stu-id="89412-361">Subscriptions, which means these users:</span></span>
        * <span data-ttu-id="89412-362">管理与该订阅中的资源用量相关的成本；</span><span class="sxs-lookup"><span data-stu-id="89412-362">Manage costs associated with resource usage in that subscription,</span></span>
        * <span data-ttu-id="89412-363">实现和维护用于资源访问的最低权限模型；</span><span class="sxs-lookup"><span data-stu-id="89412-363">Implement and maintain least permission model for resource access, and</span></span>
        * <span data-ttu-id="89412-364">跟踪服务限制。</span><span class="sxs-lookup"><span data-stu-id="89412-364">Keep track of service limits.</span></span>
    * <span data-ttu-id="89412-365">共享基础结构服务（如果组织决定使用此模型），表示此用户将负责：</span><span class="sxs-lookup"><span data-stu-id="89412-365">Shared infrastructure services (if your organization decides to use this model), which means this user is responsible for:</span></span>
        * <span data-ttu-id="89412-366">建立本地到 Azure 的网络连接，以及</span><span class="sxs-lookup"><span data-stu-id="89412-366">On-premises to Azure network connectivity, and</span></span> 
        * <span data-ttu-id="89412-367">通过虚拟网络对等互连管理 Azure 中的网络连接。</span><span class="sxs-lookup"><span data-stu-id="89412-367">Ownership of network connectivity within Azure through virtual network peering.</span></span>
    * <span data-ttu-id="89412-368">工作负荷所有者。</span><span class="sxs-lookup"><span data-stu-id="89412-368">Workload owners.</span></span> 
3. <span data-ttu-id="89412-369">Azure AD 全局管理员为以下人员[创建新用户帐户](/azure/active-directory/add-users-azure-active-directory)：</span><span class="sxs-lookup"><span data-stu-id="89412-369">The Azure AD global administrator [creates the new user accounts](/azure/active-directory/add-users-azure-active-directory) for:</span></span>
    * <span data-ttu-id="89412-370">与每个环境关联的每个订阅的**订阅所有者**。</span><span class="sxs-lookup"><span data-stu-id="89412-370">The person who will be the **subscription owner** for each subscription associated with each environment.</span></span> <span data-ttu-id="89412-371">请注意，仅当订阅**服务管理员**的任务不包括管理每个订阅/环境的资源访问权限时，才需要创建帐户。</span><span class="sxs-lookup"><span data-stu-id="89412-371">Note that this is necessary only if the subscription **service administrator** will not be tasked with managing resource access for each subscription/environment.</span></span>
    * <span data-ttu-id="89412-372">**网络操作用户**，以及</span><span class="sxs-lookup"><span data-stu-id="89412-372">The person who will be the **network operations user**, and</span></span>
    * <span data-ttu-id="89412-373">**工作负荷所有者**。</span><span class="sxs-lookup"><span data-stu-id="89412-373">The people who are **workload owner(s)**.</span></span>
4. <span data-ttu-id="89412-374">Azure 帐户管理员可以使用 [Azure 帐户门户](https://account.azure.com)创建以下三个订阅：</span><span class="sxs-lookup"><span data-stu-id="89412-374">The Azure account administrator creates the following three subscriptions using the [Azure account portal](https://account.azure.com):</span></span>
    * <span data-ttu-id="89412-375">**共享基础结构**环境的订阅；</span><span class="sxs-lookup"><span data-stu-id="89412-375">A subscription for the **shared infrastructure** environment,</span></span>
    * <span data-ttu-id="89412-376">**生产**环境的订阅；</span><span class="sxs-lookup"><span data-stu-id="89412-376">A subscription for the **production** environment, and</span></span> 
    * <span data-ttu-id="89412-377">**开发**环境的订阅。</span><span class="sxs-lookup"><span data-stu-id="89412-377">A subscription for the **development** environment.</span></span> 
5. <span data-ttu-id="89412-378">Azure 帐户管理员[将订阅服务所有者添加到每个订阅](/azure/billing/billing-add-change-azure-subscription-administrator#add-an-rbac-owner-admin-for-a-subscription-in-azure-portal)。</span><span class="sxs-lookup"><span data-stu-id="89412-378">The Azure account administrator [adds the subscription service owner to each subscription](/azure/billing/billing-add-change-azure-subscription-administrator#add-an-rbac-owner-admin-for-a-subscription-in-azure-portal).</span></span>
6. <span data-ttu-id="89412-379">为**工作负荷所有者**创建审批过程，以请求创建资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-379">Create an approval process for **workload owners** to request the creation of resource groups.</span></span> <span data-ttu-id="89412-380">可通过许多方式实施审批过程，例如，通过电子邮件，或者使用 [Sharepoint 工作流](https://support.office.com/article/introduction-to-sharepoint-workflow-07982276-54e8-4e17-8699-5056eff4d9e3)等过程管理工具。</span><span class="sxs-lookup"><span data-stu-id="89412-380">The approval process can be implemented in many ways, such as over email, or you can using a process management tool such as [Sharepoint workflows](https://support.office.com/article/introduction-to-sharepoint-workflow-07982276-54e8-4e17-8699-5056eff4d9e3).</span></span> <span data-ttu-id="89412-381">审批过程可以遵循以下步骤：</span><span class="sxs-lookup"><span data-stu-id="89412-381">The approval process can follow these steps:</span></span>  
    * <span data-ttu-id="89412-382">**工作负荷所有者**为**开发**环境和/或**生产**环境中的所需 Azure 资源准备物料清单，并将其提交给**订阅所有者**。</span><span class="sxs-lookup"><span data-stu-id="89412-382">The **workload owner** prepares a bill of materials for required Azure resources in either the **development** environment, **production** environment, or both, and submits it to the **subscription owner**.</span></span>
    * <span data-ttu-id="89412-383">**订阅所有者**审查物料清单并验证请求的资源，以确保请求的资源适合规划的用途 - 例如，检查请求的[虚拟机大小](/azure/virtual-machines/windows/sizes)是否正确。</span><span class="sxs-lookup"><span data-stu-id="89412-383">The **subscription owner** reviews the bill of materials and validates the requested resources to ensure that the requested resources are appropriate for their planned use - for example, checking that the requested [virtual machine sizes](/azure/virtual-machines/windows/sizes) are correct.</span></span>
    * <span data-ttu-id="89412-384">如果请求未获批准，则会通知**工作负荷所有者**。</span><span class="sxs-lookup"><span data-stu-id="89412-384">If the request is not approved, the **workload owner** is notified.</span></span> <span data-ttu-id="89412-385">如果请求获批准，**订阅所有者**将遵循组织的[命名约定](/azure/architecture/best-practices/naming-conventions)[创建请求的资源组](/azure/azure-resource-manager/resource-group-portal#manage-resource-groups)，添加具有[**参与者**角色](/azure/role-based-access-control/built-in-roles#contributor)的[**工作负荷所有者**](/azure/role-based-access-control/role-assignments-portal#add-access)，并通知**工作负荷所有者**已创建资源组。</span><span class="sxs-lookup"><span data-stu-id="89412-385">If the request is approved, the **subscription owner** [creates the requested resource group](/azure/azure-resource-manager/resource-group-portal#manage-resource-groups) following your organization's [naming conventions](/azure/architecture/best-practices/naming-conventions), [adds the **workload owner**](/azure/role-based-access-control/role-assignments-portal#add-access) with the [**contributor** role](/azure/role-based-access-control/built-in-roles#contributor) and sends notification to the **workload owner** that the resource group has been created.</span></span>
7. <span data-ttu-id="89412-386">为工作负荷所有者创建审批过程，以请求共享基础结构所有者建立虚拟网络对等连接。</span><span class="sxs-lookup"><span data-stu-id="89412-386">Create an approval process for workload owners to request a virtual network peering connection from the shared infrastructure owner.</span></span> <span data-ttu-id="89412-387">与前面的步骤一样，可以使用电子邮件或过程管理工具来实施此审批过程。</span><span class="sxs-lookup"><span data-stu-id="89412-387">As with the previous step, this approval process can be implemented using email or a process management tool.</span></span>

<span data-ttu-id="89412-388">实施调控模型后，可以部署共享基础结构服务。</span><span class="sxs-lookup"><span data-stu-id="89412-388">Now that you've implemented your governance model, you can deploy your shared infrastructure services.</span></span>

## <a name="next-steps"></a><span data-ttu-id="89412-389">后续步骤</span><span class="sxs-lookup"><span data-stu-id="89412-389">Next steps</span></span>
> [!div class="nextstepaction"]
> [<span data-ttu-id="89412-390">了解如何部署基本的基础结构</span><span class="sxs-lookup"><span data-stu-id="89412-390">Learn about deploying a basic infrastructure</span></span>](../infrastructure/basic-workload.md)

<!-- links -->
[understand-resource-access-in-azure]: /azure/role-based-access-control/rbac-and-directory-admin-roles

<!-- links -->

[rbac-built-in-owner]: /azure/role-based-access-control/built-in-roles#owner
[rbac-built-in-roles]: /azure/role-based-access-control/built-in-roles
