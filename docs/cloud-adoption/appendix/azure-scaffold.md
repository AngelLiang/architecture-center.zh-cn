---
title: 企业过渡到 Azure 的最佳做法
description: 本文介绍一个基架，企业可以使用它来确保环境的安全性与可管理性。
author: rdendtler
ms.author: rodend
ms.date: 9/22/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: enterprise-cloud-adoption
ms.openlocfilehash: 883f32b1533261977aa274f64c78762c9e7b13f3
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/23/2019
ms.locfileid: "54484408"
---
# <a name="azure-enterprise-scaffold-prescriptive-subscription-governance"></a><span data-ttu-id="adfdd-103">Azure 企业基架：出于合规目的监管订阅</span><span class="sxs-lookup"><span data-stu-id="adfdd-103">Azure enterprise scaffold: Prescriptive subscription governance</span></span>

<span data-ttu-id="adfdd-104">为了敏捷性和灵活性，企业越来越多地采用公有云。</span><span class="sxs-lookup"><span data-stu-id="adfdd-104">Enterprises are increasingly adopting the public cloud for its agility and flexibility.</span></span> <span data-ttu-id="adfdd-105">它们利用云的优势来产生营收和优化企业资源使用情况。</span><span class="sxs-lookup"><span data-stu-id="adfdd-105">They utilize the cloud's strengths to generate revenue and optimize resource usage for the business.</span></span> <span data-ttu-id="adfdd-106">Microsoft Azure 提供多种不同的服务和功能，企业可以像构建块一样将它们组合，解决广泛的工作负荷与应用程序需求。</span><span class="sxs-lookup"><span data-stu-id="adfdd-106">Microsoft Azure provides a multitude of services and capabilities that enterprises assemble like building blocks to address a wide array of workloads and applications.</span></span>

<span data-ttu-id="adfdd-107">决定使用 Microsoft Azure 只是实现云优势的第一步。</span><span class="sxs-lookup"><span data-stu-id="adfdd-107">Deciding to use Microsoft Azure is only the first step to achieving the benefit of the cloud.</span></span> <span data-ttu-id="adfdd-108">第二步是了解企业如何有效使用 Azure，并确定解决以下问题所需的基线功能：</span><span class="sxs-lookup"><span data-stu-id="adfdd-108">The second step is understanding how the enterprise can effectively use Azure and identify the baseline capabilities that need to be in place to address questions like:</span></span>

* <span data-ttu-id="adfdd-109">“我担心数据所有权；如何确保数据和系统符合法规要求？”</span><span class="sxs-lookup"><span data-stu-id="adfdd-109">"I'm concerned about data sovereignty; how can I ensure that my data and systems meet our regulatory requirements?"</span></span>
* <span data-ttu-id="adfdd-110">“怎么知道每个资源是否发挥了作用，以便可以准确地做出规划和预算？”</span><span class="sxs-lookup"><span data-stu-id="adfdd-110">"How do I know what every resource is supporting so I can account for it and bill it back accurately?"</span></span>
* <span data-ttu-id="adfdd-111">“我想确保我们在公有云中部署或执行的所有操作均将安全放在首位，应如何帮助实现这一点？”</span><span class="sxs-lookup"><span data-stu-id="adfdd-111">"I want to make sure that everything we deploy or do in the public cloud starts with the mindset of security first, how do I help facilitate that?"</span></span>

<span data-ttu-id="adfdd-112">不带任何防护措施的空白订阅，其前景是让人担忧的。</span><span class="sxs-lookup"><span data-stu-id="adfdd-112">The prospect of an empty subscription with no guard rails is daunting.</span></span> <span data-ttu-id="adfdd-113">如果不在这方面有所作为，可能会给 Azure 过渡造成阻碍。</span><span class="sxs-lookup"><span data-stu-id="adfdd-113">This blank space can hamper your move to Azure.</span></span>

<span data-ttu-id="adfdd-114">本文为技术专业人员提供一个起点，帮助他们解决监管需求，并在监管需求与敏捷性需求之间权衡利弊。</span><span class="sxs-lookup"><span data-stu-id="adfdd-114">This article provides a starting point for technical professionals to address the need for governance and balance it with the need for agility.</span></span> <span data-ttu-id="adfdd-115">其中会介绍企业基架的概念，它可以引导组织以安全的方式实施和管理 Azure 环境。</span><span class="sxs-lookup"><span data-stu-id="adfdd-115">It introduces the concept of an enterprise scaffold that guides organizations in implementing and managing their Azure environments in a secure way.</span></span> <span data-ttu-id="adfdd-116">本文为开发有效和高效的控件提供了框架。</span><span class="sxs-lookup"><span data-stu-id="adfdd-116">It provides the framework to develop effective and efficient controls.</span></span>

## <a name="need-for-governance"></a><span data-ttu-id="adfdd-117">监管需求</span><span class="sxs-lookup"><span data-stu-id="adfdd-117">Need for governance</span></span>

<span data-ttu-id="adfdd-118">在过渡到 Azure 时，必须提前解决监管方面的问题，确保成功地在企业中利用云。</span><span class="sxs-lookup"><span data-stu-id="adfdd-118">When moving to Azure, you must address the topic of governance early to ensure the successful use of the cloud within the enterprise.</span></span> <span data-ttu-id="adfdd-119">遗憾的是，建立全面监管系统所花费的时间和存在的官僚主义，意味着某些业务小组必须直接与提供商对话，而不与企业 IT 部门沟通。</span><span class="sxs-lookup"><span data-stu-id="adfdd-119">Unfortunately, the time and bureaucracy of creating a comprehensive governance system means some business groups go directly to providers without involving enterprise IT.</span></span> <span data-ttu-id="adfdd-120">如果资源未妥善管理，这种方法可能会导致企业受到损害。</span><span class="sxs-lookup"><span data-stu-id="adfdd-120">This approach can leave the enterprise open to compromise if the resources are not properly managed.</span></span> <span data-ttu-id="adfdd-121">公有云的特征 - 敏捷性、灵活性和基于消耗量的定价 - 对于需要快速满足客户（内部和外部）需求的业务小组而言非常重要。</span><span class="sxs-lookup"><span data-stu-id="adfdd-121">The characteristics of the public cloud - agility, flexibility, and consumption-based pricing - are important to business groups that need to quickly meet the demands of customers (both internal and external).</span></span> <span data-ttu-id="adfdd-122">但是，企业 IT 部门需要确保有效地保护数据和系统。</span><span class="sxs-lookup"><span data-stu-id="adfdd-122">But, enterprise IT needs to ensure that data and systems are effectively protected.</span></span>

<span data-ttu-id="adfdd-123">建造建筑物时，我们可以使用基架来打好建筑物的基础。</span><span class="sxs-lookup"><span data-stu-id="adfdd-123">When creating a building, scaffolding is used to create the basis of a structure.</span></span> <span data-ttu-id="adfdd-124">基架主导总体轮廓，为需要装载的更长久系统提供定位点。</span><span class="sxs-lookup"><span data-stu-id="adfdd-124">The scaffold guides the general outline and provides anchor points for more permanent systems to be mounted.</span></span> <span data-ttu-id="adfdd-125">企业基架也是如此：一套灵活的控制机制和 Azure 功能为环境提供结构，为公有云上生成的服务提供定位点。</span><span class="sxs-lookup"><span data-stu-id="adfdd-125">An enterprise scaffold is the same: a set of flexible controls and Azure capabilities that provide structure to the environment, and anchors for services built on the public cloud.</span></span> <span data-ttu-id="adfdd-126">它为构建者（IT 人员和业务小组）提供创建和附加新服务的基础，同时保持了交付速度。</span><span class="sxs-lookup"><span data-stu-id="adfdd-126">It provides the builders (IT and business groups) a foundation to create and attach new services keeping speed of delivery in mind.</span></span>

<span data-ttu-id="adfdd-127">该基架建立在我们与各种规模的客户交往时收获的实践经验基础之上。</span><span class="sxs-lookup"><span data-stu-id="adfdd-127">The scaffold is based on practices we have gathered from many engagements with clients of various sizes.</span></span> <span data-ttu-id="adfdd-128">这些客户既包括在云中开发解决方案的小型组织，也包括迁移工作负载和开发云本机解决方案的大型跨国企业和独立软件供应商。</span><span class="sxs-lookup"><span data-stu-id="adfdd-128">Those clients range from small organizations developing solutions in the cloud to large multi-national enterprises and independent software vendors who are migrating workloads and developing cloud-native solutions.</span></span> <span data-ttu-id="adfdd-129">企业基架采用灵活设计，为传统的 IT 工作负载和敏捷工作负载提供有针对性的支持；例如，开发人员可以基于 Azure 平台功能创建软件即服务 (SaaS) 应用程序。</span><span class="sxs-lookup"><span data-stu-id="adfdd-129">The enterprise scaffold is "purpose-built" to be flexible to support both traditional IT workloads and agile workloads; such as, developers creating software-as-a-service (SaaS) applications based on Azure platform capabilities.</span></span>

<span data-ttu-id="adfdd-130">企业基架旨在用作 Azure 中每个新订阅的基础。</span><span class="sxs-lookup"><span data-stu-id="adfdd-130">The enterprise scaffold is intended to be the foundation of each new subscription within Azure.</span></span> <span data-ttu-id="adfdd-131">它能使管理员确保工作负荷满足组织的最低监管要求，同时又不妨碍业务小组和开发人员尽快实现自身的目标。</span><span class="sxs-lookup"><span data-stu-id="adfdd-131">It enables administrators to ensure workloads meet the minimum governance requirements of an organization without preventing business groups and developers from quickly meeting their own goals.</span></span> <span data-ttu-id="adfdd-132">我们的经验表明，这极大地加速（而非阻碍）了公有云的增长。</span><span class="sxs-lookup"><span data-stu-id="adfdd-132">Our experience shows that this greatly speeds, rather than impedes, public cloud growth.</span></span>

> [!NOTE]
> <span data-ttu-id="adfdd-133">Microsoft 在预览版中发布了名为 [Azure 蓝图](/azure/governance/blueprints/overview)的新功能，借助此功能便可跨订阅和管理组打包、管理和部署通用映像、模板、策略和脚本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-133">Microsoft has released into preview a new capability called [Azure Blueprints](/azure/governance/blueprints/overview) that will enable you to package, manage, and deploy common images, templates, policies, and scripts across subscriptions and management groups.</span></span> <span data-ttu-id="adfdd-134">此功能是基架作为参考模型的用途和将该模型部署到组织之间的桥梁。</span><span class="sxs-lookup"><span data-stu-id="adfdd-134">This capability is the bridge between the scaffold's purpose as reference model and deploying that model to your organization.</span></span>
>
<span data-ttu-id="adfdd-135">下图显示了基架的组件。</span><span class="sxs-lookup"><span data-stu-id="adfdd-135">The following image shows the components of the scaffold.</span></span> <span data-ttu-id="adfdd-136">基础依赖于管理层次结构和订阅的可靠计划。</span><span class="sxs-lookup"><span data-stu-id="adfdd-136">The foundation relies on a solid plan for the management hierarchy and subscriptions.</span></span> <span data-ttu-id="adfdd-137">支柱包括 Resource Manager 策略和强有力的命名标准。</span><span class="sxs-lookup"><span data-stu-id="adfdd-137">The pillars consist of Resource Manager policies and strong naming standards.</span></span> <span data-ttu-id="adfdd-138">基架的剩余部分是 Azure 核心功能和特性，它们可实现和连接安全且可管理的环境。</span><span class="sxs-lookup"><span data-stu-id="adfdd-138">The rest of the scaffold are core Azure capabilities and features that enable and connect a secure and manageable environment.</span></span>

![企业基架](./_images/scaffoldv2.png)

## <a name="define-your-hierarchy"></a><span data-ttu-id="adfdd-140">定义层次结构</span><span class="sxs-lookup"><span data-stu-id="adfdd-140">Define your hierarchy</span></span>

<span data-ttu-id="adfdd-141">基架的基础是从 Azure 企业许可登记表一直到订阅和资源组的层次结构和关系。</span><span class="sxs-lookup"><span data-stu-id="adfdd-141">The foundation of the scaffold is the hierarchy and relationship of the Azure Enterprise Enrollment through to subscriptions and resource groups.</span></span> <span data-ttu-id="adfdd-142">企业许可登记表从合同的角度定义了 Azure 服务在贵公司内的形式和用途。</span><span class="sxs-lookup"><span data-stu-id="adfdd-142">The enterprise enrollment defines the shape and use of Azure services within your company from a contractual point of view.</span></span> <span data-ttu-id="adfdd-143">在企业协议中，可将环境进一步细分为部门、帐户，最终细分为订阅和资源组，以与组织的结构相匹配。</span><span class="sxs-lookup"><span data-stu-id="adfdd-143">Within the enterprise agreement, you can further subdivide the environment into departments, accounts, and finally, subscriptions and resource groups to match your organization's structure.</span></span>

![层次结构](./_images/agreement.png)

<span data-ttu-id="adfdd-145">Azure 订阅是包含所有资源的基本单位。</span><span class="sxs-lookup"><span data-stu-id="adfdd-145">An Azure subscription is the basic unit where all resources are contained.</span></span> <span data-ttu-id="adfdd-146">它还定义 Azure 中的多种限制，例如核心数、虚拟网络数和其他资源数。</span><span class="sxs-lookup"><span data-stu-id="adfdd-146">It also defines several limits within Azure, such as number of cores, virtual networks and other resources.</span></span> <span data-ttu-id="adfdd-147">Azure 资源组用于进一步优化订阅模型，并实现更自然的资源分组。</span><span class="sxs-lookup"><span data-stu-id="adfdd-147">Azure Resource Groups are used to further refine the subscription model and enable a more natural grouping of resources.</span></span>

<span data-ttu-id="adfdd-148">每家企业都是独特的，使用上图中的层次结构可以在公司内部十分灵活地对 Azure 进行组织。</span><span class="sxs-lookup"><span data-stu-id="adfdd-148">Every enterprise is different and the hierarchy in the above image allows for significant flexibility in how Azure is organized within your company.</span></span> <span data-ttu-id="adfdd-149">开始使用公有云时，对层次结构建模以反映公司对计费、资源管理和资源访问的需求，是首先要做出的 &mdash; 也是最重要的 &mdash; 决策。</span><span class="sxs-lookup"><span data-stu-id="adfdd-149">Modeling your hierarchy to reflect the needs of your company for billing, resource management, and resource access is the first &mdash; and most important &mdash; decision you make when starting in the public cloud.</span></span>

### <a name="departments-and-accounts"></a><span data-ttu-id="adfdd-150">部门和帐户</span><span class="sxs-lookup"><span data-stu-id="adfdd-150">Departments and Accounts</span></span>

<span data-ttu-id="adfdd-151">Azure 注册的三种常见模式为：</span><span class="sxs-lookup"><span data-stu-id="adfdd-151">The three common patterns for Azure Enrollments are:</span></span>

* <span data-ttu-id="adfdd-152">**功能**模式</span><span class="sxs-lookup"><span data-stu-id="adfdd-152">The **functional** pattern</span></span>

    ![功能](./_images/functional.png)
* <span data-ttu-id="adfdd-154">**业务单位**模式</span><span class="sxs-lookup"><span data-stu-id="adfdd-154">The **business unit** pattern</span></span>

    ![业务](./_images/business.png)
* <span data-ttu-id="adfdd-156">**地理**模式</span><span class="sxs-lookup"><span data-stu-id="adfdd-156">The **geographic** pattern</span></span>

    ![地理](./_images/geographic.png)

<span data-ttu-id="adfdd-158">虽然这些模式各占一席之地，但“业务单位”模式逐渐得到广泛采用，因为该模式可灵活建造组织的成本模型以及反映控制范围。</span><span class="sxs-lookup"><span data-stu-id="adfdd-158">Though each of these patterns has its place, the **business unit** pattern is increasingly being adopted for its flexibility in modeling an organization's cost model as well as reflecting span of control.</span></span> <span data-ttu-id="adfdd-159">Microsoft 核心工程技术和操作组创建了一个非常有效的“业务单位”模式子集，该子集以“联邦”、“州”和“本地”为模型。</span><span class="sxs-lookup"><span data-stu-id="adfdd-159">Microsoft Core Engineering and Operations group has created a sub-set of the **business unit** pattern that is very effective, modeled on **Federal**, **State**, and **Local**.</span></span> <span data-ttu-id="adfdd-160">（有关详细信息，请参阅[在 Enterprise 中组织订阅和资源组](https://azure.microsoft.com/blog/organizing-subscriptions-and-resource-groups-within-the-enterprise/)。）</span><span class="sxs-lookup"><span data-stu-id="adfdd-160">(For more information, see [Organizing subscriptions and resource groups within the Enterprise](https://azure.microsoft.com/blog/organizing-subscriptions-and-resource-groups-within-the-enterprise/).)</span></span>

### <a name="management-groups"></a><span data-ttu-id="adfdd-161">管理组</span><span class="sxs-lookup"><span data-stu-id="adfdd-161">Management Groups</span></span>

<span data-ttu-id="adfdd-162">Microsoft 最近发布了一种新的层次结构建模方法：[Azure 管理组](/azure/azure-resource-manager/management-groups-overview)。</span><span class="sxs-lookup"><span data-stu-id="adfdd-162">Microsoft has recently released a new way of modeling your hierarchy: [Azure management groups](/azure/azure-resource-manager/management-groups-overview).</span></span> <span data-ttu-id="adfdd-163">管理组比部门和帐户更灵活，可嵌套多达六个级别。</span><span class="sxs-lookup"><span data-stu-id="adfdd-163">Management groups are much more flexible than departments and accounts and can be nested up to six levels.</span></span> <span data-ttu-id="adfdd-164">借助管理组，可创建与账单层次结构分离的层次结构，专门用于有效管理资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-164">Management groups allow you to create a hierarchy that is separate from your billing hierarchy, solely for efficient management of resources.</span></span> <span data-ttu-id="adfdd-165">管理组可反映出账单层次结构，企业通常以这种方式开始。</span><span class="sxs-lookup"><span data-stu-id="adfdd-165">Management groups can mirror your billing hierarchy and often enterprises start that way.</span></span> <span data-ttu-id="adfdd-166">但是，管理组的强大功能在于使用它们为组织建模，而组织中相关订阅 &mdash; 无论其位于账单层次结构中的何处 &mdash; 都组合在一起，且需要分配共同角色以及策略和计划。</span><span class="sxs-lookup"><span data-stu-id="adfdd-166">However, the power of management groups is when you use them to model your organization where related subscriptions &mdash; regardless where they are in the billing hierarchy &mdash; are grouped together and need common roles assigned as well as policies and initiatives.</span></span> <span data-ttu-id="adfdd-167">一些示例：</span><span class="sxs-lookup"><span data-stu-id="adfdd-167">A few examples:</span></span>

* <span data-ttu-id="adfdd-168">**生产/非生产**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-168">**Production/Non-Production**.</span></span> <span data-ttu-id="adfdd-169">某些企业创建管理组来识别其生产和非生产订阅。</span><span class="sxs-lookup"><span data-stu-id="adfdd-169">Some enterprises create management groups to identify their production and non-production subscriptions.</span></span> <span data-ttu-id="adfdd-170">借助管理组，这些客户可以更轻松地管理角色和策略，例如：非生产订阅可能允许开发人员“参与者”访问权限，但在生产中，开发人员仅具有“读者”访问权限。</span><span class="sxs-lookup"><span data-stu-id="adfdd-170">Management groups allow these customers to more easily manage roles and policies, for example: non-production subscription may allow developers "contributor" access, but in production, they have only "reader" access.</span></span>
* <span data-ttu-id="adfdd-171">**内部服务/外部服务**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-171">**Internal Services/External Services**.</span></span> <span data-ttu-id="adfdd-172">如生产/非生产一样，企业通常对内部服务和外部（面向客户）服务有不同的要求、策略和角色。</span><span class="sxs-lookup"><span data-stu-id="adfdd-172">Much like Production/Non-Production, enterprises often have different requirements, policies and roles for internal services vs external (customer facing) services.</span></span>

<span data-ttu-id="adfdd-173">周密的管理组以及 Azure Policy 和计划是 Azure 有效管理的支柱。</span><span class="sxs-lookup"><span data-stu-id="adfdd-173">Well thought out management groups are, along with Azure Policy and Initiatives the backbone of efficient governance of Azure.</span></span>

### <a name="subscriptions"></a><span data-ttu-id="adfdd-174">订阅</span><span class="sxs-lookup"><span data-stu-id="adfdd-174">Subscriptions</span></span>

<span data-ttu-id="adfdd-175">决定部门和帐户（或管理组）时，你主要关注的是如何划分 Azure 环境，以便与组织匹配。</span><span class="sxs-lookup"><span data-stu-id="adfdd-175">When deciding on your Departments and Accounts (or management groups), you are primarily looking at how you're dividing up your Azure environment to match your organization.</span></span> <span data-ttu-id="adfdd-176">然而，订阅才是真正的工作所在，此时的决策会影响安全性、可伸缩性和计费。</span><span class="sxs-lookup"><span data-stu-id="adfdd-176">Subscriptions, however, are where the real work happens and your decisions here impact security, scalability and billing.</span></span>  <span data-ttu-id="adfdd-177">许多组织将以下模式视为指南：</span><span class="sxs-lookup"><span data-stu-id="adfdd-177">Many organizations look at the following patterns as their guides:</span></span>

* <span data-ttu-id="adfdd-178">**应用程序/服务**：订阅代表应用程序或服务（应用程序组合）</span><span class="sxs-lookup"><span data-stu-id="adfdd-178">**Application/Service**: Subscriptions represent an application or a service (portfolio of applications)</span></span>
* <span data-ttu-id="adfdd-179">**生命周期**：订阅代表服务的生命周期，例如生产或开发。</span><span class="sxs-lookup"><span data-stu-id="adfdd-179">**Lifecycle**: Subscriptions represent a lifecycle of a service, such as Production or Development.</span></span>
* <span data-ttu-id="adfdd-180">**部门**：订阅代表组织中的部门。</span><span class="sxs-lookup"><span data-stu-id="adfdd-180">**Department**: Subscriptions represent departments in the organization.</span></span>

<span data-ttu-id="adfdd-181">前两种模式是最常用的模式，强烈建议使用这两种模式。</span><span class="sxs-lookup"><span data-stu-id="adfdd-181">The first two patterns are the most commonly used, and both are highly recommended.</span></span> <span data-ttu-id="adfdd-182">生命周期方法适用于大多数组织。</span><span class="sxs-lookup"><span data-stu-id="adfdd-182">The Lifecycle approach is appropriate for most organizations.</span></span> <span data-ttu-id="adfdd-183">在这种情况下，一般建议使用两个基本订阅。</span><span class="sxs-lookup"><span data-stu-id="adfdd-183">In this case, the general recommendation is to use two base subscriptions.</span></span> <span data-ttu-id="adfdd-184">“生产”和“非生产”，然后使用资源组进一步细分环境。</span><span class="sxs-lookup"><span data-stu-id="adfdd-184">"Production" and "Non-Production," and then use resource groups to break out the environments further.</span></span>

### <a name="resource-groups"></a><span data-ttu-id="adfdd-185">资源组</span><span class="sxs-lookup"><span data-stu-id="adfdd-185">Resource groups</span></span>

<span data-ttu-id="adfdd-186">使用 Azure 资源管理器可将资源放入有意义的组中，便于管理、记帐或自然关联。</span><span class="sxs-lookup"><span data-stu-id="adfdd-186">Azure Resource Manager enables you to put resources into meaningful groups for management, billing, or natural affinity.</span></span> <span data-ttu-id="adfdd-187">资源组是具有相同生命周期的或共享某个属性（例如“所有 SQL 服务器”或“应用程序 A”）的资源的容器。</span><span class="sxs-lookup"><span data-stu-id="adfdd-187">Resource groups are containers of resources that have a common life cycle or share an attribute such as "all SQL servers" or "Application A".</span></span>

<span data-ttu-id="adfdd-188">资源组无法进行嵌套，资源只能属于一个资源组。</span><span class="sxs-lookup"><span data-stu-id="adfdd-188">Resource groups can't be nested, and resources can only belong to one resource group.</span></span> <span data-ttu-id="adfdd-189">某些操作可对资源组中的所有资源执行操作。</span><span class="sxs-lookup"><span data-stu-id="adfdd-189">Some actions can act on all resources in a resource group.</span></span> <span data-ttu-id="adfdd-190">例如，删除某个资源组会删除该资源组中的所有资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-190">For example, deleting a resource group removes all resources within the resource group.</span></span> <span data-ttu-id="adfdd-191">类似于订阅，创建资源组时也存在常见模式，从“传统 IT”工作负载到“敏捷 IT”工作负载会有所不同：</span><span class="sxs-lookup"><span data-stu-id="adfdd-191">Like subscriptions, there are common patterns when creating resource groups and will vary from "Traditional IT" workloads to "Agile IT" workloads:</span></span>

* <span data-ttu-id="adfdd-192">“传统 IT”工作负载通常按同一生命周期中的项（例如某个应用程序）分组。</span><span class="sxs-lookup"><span data-stu-id="adfdd-192">"Traditional IT" workloads are most commonly grouped by items within the same life cycle, such as an application.</span></span> <span data-ttu-id="adfdd-193">由于可按应用程序分组，因此可以管理每个应用程序。</span><span class="sxs-lookup"><span data-stu-id="adfdd-193">Grouping by application allows for individual application management.</span></span>
* <span data-ttu-id="adfdd-194">“敏捷 IT”工作负荷往往侧重面向外部客户的云应用程序。</span><span class="sxs-lookup"><span data-stu-id="adfdd-194">"Agile IT" workloads tend to focus on external customer-facing cloud applications.</span></span> <span data-ttu-id="adfdd-195">资源组通常反映部署层（如 Web 层、应用层）和管理层。</span><span class="sxs-lookup"><span data-stu-id="adfdd-195">The resource groups often reflect the layers of deployment (such as Web Tier, App Tier) and management.</span></span>

> [!NOTE]
> <span data-ttu-id="adfdd-196">了解工作负荷可帮助制定资源组策略。</span><span class="sxs-lookup"><span data-stu-id="adfdd-196">Understanding your workload helps you develop a resource group strategy.</span></span> <span data-ttu-id="adfdd-197">这些模式可以混合搭配。</span><span class="sxs-lookup"><span data-stu-id="adfdd-197">These patterns can be mixed and matched.</span></span> <span data-ttu-id="adfdd-198">例如，与“敏捷”资源组位于同一订阅中的共享服务资源组。</span><span class="sxs-lookup"><span data-stu-id="adfdd-198">For example, a shared services resource group in the same subscription as "Agile" resource groups.</span></span>

## <a name="naming-standards"></a><span data-ttu-id="adfdd-199">命名标准</span><span class="sxs-lookup"><span data-stu-id="adfdd-199">Naming standards</span></span>

<span data-ttu-id="adfdd-200">基架的第一个支柱是一致的命名标准。</span><span class="sxs-lookup"><span data-stu-id="adfdd-200">The first pillar of the scaffold is a consistent naming standard.</span></span> <span data-ttu-id="adfdd-201">使用妥善设计的命名标准，可以在门户、帐单和脚本中识别资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-201">Well-designed naming standards enable you to identify resources in the portal, on a bill, and within scripts.</span></span> <span data-ttu-id="adfdd-202">你很可能已针对本地基础结构制定了现有命名标准。</span><span class="sxs-lookup"><span data-stu-id="adfdd-202">You likely already have existing naming standards for on-premises infrastructure.</span></span> <span data-ttu-id="adfdd-203">将 Azure 添加到环境时，应该将这些命名标准扩展到 Azure 资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-203">When adding Azure to your environment, you should extend those naming standards to your Azure resources.</span></span>

> [!TIP]
> <span data-ttu-id="adfdd-204">关于命名约定：</span><span class="sxs-lookup"><span data-stu-id="adfdd-204">For naming conventions:</span></span>
> * <span data-ttu-id="adfdd-205">如果可能，请审阅并采纳[模式与实践指南](https://docs.microsoft.com/en-us/azure/architecture/best-practices/naming-conventions)。</span><span class="sxs-lookup"><span data-stu-id="adfdd-205">Review and adopt where possible the [Patterns and Practices guidance](https://docs.microsoft.com/en-us/azure/architecture/best-practices/naming-conventions).</span></span> <span data-ttu-id="adfdd-206">本指南可帮助确定一套有意义的命名标准并提供了大量示例。</span><span class="sxs-lookup"><span data-stu-id="adfdd-206">This guidance helps you decide on a meaningful naming standard and provides extensive examples.</span></span>
> * <span data-ttu-id="adfdd-207">使用资源管理器策略来帮助实施命名标准</span><span class="sxs-lookup"><span data-stu-id="adfdd-207">Using Resource Manager Policies to help enforce naming standards</span></span>
>
><span data-ttu-id="adfdd-208">记住，以后更改名称比较难，因此现在花费几分钟即可省去以后的麻烦。</span><span class="sxs-lookup"><span data-stu-id="adfdd-208">Remember that it's difficult to change names later, so a few minutes now will save you trouble later.</span></span>

<span data-ttu-id="adfdd-209">请将命名标准集中在那些更常用和更常搜索的资源上。</span><span class="sxs-lookup"><span data-stu-id="adfdd-209">Concentrate your naming standards on those resources that are more commonly used and searched for.</span></span>  <span data-ttu-id="adfdd-210">例如，为清晰起见，所有资源组都应严格遵循标准。</span><span class="sxs-lookup"><span data-stu-id="adfdd-210">For example, all resource groups should follow a strong standard for clarity.</span></span>

### <a name="resource-tags"></a><span data-ttu-id="adfdd-211">资源标记</span><span class="sxs-lookup"><span data-stu-id="adfdd-211">Resource Tags</span></span>

<span data-ttu-id="adfdd-212">资源标记与命名标准紧密一致。</span><span class="sxs-lookup"><span data-stu-id="adfdd-212">Resource tags are tightly aligned with naming standards.</span></span> <span data-ttu-id="adfdd-213">随着资源添加到订阅中，出于计费、管理和操作目的，对其进行逻辑分类变得日益重要。</span><span class="sxs-lookup"><span data-stu-id="adfdd-213">As resources are added to subscriptions, it becomes increasingly important to logically categorize them for billing, management, and operational purposes.</span></span> <span data-ttu-id="adfdd-214">有关详细信息，请参阅[使用标记整理 Azure 资源](https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-using-tags)。</span><span class="sxs-lookup"><span data-stu-id="adfdd-214">For more information, see [Use tags to organize your Azure Resource](https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-using-tags).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="adfdd-215">标记可包含个人信息，并且可能属于 GDPR 法规的范围。</span><span class="sxs-lookup"><span data-stu-id="adfdd-215">Tags can contain personal information and may fall under the regulations of GDPR.</span></span> <span data-ttu-id="adfdd-216">请仔细规划管理标记。</span><span class="sxs-lookup"><span data-stu-id="adfdd-216">Plan for management of your tags carefully.</span></span> <span data-ttu-id="adfdd-217">如需关于 GDPR 的常规信息，请参阅[服务信任门户](https://servicetrust.microsoft.com/ViewPage/GDPRGetStarted)的 GDPR 部分。</span><span class="sxs-lookup"><span data-stu-id="adfdd-217">If you're looking for general info about GDPR, see the GDPR section of the [Service Trust Portal](https://servicetrust.microsoft.com/ViewPage/GDPRGetStarted).</span></span>

<span data-ttu-id="adfdd-218">除了计费和管理外，还可通过多种方式使用标记。</span><span class="sxs-lookup"><span data-stu-id="adfdd-218">Tags are used in many ways beyond billing and management.</span></span> <span data-ttu-id="adfdd-219">标记通常用作自动化的一部分（请参阅后面的部分）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-219">They are often used as part of automation (see later section).</span></span> <span data-ttu-id="adfdd-220">如果不事先考虑，这可能会导致冲突。</span><span class="sxs-lookup"><span data-stu-id="adfdd-220">This can cause conflicts if not considered up front.</span></span> <span data-ttu-id="adfdd-221">建议的做法是标识企业级别的所有常用标记（例如 ApplicationOwner、CostCenter），并在使用自动化部署资源时以一致的方式应用这些标记。</span><span class="sxs-lookup"><span data-stu-id="adfdd-221">The recommended practice is to identify all the common tags at the enterprise level (such as ApplicationOwner, CostCenter) and apply them consistently when deploying resources using automation.</span></span>

## <a name="azure-policy-and-initiatives"></a><span data-ttu-id="adfdd-222">Azure Policy 和计划</span><span class="sxs-lookup"><span data-stu-id="adfdd-222">Azure Policy and Initiatives</span></span>

<span data-ttu-id="adfdd-223">基架的第二个支柱涉及使用 [Azure Policy 和计划](/azure/azure-policy/azure-policy-introduction)来管理风险，具体方法是对订阅中的资源和服务强制实施规则（具有效果）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-223">The second pillar of the scaffold involves using [Azure Policy and Initiatives](/azure/azure-policy/azure-policy-introduction) to manage risk by enforcing rules (with effects) over the resources and services in your subscriptions.</span></span> <span data-ttu-id="adfdd-224">Azure 计划是策略的集合，旨在实现一个目标。</span><span class="sxs-lookup"><span data-stu-id="adfdd-224">Azure Initiatives are collections of policies that are designed to achieve a single goal.</span></span> <span data-ttu-id="adfdd-225">然后，会将 Azure Policy 和计划分配到资源作用域，从而开始特定策略的强制实施。</span><span class="sxs-lookup"><span data-stu-id="adfdd-225">Azure policy and initiatives are then assigned to a resource scope to begin enforcement of the particular policies.</span></span>

<span data-ttu-id="adfdd-226">与上文所述的管理组结合使用时，Azure Policy 和计划的功能更强大。</span><span class="sxs-lookup"><span data-stu-id="adfdd-226">Azure Policy and Initiatives are even more powerful when used with the management groups mentioned earlier.</span></span> <span data-ttu-id="adfdd-227">管理组可将计划或策略分配给整个订阅集。</span><span class="sxs-lookup"><span data-stu-id="adfdd-227">Management groups enable the assignment of an initiative or policy to an entire set of subscriptions.</span></span>

### <a name="common-uses-of-resource-manager-policies"></a><span data-ttu-id="adfdd-228">Resource Manager 策略的常见用途</span><span class="sxs-lookup"><span data-stu-id="adfdd-228">Common uses of Resource Manager policies</span></span>

<span data-ttu-id="adfdd-229">Azure Policy 和计划是 Azure 工具包中的一个强大工具。</span><span class="sxs-lookup"><span data-stu-id="adfdd-229">Azure policies and initiatives are a powerful tool in the Azure toolkit.</span></span> <span data-ttu-id="adfdd-230">策略允许公司为“传统 IT”工作负载提供控制，从而实现 LOB 应用程序所需的稳定性，同时也允许“敏捷”工作负载；例如，开发客户应用程序而不会使企业面临其他风险。</span><span class="sxs-lookup"><span data-stu-id="adfdd-230">Policies allow companies to provide controls for "Traditional IT" workloads that enable the stability that is needed for LOB applications while also allowing "Agile" workloads; such as, developing customer applications without opening up the enterprise to additional risk.</span></span> <span data-ttu-id="adfdd-231">策略的最常见模式包括：</span><span class="sxs-lookup"><span data-stu-id="adfdd-231">The most common patterns we see for policies are:</span></span>

* <span data-ttu-id="adfdd-232">**地域法规遵从/数据所有权**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-232">**Geo-compliance/data sovereignty**.</span></span> <span data-ttu-id="adfdd-233">Azure 在世界各地拥有越来越多的区域。</span><span class="sxs-lookup"><span data-stu-id="adfdd-233">Azure has an ever-growing list of regions across the world.</span></span> <span data-ttu-id="adfdd-234">Enterprise 通常需要确保特定作用域内的资源保留在某一地理区域内，以满足法规要求。</span><span class="sxs-lookup"><span data-stu-id="adfdd-234">Enterprises often need to ensure that resources in a particular scope remain in a geographic region to address regulatory requirements.</span></span>
* <span data-ttu-id="adfdd-235">**避免公开服务器**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-235">**Avoid exposing servers publicly**.</span></span> <span data-ttu-id="adfdd-236">Azure Policy 可禁止部署某些资源类型。</span><span class="sxs-lookup"><span data-stu-id="adfdd-236">Azure policy can prohibit the deployment of certain resources types.</span></span> <span data-ttu-id="adfdd-237">常见的用途是创建策略来拒绝在特定作用域内创建公共 IP，从而避免无意中向 Internet 公开服务器。</span><span class="sxs-lookup"><span data-stu-id="adfdd-237">A common use is to create a policy to deny the creation of a public IP within a particular scope, avoiding un-intended exposure of a server to the internet.</span></span>
* <span data-ttu-id="adfdd-238">**成本管理和元数据**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-238">**Cost Management and Metadata**.</span></span> <span data-ttu-id="adfdd-239">资源标记通常用于将重要的账单数据添加到资源和资源组，例如 CostCenter、所有者等。</span><span class="sxs-lookup"><span data-stu-id="adfdd-239">Resource tags are often used to add important billing data to resources and resource groups such as CostCenter, Owner and more.</span></span> <span data-ttu-id="adfdd-240">这些标记对于准确计费和管理资源非常有用。</span><span class="sxs-lookup"><span data-stu-id="adfdd-240">These tags are invaluable for accurate billing and management of resources.</span></span> <span data-ttu-id="adfdd-241">策略可强制将资源标记应用于所有已部署资源，使其更易于管理。</span><span class="sxs-lookup"><span data-stu-id="adfdd-241">Policies can enforce the application of resources tags to all deployed resource, making it easier to manage.</span></span>

### <a name="common-uses-of-initiatives"></a><span data-ttu-id="adfdd-242">计划的常见用途</span><span class="sxs-lookup"><span data-stu-id="adfdd-242">Common uses of initiatives</span></span>

<span data-ttu-id="adfdd-243">计划的引入为企业提供了一种将逻辑策略组合在一起并作为整体进行跟踪的方法。</span><span class="sxs-lookup"><span data-stu-id="adfdd-243">The introduction of initiatives provided enterprises a way to group logical policies together and track as a whole.</span></span> <span data-ttu-id="adfdd-244">计划进一步支持企业解决“敏捷”和“传统”工作负载的需求。</span><span class="sxs-lookup"><span data-stu-id="adfdd-244">Initiatives further support the enterprise to address the needs of both "agile" and "traditional" workloads.</span></span> <span data-ttu-id="adfdd-245">我们已见过极富创意使用计划的方法，但我们通常见到以下用法：</span><span class="sxs-lookup"><span data-stu-id="adfdd-245">We have seen very creative uses of initiatives, but commonly we see:</span></span>

* <span data-ttu-id="adfdd-246">**在 Azure 安全中心启用监视**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-246">**Enable monitoring in Azure Security Center**.</span></span> <span data-ttu-id="adfdd-247">这是 Azure Policy 中的默认计划，也是计划的一个绝佳示例。</span><span class="sxs-lookup"><span data-stu-id="adfdd-247">This is a default initiative in the Azure Policy and an excellent example of what initiative are.</span></span> <span data-ttu-id="adfdd-248">它可启用识别未加密的 SQL 数据库、VM 漏洞和更常见的安全相关需求的策略。</span><span class="sxs-lookup"><span data-stu-id="adfdd-248">It enables policies that identify un-encrypted SQL databases, VM vulnerabilities and more common security related needs.</span></span>
* <span data-ttu-id="adfdd-249">**特定于法规的计划**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-249">**Regulatory specific initiative**.</span></span> <span data-ttu-id="adfdd-250">企业通常对法规要求（如 HIPAA）通用的策略进行分组，以便有效跟踪这些控件的控制和符合性。</span><span class="sxs-lookup"><span data-stu-id="adfdd-250">Enterprises often group policies common to a regulatory requirement (such as HIPAA) so that controls and compliancy to those controls are tracked efficiently.</span></span>
* <span data-ttu-id="adfdd-251">**资源类型和 SKU**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-251">**Resource Types & SKUs**.</span></span> <span data-ttu-id="adfdd-252">创建限制可部署资源类型以及可部署 SKU 的计划有助于控制成本，并可确保组织仅部署团队具有技能集和程序来支持的资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-252">Creating an initiative that restricts the types of resources that can be deployed as well as the SKUs that can be deployed can help to control costs and ensure your organization is only deploying resources that your team have the skillset and procedures to support.</span></span>

> [!TIP]
> <span data-ttu-id="adfdd-253">我们建议始终使用计划定义，而不是策略定义。</span><span class="sxs-lookup"><span data-stu-id="adfdd-253">We recommend you always use initiative definitions instead of policy definitions.</span></span> <span data-ttu-id="adfdd-254">将计划分配给作用域（如订阅或管理组）后，便可轻松将另一个策略添加到计划中，且无需更改任何分配。</span><span class="sxs-lookup"><span data-stu-id="adfdd-254">After assigning an initiative to a scope, such as subscription or management group, you can easily add another policy to the initiative without having to change any assignments.</span></span> <span data-ttu-id="adfdd-255">这使了解所应用内容和跟踪符合性变得更加轻松。</span><span class="sxs-lookup"><span data-stu-id="adfdd-255">This makes understanding what is applied and tracking compliance far easier.</span></span>

### <a name="policy-and-initiative-assignments"></a><span data-ttu-id="adfdd-256">策略和计划分配</span><span class="sxs-lookup"><span data-stu-id="adfdd-256">Policy and Initiative assignments</span></span>

<span data-ttu-id="adfdd-257">创建策略并将其分组到逻辑计划后，必须将策略分配给作用域，无论是管理组、订阅组还是资源组。</span><span class="sxs-lookup"><span data-stu-id="adfdd-257">After the creation of policies and grouping them into logical initiatives you must assign the policy to a scope, whether it is a management group, a subscription or even a resource group.</span></span> <span data-ttu-id="adfdd-258">通过分配，还可从策略分配中排除子作用域。</span><span class="sxs-lookup"><span data-stu-id="adfdd-258">Assignments allow you to also exclude a sub-scope from the assignment of a policy.</span></span> <span data-ttu-id="adfdd-259">例如，如果拒绝在订阅中创建公共 IP，则可为连接到受保护外围网络的资源组创建具有排除项的分配。</span><span class="sxs-lookup"><span data-stu-id="adfdd-259">For example, if you deny the creation of public IPs within a subscription, you could create an assignment with an exclusion for a resource group connected to your protected DMZ.</span></span>

<span data-ttu-id="adfdd-260">在此 [GitHub](https://github.com/Azure/azure-policy) 存储库中，可查找多个 Policy 示例，这些示例展示了如何将 Policy 和计划应用于 Azure 中的各种资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-260">You will find several Policy examples that show how Policy and Initiatives can be applied to various resources within Azure on this [GitHub](https://github.com/Azure/azure-policy) repository.</span></span>

## <a name="identity-and-access-management"></a><span data-ttu-id="adfdd-261">标识和访问管理</span><span class="sxs-lookup"><span data-stu-id="adfdd-261">Identity and access management</span></span>

<span data-ttu-id="adfdd-262">开始使用公有云时，首先也是最关键的问题是“谁应有权访问资源？”</span><span class="sxs-lookup"><span data-stu-id="adfdd-262">One of the first, and most crucial, questions you ask yourself when starting with the public cloud is "who should have access to resources?"</span></span> <span data-ttu-id="adfdd-263">或者“如何控制这种访问权限？”</span><span class="sxs-lookup"><span data-stu-id="adfdd-263">and "how do I control this access?"</span></span> <span data-ttu-id="adfdd-264">允许或禁止访问 Azure 门户，以及控制门户中资源的访问权限对于资产在云中的长期成功和安全至关重要。</span><span class="sxs-lookup"><span data-stu-id="adfdd-264">Allowing or disallowing access to the Azure portal, and controlling access to resources in the portal is critical to the long term success and safety of your assets in the cloud.</span></span>

<span data-ttu-id="adfdd-265">若要完成保护资源访问安全的任务，首先要配置标识提供者，然后配置角色和访问权限。</span><span class="sxs-lookup"><span data-stu-id="adfdd-265">To accomplish the task of securing access to your resources you will first configure your identity provider and then configure Roles and access.</span></span> <span data-ttu-id="adfdd-266">连接到本地 Azure Active 的 Azure Active Directory (Azure AD)，是 Azure 标识的基础。</span><span class="sxs-lookup"><span data-stu-id="adfdd-266">Azure Active Directory (Azure AD), connected to your on-premises Active Directory, is the foundation of Azure Identity.</span></span> <span data-ttu-id="adfdd-267">即便如此，Azure AD 并非 Active Directory，而且了解什么是 Azure AD 租户及其与 Azure 注册的关系非常重要。</span><span class="sxs-lookup"><span data-stu-id="adfdd-267">That said, Azure AD is *not* Active Directory and it's important to understand what an Azure AD tenant is and how it relates to your Azure enrollment.</span></span>  <span data-ttu-id="adfdd-268">查看可用[信息](../getting-started/azure-resource-access.md)，以获取 Azure AD 和 AD 的坚实基础。</span><span class="sxs-lookup"><span data-stu-id="adfdd-268">Review the available [information](../getting-started/azure-resource-access.md) to gain a solid foundation on Azure AD and AD.</span></span> <span data-ttu-id="adfdd-269">若要连接 Active Directory 并将其同步到 Azure AD，请在本地安装和配置 [AD Connect 工具](/azure/active-directory/connect/active-directory-aadconnect)。</span><span class="sxs-lookup"><span data-stu-id="adfdd-269">To connect and synchronize your Active Directory to Azure AD, install and configure the [AD Connect tool](/azure/active-directory/connect/active-directory-aadconnect) on-premises.</span></span>

![arch.png](./_images/arch.png)

<span data-ttu-id="adfdd-271">Azure 在最初发布时，对订阅的访问控制非常直接：只允许管理员或共同管理员访问。</span><span class="sxs-lookup"><span data-stu-id="adfdd-271">When Azure was initially released, access controls to a subscription were basic: Administrator or Co-Administrator.</span></span> <span data-ttu-id="adfdd-272">有权访问经典模型中的订阅意味着有权访问门户中的所有资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-272">Access to a subscription in the Classic model implied access to all the resources in the portal.</span></span> <span data-ttu-id="adfdd-273">缺少精细控制导致需要衍生订阅来针对 Azure 注册提供合理的访问控制级别。</span><span class="sxs-lookup"><span data-stu-id="adfdd-273">This lack of fine-grained control led to the proliferation of subscriptions to provide a level of reasonable access control for an Azure Enrollment.</span></span> <span data-ttu-id="adfdd-274">现在不再需要衍生订阅。</span><span class="sxs-lookup"><span data-stu-id="adfdd-274">This proliferation of subscriptions is no longer needed.</span></span> <span data-ttu-id="adfdd-275">借助基于角色的访问控制 (RBAC)，可将用户分配给提供常见访问权限的标准角色，如“所有者”、“参与者”或“读者”，甚至还可创建自己的角色</span><span class="sxs-lookup"><span data-stu-id="adfdd-275">With role-based access control (RBAC), you can assign users to standard roles that provide common access such as "owner", "contributor" or "reader" or even create your own roles</span></span>

<span data-ttu-id="adfdd-276">实施基于角色的访问时，强烈建议执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="adfdd-276">When implementing role-based access, the following are highly recommended:</span></span>

* <span data-ttu-id="adfdd-277">控制订阅的管理员/共同管理员，因为这些角色拥有广泛的权限。</span><span class="sxs-lookup"><span data-stu-id="adfdd-277">Control the Administrator/Co-Administrator of a subscription as these roles have extensive permissions.</span></span> <span data-ttu-id="adfdd-278">如果他们需要管理 Azure 经典部署，则仅需将“订阅所有者”添加为共同管理员。</span><span class="sxs-lookup"><span data-stu-id="adfdd-278">You only need to add the Subscription Owner as a Co-administrator if they need to managed Azure Classic deployments.</span></span>

* <span data-ttu-id="adfdd-279">使用管理组在多个订阅中分配[角色](/azure/azure-resource-manager/management-groups-overview#management-group-access)，并减少在订阅级别对其进行管理的负担。</span><span class="sxs-lookup"><span data-stu-id="adfdd-279">Use Management Groups to assign [roles](/azure/azure-resource-manager/management-groups-overview#management-group-access) across multiple subscriptions and reduce the burden of managing them at the subscription level.</span></span>
* <span data-ttu-id="adfdd-280">将 Azure 用户添加到 Active Directory 中的组（例如，应用程序 X 所有者）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-280">Add Azure users to a group (for example, Application X Owners) in Active Directory.</span></span> <span data-ttu-id="adfdd-281">使用同步组为组成员提供适当的权限来管理包含应用程序的资源组。</span><span class="sxs-lookup"><span data-stu-id="adfdd-281">Use the synced group to provide group members the appropriate rights to manage the resource group containing the application.</span></span>
* <span data-ttu-id="adfdd-282">遵循授予**最低特权**的原则，以便完成所需的工作。</span><span class="sxs-lookup"><span data-stu-id="adfdd-282">Follow the principle of granting the **least privilege** required to do the expected work.</span></span>

> [!IMPORTANT]
><span data-ttu-id="adfdd-283">请考虑使用 [Azure AD Privileged Identity Management](/azure/active-directory/privileged-identity-management/pim-configure)、Azure [多重身份验证](/azure/active-directory/authentication/howto-mfa-getstarted)和[条件访问](/azure/active-directory/active-directory-conditional-access-azure-portal)功能，为 Azure 订阅中的管理操作提供更高的安全性和可见性。</span><span class="sxs-lookup"><span data-stu-id="adfdd-283">Consider using [Azure AD Privileged Identity Management](/azure/active-directory/privileged-identity-management/pim-configure), Azure [Multi-Factor Authentication](/azure/active-directory/authentication/howto-mfa-getstarted) and [Conditional Access](/azure/active-directory/active-directory-conditional-access-azure-portal) capabilities to provide better security and more visibility to administrative actions across your Azure subscriptions.</span></span> <span data-ttu-id="adfdd-284">这些功能来自有效的 Azure AD Premium 许可证（取决于功能），以进一步保护和管理标识。</span><span class="sxs-lookup"><span data-stu-id="adfdd-284">These capabilities come from a valid Azure AD Premium license (depending on the feature) to further secure and manage your identity.</span></span> <span data-ttu-id="adfdd-285">Azure AD PIM 通过批准工作流实现“实时”管理访问，并对管理员激活和活动进行全面审核。</span><span class="sxs-lookup"><span data-stu-id="adfdd-285">Azure AD PIM enables "Just-in-Time" administrative access with approval workflow, as well as a full audit of administrator activations and activities.</span></span> <span data-ttu-id="adfdd-286">Azure MFA 是另一项重要功能，支持登录到 Azure 门户的双重验证。</span><span class="sxs-lookup"><span data-stu-id="adfdd-286">Azure MFA is another critical capability and enables two-step verification for login to the Azure portal.</span></span> <span data-ttu-id="adfdd-287">与条件访问控制相结合时，可以有效地管理泄露风险。</span><span class="sxs-lookup"><span data-stu-id="adfdd-287">When combined with Conditional Access Controls you can effectively manage your risk of compromise.</span></span>

<span data-ttu-id="adfdd-288">规划和准备标识及访问控制并遵循 Azure 标识管理最佳做法（[链接](/azure/security/azure-security-identity-management-best-practices)）是可采用的最佳风险缓解策略之一，应将其视为每个部署的强制策略。</span><span class="sxs-lookup"><span data-stu-id="adfdd-288">Planning and preparing for your identity and access controls and following Azure Identity Management best practice ([link](/azure/security/azure-security-identity-management-best-practices)) is one of the best risk mitigation strategies that you can employ and should be considered mandatory for every deployment.</span></span>

## <a name="security"></a><span data-ttu-id="adfdd-289">安全</span><span class="sxs-lookup"><span data-stu-id="adfdd-289">Security</span></span>

<span data-ttu-id="adfdd-290">在采用云的过程中，传统上最大的阻碍之一是安全忧虑。</span><span class="sxs-lookup"><span data-stu-id="adfdd-290">One of the biggest blockers to cloud adoption traditionally has been concerns over security.</span></span> <span data-ttu-id="adfdd-291">IT 风险管理员和安全部门需确保默认情况下 Azure 中的资源受保护且安全。</span><span class="sxs-lookup"><span data-stu-id="adfdd-291">IT risk managers and security departments need to ensure that resources in Azure are protected and secure by default.</span></span> <span data-ttu-id="adfdd-292">Azure 提供了许多功能，利用这些功能可保护资源并检测/预防针对这些资源的威胁。</span><span class="sxs-lookup"><span data-stu-id="adfdd-292">Azure provides a number of capabilities that you can leverage to protect resources and detect/prevent threats against those resources.</span></span>

### <a name="azure-security-center"></a><span data-ttu-id="adfdd-293">Azure 安全中心</span><span class="sxs-lookup"><span data-stu-id="adfdd-293">Azure Security Center</span></span>

<span data-ttu-id="adfdd-294">除高级威胁防护外，[Azure 安全中心](/azure/security-center/security-center-intro)还提供了整个环境中资源安全状态的统一视图。</span><span class="sxs-lookup"><span data-stu-id="adfdd-294">The [Azure Security Center](/azure/security-center/security-center-intro) provides a unified view of the security status of resources across your environment in addition to advanced threat protection.</span></span> <span data-ttu-id="adfdd-295">Azure 安全中心是一个开放式平台，允许 Microsoft 合作伙伴创建可插入并增强其功能的软件。</span><span class="sxs-lookup"><span data-stu-id="adfdd-295">Azure Security Center is an open platform that enables Microsoft partners to create software that plugs into and enhance its capabilities.</span></span> <span data-ttu-id="adfdd-296">Azure 安全中心（免费层）的基线功能提供了评估和建议，可改善安全状况。</span><span class="sxs-lookup"><span data-stu-id="adfdd-296">The baseline capabilities of Azure Security Center (free tier) provides assessment and recommendations that will enhance your security posture.</span></span> <span data-ttu-id="adfdd-297">其付费层可实现其他有价值的功能，例如实时管理员访问和自适应应用程序控件（允许列表）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-297">Its paid tiers enable additional and valuable capabilities such as Just In Time admin access and adaptive application controls (whitelisting).</span></span>

> [!TIP]
><span data-ttu-id="adfdd-298">Azure 安全中心是一款非常强大的工具，这款工具不断得到增强，还不断包含新功能，可利用这些功能来检测威胁并保护企业。</span><span class="sxs-lookup"><span data-stu-id="adfdd-298">Azure security center is a very powerful tool that is constantly being enhanced and incorporating new capabilities you can leverage to detect threats and protect your enterprise.</span></span> <span data-ttu-id="adfdd-299">强烈建议始终启用 ASC。</span><span class="sxs-lookup"><span data-stu-id="adfdd-299">It is highly recommended to always enable ASC.</span></span>

### <a name="azure-resource-locks"></a><span data-ttu-id="adfdd-300">Azure 资源锁</span><span class="sxs-lookup"><span data-stu-id="adfdd-300">Azure resource locks</span></span>

<span data-ttu-id="adfdd-301">随着组织不断在订阅中添加核心服务，避免业务中断变得越来越重要。</span><span class="sxs-lookup"><span data-stu-id="adfdd-301">As your organization adds core services to subscriptions it becomes increasingly important to avoid business disruption.</span></span> <span data-ttu-id="adfdd-302">我们经常见到的一种中断是，脚本和工具针对 Azure 订阅错误删除资源而运行的意外结果。</span><span class="sxs-lookup"><span data-stu-id="adfdd-302">One type of disruption that we often see is unintended consequences of scripts and tools working against an Azure subscription deleting resources mistakenly.</span></span> <span data-ttu-id="adfdd-303">使用[资源锁](/azure/azure-resource-manager/resource-group-lock-resources)可以限制针对高价值资源（修改或删除这些资源会造成重大影响）的操作。</span><span class="sxs-lookup"><span data-stu-id="adfdd-303">[Resource Locks](/azure/azure-resource-manager/resource-group-lock-resources) enable you to restrict operations on high-value resources where modifying or deleting them would have a significant impact.</span></span> <span data-ttu-id="adfdd-304">锁应用于订阅、资源组，甚至是各个资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-304">Locks are applied to a subscription, resource group, or even individual resources.</span></span> <span data-ttu-id="adfdd-305">常见用例是将锁应用于基本资源，如虚拟网络、网关、网络安全组和密钥存储帐户。</span><span class="sxs-lookup"><span data-stu-id="adfdd-305">The common use case is to apply locks to foundational resources such as virtual networks, gateways, network security groups and key storage accounts.</span></span>

### <a name="secure-devops-toolkit"></a><span data-ttu-id="adfdd-306">安全 DevOps 工具包</span><span class="sxs-lookup"><span data-stu-id="adfdd-306">Secure DevOps Toolkit</span></span>

<span data-ttu-id="adfdd-307">“用于 Azure 的安全 DevOps 工具包”(AzSK) 是脚本、工具、扩展、自动化等的集合，最初由 Microsoft 自己的 IT 团队创建，并通过 Github（[链接](https://github.com/azsk/DevOpsKit-docs)）在 OpenSource 中发布。</span><span class="sxs-lookup"><span data-stu-id="adfdd-307">The "Secure DevOps Kit for Azure" (AzSK) is a collection of scripts, tools, extensions, automations, etc. originally created by Microsoft's own IT Team and released in OpenSource via Github ([link](https://github.com/azsk/DevOpsKit-docs)).</span></span> <span data-ttu-id="adfdd-308">AzSK 满足了团队端到端 Azure 订阅和资源安全需求，这些团队使用广泛的自动化并顺利地将安全性集成到本机开发运营工作流中，有助于实现以下 6 个重点领域的安全开发运营：</span><span class="sxs-lookup"><span data-stu-id="adfdd-308">AzSK caters to the end to end Azure subscription and resource security needs for teams using extensive automation and smoothly integrating security into native dev ops workflows helping accomplish secure dev ops with these 6 focus areas:</span></span>

* <span data-ttu-id="adfdd-309">保护订阅</span><span class="sxs-lookup"><span data-stu-id="adfdd-309">Secure the subscription</span></span>
* <span data-ttu-id="adfdd-310">启用安全开发</span><span class="sxs-lookup"><span data-stu-id="adfdd-310">Enable secure development</span></span>
* <span data-ttu-id="adfdd-311">将安全性集成到 CICD 中</span><span class="sxs-lookup"><span data-stu-id="adfdd-311">Integrate security into CICD</span></span>
* <span data-ttu-id="adfdd-312">持续保障</span><span class="sxs-lookup"><span data-stu-id="adfdd-312">Continuous Assurance</span></span>
* <span data-ttu-id="adfdd-313">警报和监视</span><span class="sxs-lookup"><span data-stu-id="adfdd-313">Alerting & Monitoring</span></span>
* <span data-ttu-id="adfdd-314">云风险管理</span><span class="sxs-lookup"><span data-stu-id="adfdd-314">Cloud Risk Governance</span></span>

![Azure 开发运营工具包](_images/Secure_DevOps_Kit_Azure.png)

<span data-ttu-id="adfdd-316">AzSK 是一套丰富的工具、脚本和信息，它们是完整 Azure 管理计划的重要组成部分，将其整合到基架中对于支持组织的风险管理目标至关重要</span><span class="sxs-lookup"><span data-stu-id="adfdd-316">The AzSK is a rich set of tools, scripts and information that are an important part of a full Azure governance plan and incorporating this into your scaffold is crucial to supporting your organizations risk management goals</span></span>

### <a name="azure-update-management"></a><span data-ttu-id="adfdd-317">Azure 更新管理</span><span class="sxs-lookup"><span data-stu-id="adfdd-317">Azure Update Management</span></span>

<span data-ttu-id="adfdd-318">为确保环境安全，可执行的关键任务之一是务必使用最新更新修补服务器。</span><span class="sxs-lookup"><span data-stu-id="adfdd-318">One of the key tasks you can do to keep your environment safe is ensure that your servers are patched with the latest updates.</span></span> <span data-ttu-id="adfdd-319">虽然许多工具可实现这一点，但 Azure 提供了 [Azure 更新管理](/azure/automation/automation-update-management)解决方案，用于解决关键 OS 修补程序的识别和推出问题。</span><span class="sxs-lookup"><span data-stu-id="adfdd-319">While there are many tools to accomplish this, Azure provides the [Azure Update Management](/azure/automation/automation-update-management) solution to address the identification and rollout of critical OS patches.</span></span>  <span data-ttu-id="adfdd-320">这利用了 Azure 自动化（本指南后面的[自动化](#automate)部分对此进行了介绍）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-320">It makes use of Azure Automation (which is covered in the [Automate](#automate) section, later in this guide.</span></span>

## <a name="monitor-and-alerts"></a><span data-ttu-id="adfdd-321">监视和警报</span><span class="sxs-lookup"><span data-stu-id="adfdd-321">Monitor and alerts</span></span>

<span data-ttu-id="adfdd-322">收集和分析遥测数据（可用于观察所有 Azure 订阅中所使用服务的活动、性能指标、运行状况和可用性）对于主动管理应用程序和基础结构至关重要，也是每个 Azure 订阅的基本需求。</span><span class="sxs-lookup"><span data-stu-id="adfdd-322">Collecting and analyzing telemetry that provides line of sight into the activities, performance metrics, health and availability of the services you are using across all of your Azure subscriptions is critical to proactively manage your applications and infrastructure and is a foundational need of every Azure subscription.</span></span> <span data-ttu-id="adfdd-323">每个 Azure 服务均以活动日志、指标和诊断日志的形式发出遥测数据。</span><span class="sxs-lookup"><span data-stu-id="adfdd-323">Every Azure service emits telemetry in the form of Activity Logs, Metrics and Diagnostic Logs.</span></span>

* <span data-ttu-id="adfdd-324">活动日志描述了对订阅中的资源执行的所有操作</span><span class="sxs-lookup"><span data-stu-id="adfdd-324">**Activity Logs** describe all operations performed on resources in your subscriptions</span></span>
* <span data-ttu-id="adfdd-325">指标是从资源中发出的描述资源性能和运行状况的数字信息</span><span class="sxs-lookup"><span data-stu-id="adfdd-325">**Metrics** are numerical information emitted from within a resource that describe the performance and health of a resource</span></span>
* <span data-ttu-id="adfdd-326">诊断日志由 Azure 服务发出，提供与该服务的操作相关的各种频繁生成的数据。</span><span class="sxs-lookup"><span data-stu-id="adfdd-326">**Diagnostic Logs** are emitted by an Azure service and provide rich, frequent data about the operation of that service.</span></span>

<span data-ttu-id="adfdd-327">可在多个级别查看和处理此信息，并不断改进。</span><span class="sxs-lookup"><span data-stu-id="adfdd-327">This information can be viewed and acted upon at multiple levels and are continually being improved.</span></span> <span data-ttu-id="adfdd-328">Azure 通过下图中列出的服务提供 Azure 资源的“共享”、“核心”和“深度”监视功能。</span><span class="sxs-lookup"><span data-stu-id="adfdd-328">Azure provides **shared**, **core** and **deep** monitoring capabilities of Azure resources through the services outlined in the diagram below.</span></span>
<span data-ttu-id="adfdd-329">![监视](./_images/monitoring.png)</span><span class="sxs-lookup"><span data-stu-id="adfdd-329">![monitoring](./_images/monitoring.png)</span></span>

### <a name="shared-capabilities"></a><span data-ttu-id="adfdd-330">共享功能</span><span class="sxs-lookup"><span data-stu-id="adfdd-330">Shared capabilities</span></span>

* <span data-ttu-id="adfdd-331">**警报**：可从 Azure 资源收集每个日志、事件和指标，但由于无法获得关键条件和行为的通知，此数据仅可用于历史用途和取证。</span><span class="sxs-lookup"><span data-stu-id="adfdd-331">**Alerts**: You can collect every log, event and metric from Azure resources, but without the ability to be notified of critical conditions and act, this data is only useful for historic purposes and forensics.</span></span> <span data-ttu-id="adfdd-332">Azure 警报会主动通知你在所有应用程序和基础结构中定义的条件。</span><span class="sxs-lookup"><span data-stu-id="adfdd-332">Azure Alerts proactively notify you of conditions you define across all your applications and infrastructure.</span></span> <span data-ttu-id="adfdd-333">可在使用操作组通知收件人组的日志、事件和指标之间创建预警规则。</span><span class="sxs-lookup"><span data-stu-id="adfdd-333">You create alert rules across logs, events and metrics that use action groups to notify sets of recipients.</span></span> <span data-ttu-id="adfdd-334">操作组还提供使用外部操作（如 Webhook）自动执行修复的功能，以运行 Azure 自动化 runbook 和 Azure Functions。</span><span class="sxs-lookup"><span data-stu-id="adfdd-334">Action groups also provide the ability to automate remediation using external actions such as webhooks to run Azure Automation runbooks and Azure Functions.</span></span>

* <span data-ttu-id="adfdd-335">**仪表板**：使用仪表板可聚合监视视图，并跨资源和订阅合并数据，提供整个企业范围内 Azure 资源遥测数据的视图。</span><span class="sxs-lookup"><span data-stu-id="adfdd-335">**Dashboards**: Dashboards enable you to aggregate monitoring views and combine data across resources and subscriptions to give you an enterprise-wide view into the telemetry of Azure resources.</span></span> <span data-ttu-id="adfdd-336">可创建和配置自己的视图，并与他人共享。</span><span class="sxs-lookup"><span data-stu-id="adfdd-336">You can create and configure your own views and share them with others.</span></span> <span data-ttu-id="adfdd-337">例如，可为 DBA 创建一个由各种磁贴组成的仪表板，以提供所有 Azure 数据库服务的信息，包括 Azure SQL DB、用于 PostgreSQL 的 Azure DB 和用于 MySQL 的 Azure DB。</span><span class="sxs-lookup"><span data-stu-id="adfdd-337">For example, you could create a dashboard consisting of various tiles for DBAs to provide information across all Azure database services, including Azure SQL DB, Azure DB for PostgreSQL and Azure DB for MySQL.</span></span>

* <span data-ttu-id="adfdd-338">**指标资源管理器**：指标是 Azure 资源生成的数字值（例如 CPU 百分比、磁盘 I/O），用于了解资源的操作和性能。</span><span class="sxs-lookup"><span data-stu-id="adfdd-338">**Metrics Explorer**: Metrics are numerical values generated by Azure resources (e.g. % CPU, Disk I/O, that provide insight into the operation and performance of your resources.</span></span> <span data-ttu-id="adfdd-339">通过指标资源管理器，可定义指标并将感兴趣的指标发送到 Log Analytics 进行聚合和分析。</span><span class="sxs-lookup"><span data-stu-id="adfdd-339">By using Metrics Explorer you can define and send the metrics in which you are interested to Log Analytics for aggregation and analysis.</span></span>

### <a name="core-monitoring"></a><span data-ttu-id="adfdd-340">核心监视</span><span class="sxs-lookup"><span data-stu-id="adfdd-340">Core monitoring</span></span>

* <span data-ttu-id="adfdd-341">**Azure Monitor**：Azure Monitor 是一款核心平台服务，提供用于监视 Azure 资源的单一源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-341">**Azure Monitor**: Azure Monitor is the core platform service that provides a single source for monitoring Azure resources.</span></span> <span data-ttu-id="adfdd-342">Azure Monitor 的 Azure 门户界面为 Azure 中的所有监视功能提供了集中的突出显示点，包括 Application Insights、Log Analytics、网络监视、管理解决方案和服务映射的深度监视功能。</span><span class="sxs-lookup"><span data-stu-id="adfdd-342">The Azure Portal interface of Azure Monitor provides a centralized jump off point for all the monitoring features across Azure including the deep monitoring capabilities of Application Insights, Log Analytics, Network Monitoring, Management Solutions and Service Maps.</span></span> <span data-ttu-id="adfdd-343">通过 Azure Monitor，可对来自整个云产业中 Azure 资源的指标和日志进行可视化、查询、路由、存档和执行操作。</span><span class="sxs-lookup"><span data-stu-id="adfdd-343">With Azure Monitor you can visualize, query, route, archive and act on the metrics and logs coming from Azure resources across your entire cloud estate.</span></span> <span data-ttu-id="adfdd-344">除门户外，还可通过 Monitor PowerShell Cmdlets、跨平台 CLI 或 Azure Monitor REST API 检索数据。</span><span class="sxs-lookup"><span data-stu-id="adfdd-344">In addition to the portal you can retrieve data through the Monitor PowerShell Cmdlets, Cross Platform CLI or the Azure Monitor REST APIs.</span></span>

* <span data-ttu-id="adfdd-345">**Azure 顾问**：Azure 顾问不断监视订阅和环境中的遥测数据，同时就如何优化 Azure 资源以节省资金并提高构成应用程序的资源的性能、安全性和可用性，提供了最佳做法建议。</span><span class="sxs-lookup"><span data-stu-id="adfdd-345">**Azure Advisor**: Azure Advisor constantly monitors telemetry across your subscriptions and environments and provides recommendations on best practices on how to optimize your Azure resources to save money and improve performance, security and availability of the resources that make up your applications.</span></span>

* <span data-ttu-id="adfdd-346">**服务运行状况**：Azure 服务运行状况可识别 Azure 服务中可能影响应用程序的任何问题，并有助于规划计划性维护时段。</span><span class="sxs-lookup"><span data-stu-id="adfdd-346">**Service Health**: Azure Service Health identifies any issues with Azure Services that may impact your applications as well as assists you in planning for scheduled maintenance windows.</span></span>

* <span data-ttu-id="adfdd-347">**活动日志**：活动日志描述了对订阅中资源执行的所有操作。</span><span class="sxs-lookup"><span data-stu-id="adfdd-347">**Activity Log**: The Activity Log describes all operations on resources in your subscriptions.</span></span> <span data-ttu-id="adfdd-348">它提供了一条审核线索，可确定对资源执行的任何创建、更新、删除操作的“内容”、“人员”和“时间”。</span><span class="sxs-lookup"><span data-stu-id="adfdd-348">It provides an audit trail to determine the 'what', 'who', and 'when' of any create, update, delete operation on resources.</span></span> <span data-ttu-id="adfdd-349">活动日志事件存储在平台中，可在 90 天内进行查询。</span><span class="sxs-lookup"><span data-stu-id="adfdd-349">Activity Log events are stored in the platform and are available to query for 90 days.</span></span> <span data-ttu-id="adfdd-350">可将活动日志引入 Log Analytics 中，以实现更长的保持期，并在多个资源中进行更深入的查询和分析。</span><span class="sxs-lookup"><span data-stu-id="adfdd-350">You can ingest Activity Logs into Log Analytics for longer retention periods and deeper querying and analysis across multiple resources.</span></span>

### <a name="deep-application-monitoring"></a><span data-ttu-id="adfdd-351">深度应用程序监视</span><span class="sxs-lookup"><span data-stu-id="adfdd-351">Deep application monitoring</span></span>

* <span data-ttu-id="adfdd-352">**Application Insights**：使用 Application Insights 可收集特定于应用程序的遥测数据，并可监视云中或本地的应用程序的性能、可用性和使用情况。</span><span class="sxs-lookup"><span data-stu-id="adfdd-352">**Application Insights**: Application Insights enables you to collect application specific telemetry and monitor the performance, availability and usage of applications in the cloud or on-premises.</span></span> <span data-ttu-id="adfdd-353">通过使用支持的 SDK 为多种语言（包括 .NET、JavaScript、JAVA、Node.js、Ruby 和 Python）检测应用程序。</span><span class="sxs-lookup"><span data-stu-id="adfdd-353">By instrumenting your application with supported SDKs for multiple languages including .NET, JavaScript, JAVA, Node.js, Ruby and Python.</span></span> <span data-ttu-id="adfdd-354">Application Insights 事件已引入支持基础结构和安全性监视的同一 Log Analytics 数据存储中，从而可通过丰富的查询语言随着时间推移关联和聚合事件。</span><span class="sxs-lookup"><span data-stu-id="adfdd-354">Application Insights events are ingested into the same Log Analytics data store that supports infrastructure and security monitoring to enable you to correlate and aggregate events over time through a rich query language.</span></span>

### <a name="deep-infrastructure-monitoring"></a><span data-ttu-id="adfdd-355">深度基础结构监视</span><span class="sxs-lookup"><span data-stu-id="adfdd-355">Deep infrastructure monitoring</span></span>

* <span data-ttu-id="adfdd-356">**Log Analytics**：Log Analytics 在 Azure 监视中发挥了重要作用，具体表现在：从各种源收集遥测数据和其他数据，以及提供查询语言和分析引擎，用于了解应用程序和资源的运行情况。</span><span class="sxs-lookup"><span data-stu-id="adfdd-356">**Log Analytics**: Log Analytics plays a central role in Azure monitoring by collecting telemetry and other data from a variety of sources and providing a query language and analytics engine that gives you insights into the operation of your applications and resources.</span></span> <span data-ttu-id="adfdd-357">可以通过高性能的日志搜索和视图直接与 Log Analytics 数据交互，也可以在其他 Azure 服务（例如 Application Insights 或 Azure 安全中心，可以将其数据存储在 Log Analytics 中）中使用分析工具。</span><span class="sxs-lookup"><span data-stu-id="adfdd-357">You can either interact directly with Log Analytics data through highly performant log searches and views, or you may use analysis tools in other Azure services that store their data in Log Analytics such as Application Insights or Azure Security Center.</span></span>

* <span data-ttu-id="adfdd-358">**网络监视**：使用 Azure 的网络监视服务可深入了解网络流量、性能、安全性、连接性和瓶颈。</span><span class="sxs-lookup"><span data-stu-id="adfdd-358">**Network Monitoring**: Azure's network monitoring services enable you to gain insight into network traffic flow, performance, security, connectivity and bottlenecks.</span></span> <span data-ttu-id="adfdd-359">精心规划的网络设计应包括配置 Azure 网络监视服务，如网络观察程序和 ExpressRoute 监视器。</span><span class="sxs-lookup"><span data-stu-id="adfdd-359">A well-planned network design should include configuring Azure network monitoring services such as Network Watcher and ExpressRoute Monitor.</span></span>

* <span data-ttu-id="adfdd-360">**管理解决方案**：管理解决方案是应用程序或服务的逻辑、见解和预定义 Log Analytics 查询的打包集。</span><span class="sxs-lookup"><span data-stu-id="adfdd-360">**Management Solutions**: Management solutions are packaged sets of logic, insights and pre-defined Log Analytics queries for an application or service.</span></span> <span data-ttu-id="adfdd-361">它们依赖于 Log Analytics 并将其作为存储和分析事件数据的基础。</span><span class="sxs-lookup"><span data-stu-id="adfdd-361">They rely on Log Analytics as the foundation to store and analyze event data.</span></span> <span data-ttu-id="adfdd-362">示例管理解决方案包括监视容器和 Azure SQL 数据库分析。</span><span class="sxs-lookup"><span data-stu-id="adfdd-362">Sample management solutions include monitoring containers and Azure SQL Database analytics.</span></span>

* <span data-ttu-id="adfdd-363">**服务映射**：服务映射提供了一个图形视图，可查看基础结构组件及其在其他计算机和外部进程上的进程和相互依赖性。</span><span class="sxs-lookup"><span data-stu-id="adfdd-363">**Service Map**: Service Map provides a graphical view into your infrastructure components, their processes and interdependencies on other computers and external processes.</span></span> <span data-ttu-id="adfdd-364">它将事件、性能数据和管理解决方案集成到 Log Analytics 中。</span><span class="sxs-lookup"><span data-stu-id="adfdd-364">It integrates events, performance data and management solutions in Log Analytics.</span></span>

> [!TIP]
> <span data-ttu-id="adfdd-365">在创建单个警报之前，请创建一组可在 Azure 警报中使用的共享操作组并进行维护。</span><span class="sxs-lookup"><span data-stu-id="adfdd-365">Before creating individual alerts, create and maintain a set of shared Action Groups that can be used across Azure Alerts.</span></span> <span data-ttu-id="adfdd-366">通过此操作可集中维护收件人列表的生命周期、通知发送方法（电子邮件、SMS 电话号码）和外部操作的 Webhook（Azure 自动化 runbook、Azure Functions/逻辑应用、ITSM）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-366">This will enable you to centrally maintain the lifecycle of your recipient lists, notification delivery methods (email, SMS phone numbers) and webhooks to external actions (Azure Automation runbooks, Azure Functions / Logic Apps, ITSM).</span></span>

## <a name="cost-management"></a><span data-ttu-id="adfdd-367">成本管理</span><span class="sxs-lookup"><span data-stu-id="adfdd-367">Cost management</span></span>

<span data-ttu-id="adfdd-368">从本地云迁移到公有云时，要面临的主要变化之一是从资本支出（购买硬件）转换为运营支出（使用时支付服务费用）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-368">One of the major changes that you will face when you move from on-premises cloud to the public cloud is the switch from capital expenditure (buying hardware) to operating expenditure (paying for service as you use it).</span></span> <span data-ttu-id="adfdd-369">从资本支出到运营支出的这种转换也需要更仔细地管理成本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-369">This switch from CAPEX to OPEX also brings the need to more carefully manage your costs.</span></span> <span data-ttu-id="adfdd-370">云的优势在于，当不需要服务时，只需将其关闭（或调整大小），即可从根本上积极改变所使用服务的成本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-370">The benefit of the cloud is that you can fundamentally and positively impact the cost of a service you use by merely turning it off (or resizing) when it's not needed.</span></span> <span data-ttu-id="adfdd-371">谨慎管理云中的成本是建议的做法，也是成熟客户的日常事务。</span><span class="sxs-lookup"><span data-stu-id="adfdd-371">Deliberately managing your costs in the cloud is a recommended practice and one that mature customers do daily.</span></span>

<span data-ttu-id="adfdd-372">Microsoft 提供了多种工具，以便直观显示、跟踪和管理成本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-372">Microsoft provides a several tools for you to be able to visual, track and manage your costs.</span></span> <span data-ttu-id="adfdd-373">我们还提供了全套 API，可用于自定义成本并将成本管理集成到自己的工具和仪表板中。</span><span class="sxs-lookup"><span data-stu-id="adfdd-373">We also provide a full set of APIs to enable you to customize and integrate cost management into your own tools and dashboards.</span></span> <span data-ttu-id="adfdd-374">这些工具大致可分为：Azure 门户功能和外部功能</span><span class="sxs-lookup"><span data-stu-id="adfdd-374">These tools are loosely grouped into: Azure Portal Capabilities and external capabilities</span></span>

### <a name="azure-portal-capabilities"></a><span data-ttu-id="adfdd-375">Azure 门户功能</span><span class="sxs-lookup"><span data-stu-id="adfdd-375">Azure Portal capabilities</span></span>

<span data-ttu-id="adfdd-376">这些工具可提供有关成本的即时信息以及执行操作的功能</span><span class="sxs-lookup"><span data-stu-id="adfdd-376">These are tools to provide you instant information on cost as well as the ability to take actions</span></span>

* <span data-ttu-id="adfdd-377">**订阅资源成本**：借助位于门户中的 [Azure 成本分析](/azure/cost-management/overview)视图，可快速查看有关资源或资源组的成本和每日支出信息。</span><span class="sxs-lookup"><span data-stu-id="adfdd-377">**Subscription Resource Cost**: Located in The Portal, the [Azure Cost Analysis](/azure/cost-management/overview) view provides a quick look at your costs and information on daily spend by resource or resource group.</span></span>
* <span data-ttu-id="adfdd-378">**Azure 成本管理**：此产品是 Microsoft 购买 Cloudyn 的结果，用于管理和分析 Azure 支出以及其他公有云服务提供商上的支出。</span><span class="sxs-lookup"><span data-stu-id="adfdd-378">**Azure Cost Management**: This product is the result of the purchase of Cloudyn by Microsoft and allows you to manage and analyze your Azure spend as well what you spend on other Public Cloud providers.</span></span> <span data-ttu-id="adfdd-379">功能丰富的免费层和付费层均可供选择，如[概述](/azure/cost-management/overview)所示。</span><span class="sxs-lookup"><span data-stu-id="adfdd-379">There are both free and paid tiers, with a great wealth of capabilities as seen in the [overview](/azure/cost-management/overview).</span></span>
* <span data-ttu-id="adfdd-380">**Azure 预算和操作组**直到最近，了解某些内容的成本并对其采取措施，更多的是手动操作。</span><span class="sxs-lookup"><span data-stu-id="adfdd-380">**Azure Budgets and Action Groups** Knowing what somethings costs and doing something about it until recently has been more of a manual exercise.</span></span> <span data-ttu-id="adfdd-381">随着 Azure 预算及其 API 的引入，现在可在成本达到阈值时创建操作（如[此](https://channel9.msdn.com/Shows/Azure-Friday/Managing-costs-with-the-Azure-Budgets-API-and-Action-Groups)示例中所示）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-381">With the introduction of Azure Budgets and its APIs, it's now possible to create actions (as seen in [this](https://channel9.msdn.com/Shows/Azure-Friday/Managing-costs-with-the-Azure-Budgets-API-and-Action-Groups) example) when costs hit a threshold.</span></span> <span data-ttu-id="adfdd-382">例如，当“测试”资源组达到预算的 100% 时，关闭该资源组，或 [另一示例]。</span><span class="sxs-lookup"><span data-stu-id="adfdd-382">For example, shutting down a "test" resource group when it hits 100% of its budget, or [another example].</span></span>
* <span data-ttu-id="adfdd-383">**Azure 顾问**了解某些内容的成本仅完成了任务的一半，另一半在于了解如何处理该信息。</span><span class="sxs-lookup"><span data-stu-id="adfdd-383">**Azure Advisor** Knowing what something costs is only half the battle; the other half is knowing what to do with that information.</span></span> <span data-ttu-id="adfdd-384">[Azure 顾问](/azure/advisor/advisor-overview)为节省资金、提高可靠性甚至提高安全性要执行的操作提供了建议。</span><span class="sxs-lookup"><span data-stu-id="adfdd-384">[Azure Advisor](/azure/advisor/advisor-overview) provides you recommendations on actions to take to save money, improve reliability or even increase security.</span></span>

### <a name="external-cost-management-tools"></a><span data-ttu-id="adfdd-385">外部成本管理工具</span><span class="sxs-lookup"><span data-stu-id="adfdd-385">External cost management tools</span></span>

* <span data-ttu-id="adfdd-386">**PowerBI Azure 使用见解**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-386">**PowerBI Azure Consumption Insights**.</span></span> <span data-ttu-id="adfdd-387">是否要为组织创建自己的可视化效果？</span><span class="sxs-lookup"><span data-stu-id="adfdd-387">Do you want to create your own visualizations for your organization?</span></span> <span data-ttu-id="adfdd-388">如果是，则 PowerBI 的 Azure 使用见解内容包是首选工具。</span><span class="sxs-lookup"><span data-stu-id="adfdd-388">If so, then the Azure Consumption Insights content pack for PowerBI is your tool of choice.</span></span> <span data-ttu-id="adfdd-389">使用此内容包和 PowerBI，可创建自定义可视化效果来表示组织，对成本进行更深入的分析，并添加其他数据源以进一步扩充。</span><span class="sxs-lookup"><span data-stu-id="adfdd-389">Using this content pack and PowerBI you can create custom visualizations to represent your organization, do deeper analysis on costs and add in other data sources for further enrichment.</span></span>

* <span data-ttu-id="adfdd-390">**使用情况 API**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-390">**Consumption API**.</span></span> <span data-ttu-id="adfdd-391">除有关预算、预留实例和市场费用的信息之外，[使用情况 API](/rest/api/consumption/) 还允许以编程方式访问成本和使用情况数据。</span><span class="sxs-lookup"><span data-stu-id="adfdd-391">The [consumption APIs](/rest/api/consumption/) give you programmatic access to cost and usage data in addition to information on budgets, reserved instances and marketplace charges.</span></span> <span data-ttu-id="adfdd-392">这些 API 仅适用于企业许可登记表和某些 Web Direct 订阅，但是借助它们可将成本数据集成到自己的工具和数据仓库中。</span><span class="sxs-lookup"><span data-stu-id="adfdd-392">These APIs are accessible only for Enterprise Enrollments and some Web Direct subscriptions however they give you the ability to integrate your cost data into your own tools and data warehouses.</span></span> <span data-ttu-id="adfdd-393">还可使用 Azure CLI 访问这些 API，见[此处](/cli/azure/consumption?view=azure-cli-latest)。</span><span class="sxs-lookup"><span data-stu-id="adfdd-393">You can also access these APIs by using the Azure CLI, seen [here](/cli/azure/consumption?view=azure-cli-latest).</span></span>

<span data-ttu-id="adfdd-394">我们纵观长期使用云并可“熟练”使用云的客户时，发现了一些强烈推荐的做法</span><span class="sxs-lookup"><span data-stu-id="adfdd-394">When we look across customers who have used the cloud for a long time and are "mature" in their use, we see a number of highly recommended practices</span></span>

* <span data-ttu-id="adfdd-395">**主动监视成本**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-395">**Actively monitor costs**.</span></span> <span data-ttu-id="adfdd-396">熟练 Azure 用户的组织会不断监视成本，并在需要采取措施。</span><span class="sxs-lookup"><span data-stu-id="adfdd-396">Organizations that are mature Azure users constantly monitor costs and take actions when needed.</span></span> <span data-ttu-id="adfdd-397">某些组织甚至派人专门进行分析并对使用情况的更改提出建议，当这些人员首次找到已运行数月的未使用的 HDInsight 群集时，即可收回成本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-397">Some organizations even dedicate people to do analysis and suggest changes to usage, and these people more than pay for themselves the first time they find an unused HDInsight cluster that's been running for months.</span></span>
* <span data-ttu-id="adfdd-398">**使用预留实例**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-398">**Use Reserved Instances**.</span></span> <span data-ttu-id="adfdd-399">管理云中成本的另一个关键租户是使用合适的工具来完成作业。</span><span class="sxs-lookup"><span data-stu-id="adfdd-399">Another key tenant for managing costs in the cloud is to use the right tool for the job.</span></span> <span data-ttu-id="adfdd-400">如果 IaaS VM 必须全天候运行，那么使用预留实例将能够节省大量资金。</span><span class="sxs-lookup"><span data-stu-id="adfdd-400">If you have an IaaS VM that must stay on 24x7, then using a Reserved Instance will save you significant money.</span></span> <span data-ttu-id="adfdd-401">权衡自动关闭 VM 和使用 RI 需要经验和分析。</span><span class="sxs-lookup"><span data-stu-id="adfdd-401">Finding the right balance between automating the shutdown of VMs and using RIs takes experience and analysis.</span></span>
* <span data-ttu-id="adfdd-402">**有效地使用自动化**：许多工作负荷无需每天运行。</span><span class="sxs-lookup"><span data-stu-id="adfdd-402">**Use automation effectively**: Many workloads do not need to be running every day.</span></span> <span data-ttu-id="adfdd-403">即使每天将 VM 关闭 4 小时也可节省 15% 的成本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-403">Even turning off a VM for a 4-hour period every day can save you 15% of your cost.</span></span> <span data-ttu-id="adfdd-404">自动化将很快收回成本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-404">Automation will pay for itself quickly.</span></span>
* <span data-ttu-id="adfdd-405">**使用资源标记来提高可见性**：如本文档其他部分所述，使用资源标记可更好地分析成本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-405">**Use resource tags for visibility**: As mentioned elsewhere in this document, using resource tags will allow for better analysis of costs.</span></span>

<span data-ttu-id="adfdd-406">成本管理是有效且高效运行公有云的核心策略。</span><span class="sxs-lookup"><span data-stu-id="adfdd-406">Cost management is a discipline that is core to the effective and efficient running of a public cloud.</span></span> <span data-ttu-id="adfdd-407">成功的企业能够控制成本，使成本与实际需求相匹配，而不是过度购买和希望出现需求。</span><span class="sxs-lookup"><span data-stu-id="adfdd-407">Enterprises that achieve success will be able to control their costs and match them to their actual demand as opposed to overbuying and hoping demand comes.</span></span>

## <a name="automate"></a><span data-ttu-id="adfdd-408">自动化</span><span class="sxs-lookup"><span data-stu-id="adfdd-408">Automate</span></span>

<span data-ttu-id="adfdd-409">区分使用云提供程序组织成熟度的其中一项功能是其所包含的自动化水平。</span><span class="sxs-lookup"><span data-stu-id="adfdd-409">One of the many capabilities that differentiates the maturity of organizations using cloud providers is the level of automation that they have incorporated.</span></span>  <span data-ttu-id="adfdd-410">自动化是永无止境的过程，随着组织迁移到云，需要投入资源和时间进行构建。</span><span class="sxs-lookup"><span data-stu-id="adfdd-410">Automation is a never-ending process and as your organization moves to the cloud it is any area that you need to invest resources and time in building.</span></span>  <span data-ttu-id="adfdd-411">自动化有许多用途，包括一致地推出资源（其中自动化直接与另一个核心基架概念模板和 DevOps 相关联）以解决问题。</span><span class="sxs-lookup"><span data-stu-id="adfdd-411">Automation serves many purposes including consistent rollout of resources (where it ties directly to another core scaffold concept, Templates & DevOps) to the remediation of issues.</span></span>  <span data-ttu-id="adfdd-412">自动化是 Azure 基架的“连接组织”，将每个区域链接在一起。</span><span class="sxs-lookup"><span data-stu-id="adfdd-412">Automation is the "connective tissue" of the Azure scaffold and links each area together.</span></span>

<span data-ttu-id="adfdd-413">构建此功能时，可使用多种工具，第一方工具（如 Azure 自动化、EventGrid 和 AzureCLI）和大量第三方工具（如 Terraform、Jenkins、Chef 和 Puppet）（仅举几例）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-413">There are a number of tools that are available as you build out this capability, from first party tools such as Azure Automation, EventGrid and AzureCLI to an extensive amount of third party tools such as Terraform, Jenkins, Chef, and Puppet (to name a few).</span></span> <span data-ttu-id="adfdd-414">操作团队自动化功能的核心是 Azure 自动化、事件网格和 Azure Cloud Shell：</span><span class="sxs-lookup"><span data-stu-id="adfdd-414">Core to your operations team ability to automate are Azure Automation, Event Grid and the Azure Cloud Shell:</span></span>

* <span data-ttu-id="adfdd-415">**Azure 自动化**：是一种基于云的功能，可用于创建 Runbook（在 PowerShell 或 Python 中），并可用于自动化进程、配置资源，甚至应用修补程序。</span><span class="sxs-lookup"><span data-stu-id="adfdd-415">**Azure Automation**: Is a cloud-based capability that allows to you author Runbooks (in either PowerShell or Python) and allows you automate processes, configure resources, and even apply patches.</span></span>  <span data-ttu-id="adfdd-416">[Azure 自动化](/azure/automation/automation-intro)具有广泛的跨平台功能，这些功能对部署来说不可或缺，但是过于广泛，在此不进行深入介绍。</span><span class="sxs-lookup"><span data-stu-id="adfdd-416">[Azure Automation](/azure/automation/automation-intro) has an extensive set of cross platform capabilities that are integral to your deployment but are too extensive to be covered in depth here.</span></span>
* <span data-ttu-id="adfdd-417">**事件网格**：此[服务](/azure/event-grid)是一个完全托管的事件路由系统，可让你对 Azure 环境中的事件做出反应。</span><span class="sxs-lookup"><span data-stu-id="adfdd-417">**Event Grid**: this [service](/azure/event-grid) is a fully-managed event routing system that let's you react to events within your Azure environment.</span></span> <span data-ttu-id="adfdd-418">正如自动化是成熟云组织的结缔组织，事件网格是良好自动化的结缔组织。</span><span class="sxs-lookup"><span data-stu-id="adfdd-418">Like Automation is the connective tissue of mature cloud organizations, Event Grid is the connective tissue of good automation.</span></span> <span data-ttu-id="adfdd-419">使用事件网格，可创建简单的无服务器操作，以便在创建新资源时向管理员发送电子邮件，并将该资源记录在数据库中。</span><span class="sxs-lookup"><span data-stu-id="adfdd-419">Using Event Grid, you can create a simple, serverless, action to send an email to an administrator whenever a new resource is created and log that resource in a database.</span></span> <span data-ttu-id="adfdd-420">相同的事件网格可在删除资源时通知，并从数据库中删除该项。</span><span class="sxs-lookup"><span data-stu-id="adfdd-420">That same Event Grid can notify when a resource is deleted and remove the item from the database.</span></span>
* <span data-ttu-id="adfdd-421">**Azure Cloud Shell**：是一个基于浏览器的交互式 [shell](/azure/cloud-shell/overview)，用于管理 Azure 中的资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-421">**Azure Cloud Shell**: is an interactive, browser-based [shell](/azure/cloud-shell/overview) for managing resources in Azure.</span></span> <span data-ttu-id="adfdd-422">它为 PowerShell 或 Bash 提供了完整的环境，可根据需要启动（并代为维护），以便拥有一致的环境来运行脚本。</span><span class="sxs-lookup"><span data-stu-id="adfdd-422">It provides a complete environment for either PowerShell or Bash that is launched as needed (and maintained for you) so that you have a consistent environment from which to run your scripts.</span></span> <span data-ttu-id="adfdd-423">Azure Cloud Shell 提供了对已安装其他关键工具的访问，以便自动化环境，包括 [Azure CLI](/cli/azure/get-started-with-azure-cli?view=azure-cli-latest)、[Terraform](/azure/virtual-machines/linux/terraform-install-configure) 和越来越多的用于管理容器、数据库 (sqlcmd) 等的其他[工具](https://azure.microsoft.com/updates/cloud-shell-new-cli-tools-and-font-size-selection/)。</span><span class="sxs-lookup"><span data-stu-id="adfdd-423">The Azure Cloud Shell provides access to additional key tools -already installed-- to automate your environment including [Azure CLI](/cli/azure/get-started-with-azure-cli?view=azure-cli-latest), [Terraform](/azure/virtual-machines/linux/terraform-install-configure) and a growing list of additional [tools](https://azure.microsoft.com/updates/cloud-shell-new-cli-tools-and-font-size-selection/) to manage containers, databases (sqlcmd) and more.</span></span>

<span data-ttu-id="adfdd-424">自动化是一项全职工作，它将迅速成为云团队中最重要的操作任务之一。</span><span class="sxs-lookup"><span data-stu-id="adfdd-424">Automation is a full-time job and it will rapidly become one of the most important operational tasks within your cloud team.</span></span> <span data-ttu-id="adfdd-425">采用“自动化优先”方法的组织在使用 Azure 方面取得了更大的成功：</span><span class="sxs-lookup"><span data-stu-id="adfdd-425">Organizations that take the approach of "automate first" have greater success in using Azure:</span></span>

* <span data-ttu-id="adfdd-426">管理成本：积极寻找机会并创建自动化以重新调整资源大小，增加/减少和关闭未使用的资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-426">Managing costs: actively seeking opportunities and creating automation to re-size resources, scale-up/down and turn off unused resources.</span></span>
* <span data-ttu-id="adfdd-427">操作灵活性：使用自动化（以及模板和 DevOps），可获得一定程度的可重复性，从而提高可用性、增强安全性并使团队可专注于解决业务问题。</span><span class="sxs-lookup"><span data-stu-id="adfdd-427">Operational flexibility: through the use of automation (along with Templates and DevOps) you gain a level of repeatability that increases availability, increases security and enables your team to focus on solving business problems.</span></span>

## <a name="templates-and-devops"></a><span data-ttu-id="adfdd-428">模板和 DevOps</span><span class="sxs-lookup"><span data-stu-id="adfdd-428">Templates and DevOps</span></span>

<span data-ttu-id="adfdd-429">如“自动化”部分所述，组织的目标应是通过源代码控制的模板和脚本预配资源，并最大限度地减少环境的交互配置。</span><span class="sxs-lookup"><span data-stu-id="adfdd-429">As highlighted in the Automate section, your goal as an organization should be to provision resources through source-controlled templates and scripts and to minimize interactive configuration of your environments.</span></span> <span data-ttu-id="adfdd-430">这种“基础结构即代码”的方法，以及用于持续部署的规范 DevOps 进程，可确保一致性并减少环境间的偏差。</span><span class="sxs-lookup"><span data-stu-id="adfdd-430">This approach of "infrastructure as code" along with a disciplined DevOps process for continuous deployment can ensure consistency and reduce drift across your environments.</span></span> <span data-ttu-id="adfdd-431">几乎所有 Azure 资源都可通过 [Azure 资源管理器 (ARM) JSON 模板](/azure/azure-resource-manager/resource-group-template-deploy)与 PowerShell 或 Azure 跨平台 CLI 和工具（如 Hashicorp 的 Terraform，该公司提供一流支持并集成到 Azure Cloud Shell 中）部署。</span><span class="sxs-lookup"><span data-stu-id="adfdd-431">Almost every Azure resource is deployable through [Azure Resource Manager (ARM) JSON templates](/azure/azure-resource-manager/resource-group-template-deploy) in conjunction with PowerShell or the Azure cross platform CLI and tools such as Terraform from Hashicorp (which has first class support and integrated into the Azure Cloud Shell).</span></span>

<span data-ttu-id="adfdd-432">[本文](https://blogs.msdn.microsoft.com/mvpawardprogram/2018/05/01/azure-resource-manager/)等文章提供了有关使用 [Azure DevOps](/azure/devops/user-guide/?view=vsts) 工具链将 DevOps 方法应用于 ARM 模板的最佳做法和经验教训的精彩讨论。</span><span class="sxs-lookup"><span data-stu-id="adfdd-432">Article such as [this one](https://blogs.msdn.microsoft.com/mvpawardprogram/2018/05/01/azure-resource-manager/) provide an excellent discussion on best practices and lessons learned in applying a DevOps approach to ARM templates with the [Azure DevOps](/azure/devops/user-guide/?view=vsts) tool chain.</span></span> <span data-ttu-id="adfdd-433">花费时间和精力开发一套特定于组织需求的核心模板，并利用 DevOps 工具链（Azure DevOps、Jenkins、Bamboo、Teamcity、Concourse）开发持续交付管道，专门用于生产和 QA 环境。</span><span class="sxs-lookup"><span data-stu-id="adfdd-433">Take the time and effort to develop a core set of templates specific to your organization's requirements, and to develop continuous delivery pipelines with DevOps tool chains (Azure DevOps, Jenkins, Bamboo, Teamcity, Concourse), especially for your production and QA environments.</span></span> <span data-ttu-id="adfdd-434">GitHub 上有一个大型的 [Azure 快速入门模板](https://github.com/Azure/azure-quickstart-templates)库，可将其用作模板的起点，并且可使用 Azure DevOps 快速创建基于云的交付管道。</span><span class="sxs-lookup"><span data-stu-id="adfdd-434">There is a large library of [Azure Quick Start templates](https://github.com/Azure/azure-quickstart-templates) on GitHub that you can use as a starting point for templates, and you can quickly create cloud-based delivery pipelines with Azure DevOps.</span></span>

<span data-ttu-id="adfdd-435">作为生产订阅或资源组的最佳做法，目标应该是利用 RBAC 安全性来默认禁用交互用户，以及利用基于服务主体的自动持续交付管道来预配所有资源，并提供所有应用程序代码。</span><span class="sxs-lookup"><span data-stu-id="adfdd-435">As a best practice for production subscriptions or resource groups, your goal should be utilizing RBAC security to disallow interactive users by default and utilizing automated continuous delivery pipelines based on service principals to provision all resources and deliver all application code.</span></span> <span data-ttu-id="adfdd-436">任何管理员或开发人员都不应使用 Azure 门户以交互方式配置资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-436">No admin or developer should touch the Azure Portal to interactively configure resources.</span></span> <span data-ttu-id="adfdd-437">此级别的 DevOps 需要协同努力，并利用 Azure 基架的所有概念，可提供一个一致且更安全的环境，以满足组织扩大规模的需求。</span><span class="sxs-lookup"><span data-stu-id="adfdd-437">This level of DevOps takes a concerted effort and utilizes all the concepts of the Azure scaffold and provides a consistent and more secure environment that will meet your organizations to grow scale.</span></span>

> [!TIP]
> <span data-ttu-id="adfdd-438">设计和开发复杂的 ARM 模板时，使用[已链接模板](/azure/azure-resource-manager/resource-group-linked-templates)来整理和重构单个 JSON 文件的复杂资源关系。</span><span class="sxs-lookup"><span data-stu-id="adfdd-438">When designing and developing complex ARM templates, use [linked templates](/azure/azure-resource-manager/resource-group-linked-templates) to organize and refactor complex resource relationships from monolithic JSON files.</span></span> <span data-ttu-id="adfdd-439">这样操作便可单独管理资源，让模板更具可读性、可测试性和可重用性。</span><span class="sxs-lookup"><span data-stu-id="adfdd-439">This will enable you to manage resources individually and make your templates more readable, testable and reusable.</span></span>

<span data-ttu-id="adfdd-440">Azure 是一个超大规模的云提供商，将组织从本地服务器转移到云环境时，利用云提供商和 SaaS 应用程序所使用的相同概念将为组织提供更高效的方式，以应对业务需求。</span><span class="sxs-lookup"><span data-stu-id="adfdd-440">Azure is a hyper scale cloud provider and as you move your organization from the world of on-premises servers to the cloud, utilizing the same concepts that cloud providers and SaaS applications use will provide your organization to react to the needs of the business in vastly more efficient way.</span></span>

## <a name="core-network"></a><span data-ttu-id="adfdd-441">核心网络</span><span class="sxs-lookup"><span data-stu-id="adfdd-441">Core network</span></span>

<span data-ttu-id="adfdd-442">Azure 基架参考模型的最后一个组件是贵组织如何以安全的方式访问 Azure 的核心。</span><span class="sxs-lookup"><span data-stu-id="adfdd-442">The final component of the Azure scaffold reference model is core to how your organization accesses Azure, in a secure manner.</span></span> <span data-ttu-id="adfdd-443">对资源的访问可能是从内部（在企业网络中）或外部（通过 Internet）发起的。</span><span class="sxs-lookup"><span data-stu-id="adfdd-443">Access to resources can be either internal (within the corporation's network) or external (through the internet).</span></span> <span data-ttu-id="adfdd-444">组织中的用户经常会无意中将资源放在错误的位置，使其遭到恶意访问。</span><span class="sxs-lookup"><span data-stu-id="adfdd-444">It is easy for users in your organization to inadvertently put resources in the wrong spot, and potentially open them to malicious access.</span></span> <span data-ttu-id="adfdd-445">与对待本地设备一样，企业必须增设相应的控制机制，确保 Azure 用户做出正确的决策。</span><span class="sxs-lookup"><span data-stu-id="adfdd-445">As with on-premises devices, enterprises must add appropriate controls to ensure that Azure users make the right decisions.</span></span> <span data-ttu-id="adfdd-446">为了进行订阅监管，我们指定了可提供基本访问控制的核心资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-446">For subscription governance, we identify core resources that provide basic control of access.</span></span> <span data-ttu-id="adfdd-447">这些核心资源包括：</span><span class="sxs-lookup"><span data-stu-id="adfdd-447">The core resources consist of:</span></span>

* <span data-ttu-id="adfdd-448">**虚拟网络**是子网的容器对象。</span><span class="sxs-lookup"><span data-stu-id="adfdd-448">**Virtual networks** are container objects for subnets.</span></span> <span data-ttu-id="adfdd-449">尽管严格意义上没有必要，但将应用程序连接到内部企业资源时往往要用到它。</span><span class="sxs-lookup"><span data-stu-id="adfdd-449">Though not strictly necessary, it is often used when connecting applications to internal corporate resources.</span></span>
* <span data-ttu-id="adfdd-450">**用户定义的路由**使你可操作子网内的路由表，从而可通过网络虚拟设备或对等虚拟网络上的远程网关发送流量。</span><span class="sxs-lookup"><span data-stu-id="adfdd-450">**User Defined Routes** allow you to manipulate the route table within a subnet enabling you to send traffic through a network virtual appliance or to a remote gateway on a peered virtual network.</span></span>
* <span data-ttu-id="adfdd-451">**虚拟网络对等互连**使你可无缝连接两个或多个 Azure 虚拟网络，从而创建更复杂的中心和辐射设计或共享服务网络。</span><span class="sxs-lookup"><span data-stu-id="adfdd-451">**Virtual Network Peering** enables you to seamlessly connect two or more Azure virtual networks, creating more complex hub & spoke designs or shared services networks.</span></span>
* <span data-ttu-id="adfdd-452">**服务终结点**。</span><span class="sxs-lookup"><span data-stu-id="adfdd-452">**Service Endpoints**.</span></span> <span data-ttu-id="adfdd-453">过去，PaaS 服务依靠不同的方法来确保从虚拟网络访问这些资源。</span><span class="sxs-lookup"><span data-stu-id="adfdd-453">In the past, PaaS services relied on different methods to secure access to those resources from your virtual networks.</span></span> <span data-ttu-id="adfdd-454">服务终结点允许仅从连接的端点安全访问已启用的 PaaS 服务，提高了整体安全性。</span><span class="sxs-lookup"><span data-stu-id="adfdd-454">Service endpoints allow you to secure access to enabled PaaS services from ONLY connected endpoints, increasing overall security.</span></span>
* <span data-ttu-id="adfdd-455">**安全组**是一组广泛的规则，通过安全组可允许或拒绝进/出 Azure 资源的入站和出站流量。</span><span class="sxs-lookup"><span data-stu-id="adfdd-455">**Security groups** are an extensive set of rules which provide you the ability to allow or deny inbound and outbound traffic to/from Azure Resources.</span></span> <span data-ttu-id="adfdd-456">[安全组](/azure/virtual-network/security-overview)由安全规则组成，可使用“服务标记”（定义常见 Azure 服务，如 AzureKeyVault、Sql 等）和“应用程序组”（定义应用程序结构，如 WebServers、AppServers 等）进行扩充</span><span class="sxs-lookup"><span data-stu-id="adfdd-456">[Security Groups](/azure/virtual-network/security-overview) consist of Security Rules, which can be augmented with **Service Tags** (which define common Azure services such as AzureKeyVault, Sql and others) and **Application Groups** (which define and application structure, such as WebServers, AppServers and such)</span></span>

> [!TIP]
> <span data-ttu-id="adfdd-457">在网络安全组中使用服务标记和应用程序组，不仅可增强规则的可读性（这对理解的影响至关重要），还可在更大的子网内实现有效的微型分段，从而减少扩展并提高灵活性。</span><span class="sxs-lookup"><span data-stu-id="adfdd-457">Use Service tags and Application groups in your network security groups to not only enhance the readability of your rules -which is crucial to understanding impact- but also to enable effective micro-segmentation within a larger subnet, reducing sprawl and increasing flexibility.</span></span>

### <a name="virtual-data-center"></a><span data-ttu-id="adfdd-458">虚拟数据中心</span><span class="sxs-lookup"><span data-stu-id="adfdd-458">Virtual Data Center</span></span>

<span data-ttu-id="adfdd-459">Azure 通过我们广泛的合作伙伴网络提供了内部功能和第三方功能，使你拥有有效的安全状态。</span><span class="sxs-lookup"><span data-stu-id="adfdd-459">Azure provides you both internal capabilities and third-party capabilities from our extensive partner network that enable you to have an effective security stance.</span></span> <span data-ttu-id="adfdd-460">更重要的是，Microsoft 以 [Azure 虚拟数据中心](/azure/architecture/vdc/networking-virtual-datacenter)的形式提供了最佳做法和指导。</span><span class="sxs-lookup"><span data-stu-id="adfdd-460">More importantly, Microsoft provides best practices and guidance in the form of the [Azure Virtual Data Center](/azure/architecture/vdc/networking-virtual-datacenter).</span></span> <span data-ttu-id="adfdd-461">从单个工作负载转向利用混合功能的多个工作负载时，VDC 指导会提供“窍门”，以便提供随 Azure 中工作负载的增长而增长的灵活网络。</span><span class="sxs-lookup"><span data-stu-id="adfdd-461">As you move from a single workload to multiple workloads which leverage hybrid capabilities, the VDC guidance will provide you with "recipe" to enable a flexible, network that will grow as your workloads in Azure grow.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="adfdd-462">后续步骤</span><span class="sxs-lookup"><span data-stu-id="adfdd-462">Next steps</span></span>

<span data-ttu-id="adfdd-463">监管对于 Azure 的成功至关重要。</span><span class="sxs-lookup"><span data-stu-id="adfdd-463">Governance is crucial to the success of Azure.</span></span> <span data-ttu-id="adfdd-464">本文阐述企业基架的技术实现，不过，对于宏观的流程以及组件之间的关系，只是一笔带过。</span><span class="sxs-lookup"><span data-stu-id="adfdd-464">This article targets the technical implementation of an enterprise scaffold but only touches on the broader process and relationships between the components.</span></span> <span data-ttu-id="adfdd-465">策略监管的流程是自顶向下实施的，由企业的目标决定。</span><span class="sxs-lookup"><span data-stu-id="adfdd-465">Policy governance flows from the top down and is determined by what the business wants to achieve.</span></span> <span data-ttu-id="adfdd-466">为 Azure 创建的监管模型自然包括 IT 部门的主张，但更重要的是，它应该融入业务小组负责人以及安全和风险管理部门的有力表述。</span><span class="sxs-lookup"><span data-stu-id="adfdd-466">Naturally, the creation of a governance model for Azure includes representatives from IT, but more importantly it should have strong representation from business group leaders, and security and risk management.</span></span> <span data-ttu-id="adfdd-467">最后，企业基架旨在降低业务风险，帮助实现组织的使命和目标</span><span class="sxs-lookup"><span data-stu-id="adfdd-467">In the end, an enterprise scaffold is about mitigating business risk to facilitate an organization's mission and objectives</span></span>

<span data-ttu-id="adfdd-468">了解订阅监管后，接下来可以了解如何实施这些建议。</span><span class="sxs-lookup"><span data-stu-id="adfdd-468">Now that you have learned about subscription governance, it's time to see these recommendations in practice.</span></span> <span data-ttu-id="adfdd-469">请参阅 [Examples of implementing Azure subscription governance](azure-scaffold-examples.md)（Azure 订阅监管实施示例）。</span><span class="sxs-lookup"><span data-stu-id="adfdd-469">See [Examples of implementing Azure subscription governance](azure-scaffold-examples.md).</span></span>
