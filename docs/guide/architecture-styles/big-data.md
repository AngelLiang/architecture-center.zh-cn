---
title: 大数据体系结构样式
titleSuffix: Azure Application Architecture Guide
description: 介绍 Azure 上大数据体系结构的优点、挑战和最佳做法。
author: MikeWasson
ms.date: 08/30/2018
ms.topic: guide
ms.service: architecture-center
ms.subservice: reference-architecture
ms.custom: seojan19, IoT
ms.openlocfilehash: 07fb955fdc5475020097554070753689d1515462
ms.sourcegitcommit: 1b50810208354577b00e89e5c031b774b02736e2
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/23/2019
ms.locfileid: "54488012"
---
# <a name="big-data-architecture-style"></a><span data-ttu-id="46b0f-103">大数据体系结构样式</span><span class="sxs-lookup"><span data-stu-id="46b0f-103">Big data architecture style</span></span>

<span data-ttu-id="46b0f-104">大数据架构设计用来处理对传统数据库系统而言太大或太复杂的数据的引入、处理和分析。</span><span class="sxs-lookup"><span data-stu-id="46b0f-104">A big data architecture is designed to handle the ingestion, processing, and analysis of data that is too large or complex for traditional database systems.</span></span>

![大数据体系结构样式的逻辑图](./images/big-data-logical.svg)

<span data-ttu-id="46b0f-106">大数据解决方案通常涉及一个或多个以下类型的工作负荷：</span><span class="sxs-lookup"><span data-stu-id="46b0f-106">Big data solutions typically involve one or more of the following types of workload:</span></span>

- <span data-ttu-id="46b0f-107">静态大数据源的批处理。</span><span class="sxs-lookup"><span data-stu-id="46b0f-107">Batch processing of big data sources at rest.</span></span>
- <span data-ttu-id="46b0f-108">移动中的大数据的实时处理。</span><span class="sxs-lookup"><span data-stu-id="46b0f-108">Real-time processing of big data in motion.</span></span>
- <span data-ttu-id="46b0f-109">大数据的交互式浏览。</span><span class="sxs-lookup"><span data-stu-id="46b0f-109">Interactive exploration of big data.</span></span>
- <span data-ttu-id="46b0f-110">预测分析和机器学习。</span><span class="sxs-lookup"><span data-stu-id="46b0f-110">Predictive analytics and machine learning.</span></span>

<span data-ttu-id="46b0f-111">大多数大数据架构都包括下列组件中的一些或全部：</span><span class="sxs-lookup"><span data-stu-id="46b0f-111">Most big data architectures include some or all of the following components:</span></span>

- <span data-ttu-id="46b0f-112">**数据源**：所有大数据解决方案一开始都有一个或多个数据源。</span><span class="sxs-lookup"><span data-stu-id="46b0f-112">**Data sources**: All big data solutions start with one or more data sources.</span></span> <span data-ttu-id="46b0f-113">示例包括：</span><span class="sxs-lookup"><span data-stu-id="46b0f-113">Examples include:</span></span>

  - <span data-ttu-id="46b0f-114">应用程序数据存储，例如关系数据库。</span><span class="sxs-lookup"><span data-stu-id="46b0f-114">Application data stores, such as relational databases.</span></span>
  - <span data-ttu-id="46b0f-115">应用程序生成的静态文件，例如 Web 服务器日志文件。</span><span class="sxs-lookup"><span data-stu-id="46b0f-115">Static files produced by applications, such as web server log files.</span></span>
  - <span data-ttu-id="46b0f-116">实时数据源，例如 IoT 设备。</span><span class="sxs-lookup"><span data-stu-id="46b0f-116">Real-time data sources, such as IoT devices.</span></span>

- <span data-ttu-id="46b0f-117">**数据存储**：用于批处理操作的数据通常存储在分布式文件存储中，该存储可以容纳大量各种格式的大型文件。</span><span class="sxs-lookup"><span data-stu-id="46b0f-117">**Data storage**: Data for batch processing operations is typically stored in a distributed file store that can hold high volumes of large files in various formats.</span></span> <span data-ttu-id="46b0f-118">这类存储通常称为 *Data Lake*。</span><span class="sxs-lookup"><span data-stu-id="46b0f-118">This kind of store is often called a *data lake*.</span></span> <span data-ttu-id="46b0f-119">用于实现此存储的选项包括 Azure Data Lake Store 和 Azure 存储中的 blob 容器。</span><span class="sxs-lookup"><span data-stu-id="46b0f-119">Options for implementing this storage include Azure Data Lake Store or blob containers in Azure Storage.</span></span>

- <span data-ttu-id="46b0f-120">**批处理**：由于数据集很大，因此大数据解决方案通常必须使用长时间运行的批处理作业来处理数据文件，以便筛选、聚合和准备用于分析的数据。</span><span class="sxs-lookup"><span data-stu-id="46b0f-120">**Batch processing**: Because the data sets are so large, often a big data solution must process data files using long-running batch jobs to filter, aggregate, and otherwise prepare the data for analysis.</span></span> <span data-ttu-id="46b0f-121">这些作业通常涉及读取源文件、对它们进行处理，以及将输出写入到新文件。</span><span class="sxs-lookup"><span data-stu-id="46b0f-121">Usually these jobs involve reading source files, processing them, and writing the output to new files.</span></span> <span data-ttu-id="46b0f-122">选项包括在 Azure Data Lake Analytics 中运行 U-SQL 作业，在 HDInsight Hadoop 群集中使用 Hive、Pig 或自定义 Map/Reduce 作业，或者在 HDInsight Spark 群集中使用 Java、Scala 或 Python 程序。</span><span class="sxs-lookup"><span data-stu-id="46b0f-122">Options include running U-SQL jobs in Azure Data Lake Analytics, using Hive, Pig, or custom Map/Reduce jobs in an HDInsight Hadoop cluster, or using Java, Scala, or Python programs in an HDInsight Spark cluster.</span></span>

- <span data-ttu-id="46b0f-123">**实时消息引入**：如果解决方案包括实时源，则架构必须包括一种方法来捕获并存储进行流处理的实时消息。</span><span class="sxs-lookup"><span data-stu-id="46b0f-123">**Real-time message ingestion**: If the solution includes real-time sources, the architecture must include a way to capture and store real-time messages for stream processing.</span></span> <span data-ttu-id="46b0f-124">这可以是一个简单的数据存储，将在其中将传入消息放置在一个文件夹中以进行处理。</span><span class="sxs-lookup"><span data-stu-id="46b0f-124">This might be a simple data store, where incoming messages are dropped into a folder for processing.</span></span> <span data-ttu-id="46b0f-125">不过，许多解决方案都需要一个消息引入存储来充当消息缓冲区，以及支持横向扩展处理、可靠传递和其他消息队列语义。</span><span class="sxs-lookup"><span data-stu-id="46b0f-125">However, many solutions need a message ingestion store to act as a buffer for messages, and to support scale-out processing, reliable delivery, and other message queuing semantics.</span></span> <span data-ttu-id="46b0f-126">选项包括 Azure 事件中心、Azure IoT 中心和 Kafka。</span><span class="sxs-lookup"><span data-stu-id="46b0f-126">Options include Azure Event Hubs, Azure IoT Hubs, and Kafka.</span></span>

- <span data-ttu-id="46b0f-127">**流处理**：捕获实时消息后，解决方案必须通过筛选、聚合以及准备用于分析的数据来处理消息。</span><span class="sxs-lookup"><span data-stu-id="46b0f-127">**Stream processing**: After capturing real-time messages, the solution must process them by filtering, aggregating, and otherwise preparing the data for analysis.</span></span> <span data-ttu-id="46b0f-128">然后，会将处理后的流数据写入到输出接收器。</span><span class="sxs-lookup"><span data-stu-id="46b0f-128">The processed stream data is then written to an output sink.</span></span> <span data-ttu-id="46b0f-129">Azure 流分析基于不断运行的 SQL 查询提供托管流处理服务，这些查询对无限的流进行操作。</span><span class="sxs-lookup"><span data-stu-id="46b0f-129">Azure Stream Analytics provides a managed stream processing service based on perpetually running SQL queries that operate on unbounded streams.</span></span> <span data-ttu-id="46b0f-130">还可以在 HDInsight 群集中使用开源 Apache 流式处理技术，例如 Storm 和 Spark 流式处理。</span><span class="sxs-lookup"><span data-stu-id="46b0f-130">You can also use open source Apache streaming technologies like Storm and Spark Streaming in an HDInsight cluster.</span></span>

- <span data-ttu-id="46b0f-131">**分析数据存储**：许多大数据解决方案会先准备用于分析的数据，然后以结构化格式提供已处理的数据供分析工具查询。</span><span class="sxs-lookup"><span data-stu-id="46b0f-131">**Analytical data store**: Many big data solutions prepare data for analysis and then serve the processed data in a structured format that can be queried using analytical tools.</span></span> <span data-ttu-id="46b0f-132">如大多数传统业务智能 (BI) 解决方案中所见，用来为这些查询提供服务的分析数据存储可以是 Kimball 样式的关系数据仓库。</span><span class="sxs-lookup"><span data-stu-id="46b0f-132">The analytical data store used to serve these queries can be a Kimball-style relational data warehouse, as seen in most traditional business intelligence (BI) solutions.</span></span> <span data-ttu-id="46b0f-133">或者，数据也可以通过低延迟 NoSQL 技术（如 HBase）或 Interactive Hive 数据库中呈现，该数据库提供分布式数据存储中数据文件的元数据抽象。</span><span class="sxs-lookup"><span data-stu-id="46b0f-133">Alternatively, the data could be presented through a low-latency NoSQL technology such as HBase, or an interactive Hive database that provides a metadata abstraction over data files in the distributed data store.</span></span> <span data-ttu-id="46b0f-134">Azure SQL 数据仓库为大规模、基于云的数据仓库提供托管服务。</span><span class="sxs-lookup"><span data-stu-id="46b0f-134">Azure SQL Data Warehouse provides a managed service for large-scale, cloud-based data warehousing.</span></span> <span data-ttu-id="46b0f-135">HDInsight 支持 Interactive Hive、HBase 和 Spark SQL，它们还可以用于提供数据以进行分析。</span><span class="sxs-lookup"><span data-stu-id="46b0f-135">HDInsight supports Interactive Hive, HBase, and Spark SQL, which can also be used to serve data for analysis.</span></span>

- <span data-ttu-id="46b0f-136">**分析和报告**：大多数大数据解决方案的目的是通过分析和报告提供对数据的见解。</span><span class="sxs-lookup"><span data-stu-id="46b0f-136">**Analysis and reporting**: The goal of most big data solutions is to provide insights into the data through analysis and reporting.</span></span> <span data-ttu-id="46b0f-137">若要使用户能够对数据进行分析，架构可以包括一个数据建模层，例如 Azure Analysis Services 中的多维 OLAP 多维数据集或表格数据模型。 </span><span class="sxs-lookup"><span data-stu-id="46b0f-137">To empower users to analyze the data, the architecture may include a data modeling layer, such as a multidimensional OLAP cube or tabular data model in Azure Analysis Services.</span></span> <span data-ttu-id="46b0f-138">它还可以使用 Microsoft Power BI 或 Microsoft Excel 中的建模和可视化技术支持自助式 BI。</span><span class="sxs-lookup"><span data-stu-id="46b0f-138">It might also support self-service BI, using the modeling and visualization technologies in Microsoft Power BI or Microsoft Excel.</span></span> <span data-ttu-id="46b0f-139">分析和报告还可以采用适用于数据科学家或数据分析人员的交互式数据浏览形式。</span><span class="sxs-lookup"><span data-stu-id="46b0f-139">Analysis and reporting can also take the form of interactive data exploration by data scientists or data analysts.</span></span> <span data-ttu-id="46b0f-140">对于这些方案，许多 Azure 服务都支持分析笔记本（例如 Jupyter），这允许这些用户通过 Python 或 R 利用其现有技能。对于大规模数据浏览，可以使用 Microsoft R Server，可以独立使用，也可以将其与 Spark 一起使用。</span><span class="sxs-lookup"><span data-stu-id="46b0f-140">For these scenarios, many Azure services support analytical notebooks, such as Jupyter, enabling these users to leverage their existing skills with Python or R. For large-scale data exploration, you can use Microsoft R Server, either standalone or with Spark.</span></span>

- <span data-ttu-id="46b0f-141">**业务流程**：大多数大数据解决方案都包括重复的数据处理操作（封装在工作流中），这些操作对源数据进行转换、在多个源和接收器之间移动数据、将已处理的数据加载到分析数据存储中，或者直接将结果推送到报表或仪表板。</span><span class="sxs-lookup"><span data-stu-id="46b0f-141">**Orchestration**: Most big data solutions consist of repeated data processing operations, encapsulated in workflows, that transform source data, move data between multiple sources and sinks, load the processed data into an analytical data store, or push the results straight to a report or dashboard.</span></span> <span data-ttu-id="46b0f-142">若要自动执行这些工作流，可以使用诸如 Azure 数据工厂或 Apache Oozie 和 Sqoop 的业务流程技术。</span><span class="sxs-lookup"><span data-stu-id="46b0f-142">To automate these workflows, you can use an orchestration technology such Azure Data Factory or Apache Oozie and Sqoop.</span></span>

<span data-ttu-id="46b0f-143">Azure 包括了可以在大数据体系结构中使用的许多服务。</span><span class="sxs-lookup"><span data-stu-id="46b0f-143">Azure includes many services that can be used in a big data architecture.</span></span> <span data-ttu-id="46b0f-144">它们大致划分为两个类别：</span><span class="sxs-lookup"><span data-stu-id="46b0f-144">They fall roughly into two categories:</span></span>

- <span data-ttu-id="46b0f-145">托管服务，包括 Azure Data Lake Store、Azure Data Lake Analytics、Azure 数据仓库、Azure 流分析、Azure 事件中心、Azure IoT 中心和 Azure 数据工厂。</span><span class="sxs-lookup"><span data-stu-id="46b0f-145">Managed services, including Azure Data Lake Store, Azure Data Lake Analytics, Azure Data Warehouse, Azure Stream Analytics, Azure Event Hub, Azure IoT Hub, and Azure Data Factory.</span></span>
- <span data-ttu-id="46b0f-146">基于 Apache Hadoop 平台的开源技术，包括 HDFS、HBase、Hive、Pig、Spark、Storm、Oozie、Sqoop 和 Kafka。</span><span class="sxs-lookup"><span data-stu-id="46b0f-146">Open source technologies based on the Apache Hadoop platform, including HDFS, HBase, Hive, Pig, Spark, Storm, Oozie, Sqoop, and Kafka.</span></span> <span data-ttu-id="46b0f-147">这些技术在 Azure HDInsight 服务中的 Azure 上可用。</span><span class="sxs-lookup"><span data-stu-id="46b0f-147">These technologies are available on Azure in the Azure HDInsight service.</span></span>

<span data-ttu-id="46b0f-148">这些选项不是互斥的，并且许多解决方案将开源技术与 Azure 服务组合使用。</span><span class="sxs-lookup"><span data-stu-id="46b0f-148">These options are not mutually exclusive, and many solutions combine open source technologies with Azure services.</span></span>

## <a name="when-to-use-this-architecture"></a><span data-ttu-id="46b0f-149">何时使用此体系结构</span><span class="sxs-lookup"><span data-stu-id="46b0f-149">When to use this architecture</span></span>

<span data-ttu-id="46b0f-150">当具有以下需求时，请考虑使用此体系结构样式：</span><span class="sxs-lookup"><span data-stu-id="46b0f-150">Consider this architecture style when you need to:</span></span>

- <span data-ttu-id="46b0f-151">存储和处理对传统数据库而言数量太大的数据。</span><span class="sxs-lookup"><span data-stu-id="46b0f-151">Store and process data in volumes too large for a traditional database.</span></span>
- <span data-ttu-id="46b0f-152">转换非结构化数据以进行分析和报告。</span><span class="sxs-lookup"><span data-stu-id="46b0f-152">Transform unstructured data for analysis and reporting.</span></span>
- <span data-ttu-id="46b0f-153">实时或者以较低的延迟捕获、处理和分析无限的数据流。</span><span class="sxs-lookup"><span data-stu-id="46b0f-153">Capture, process, and analyze unbounded streams of data in real time, or with low latency.</span></span>
- <span data-ttu-id="46b0f-154">使用 Azure 机器学习或 Microsoft 认知服务。</span><span class="sxs-lookup"><span data-stu-id="46b0f-154">Use Azure Machine Learning or Microsoft Cognitive Services.</span></span>

## <a name="benefits"></a><span data-ttu-id="46b0f-155">优点</span><span class="sxs-lookup"><span data-stu-id="46b0f-155">Benefits</span></span>

- <span data-ttu-id="46b0f-156">**技术选择**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-156">**Technology choices**.</span></span> <span data-ttu-id="46b0f-157">可以在 HDInsight 群集中将 Azure 托管服务和 Apache 技术混搭使用，以利用现有技能或技术投资。</span><span class="sxs-lookup"><span data-stu-id="46b0f-157">You can mix and match Azure managed services and Apache technologies in HDInsight clusters, to capitalize on existing skills or technology investments.</span></span>
- <span data-ttu-id="46b0f-158">**通过并行确保性能**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-158">**Performance through parallelism**.</span></span> <span data-ttu-id="46b0f-159">大数据解决方案利用了并行，从而可以实现扩展到大量数据的高性能解决方案。</span><span class="sxs-lookup"><span data-stu-id="46b0f-159">Big data solutions take advantage of parallelism, enabling high-performance solutions that scale to large volumes of data.</span></span>
- <span data-ttu-id="46b0f-160">**弹性缩放**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-160">**Elastic scale**.</span></span> <span data-ttu-id="46b0f-161">大数据体系结构中的所有组件都支持横向扩展预配，以便你可以调整解决方案来适应小型或大型工作负荷，并且仅为你使用的资源付款。</span><span class="sxs-lookup"><span data-stu-id="46b0f-161">All of the components in the big data architecture support scale-out provisioning, so that you can adjust your solution to small or large workloads, and pay only for the resources that you use.</span></span>
- <span data-ttu-id="46b0f-162">**与现有解决方案的互操作性**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-162">**Interoperability with existing solutions**.</span></span> <span data-ttu-id="46b0f-163">大数据体系结构的组件还用于 IoT 处理和企业 BI 解决方案，使得你可以创建涉及各种数据工作负荷的集成解决方案。</span><span class="sxs-lookup"><span data-stu-id="46b0f-163">The components of the big data architecture are also used for IoT processing and enterprise BI solutions, enabling you to create an integrated solution across data workloads.</span></span>

## <a name="challenges"></a><span data-ttu-id="46b0f-164">挑战</span><span class="sxs-lookup"><span data-stu-id="46b0f-164">Challenges</span></span>

- <span data-ttu-id="46b0f-165">**复杂性**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-165">**Complexity**.</span></span> <span data-ttu-id="46b0f-166">大数据解决方案可能非常复杂，有大量组件用来处理来自多个数据源的数据引入。</span><span class="sxs-lookup"><span data-stu-id="46b0f-166">Big data solutions can be extremely complex, with numerous components to handle data ingestion from multiple data sources.</span></span> <span data-ttu-id="46b0f-167">构建、测试大数据流程以及对其进行故障排除可能比较困难。</span><span class="sxs-lookup"><span data-stu-id="46b0f-167">It can be challenging to build, test, and troubleshoot big data processes.</span></span> <span data-ttu-id="46b0f-168">而且，可能必须在多个系统中使用大量配置设置以优化性能。</span><span class="sxs-lookup"><span data-stu-id="46b0f-168">Moreover, there may be a large number of configuration settings across multiple systems that must be used in order to optimize performance.</span></span>
- <span data-ttu-id="46b0f-169">**技能集**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-169">**Skillset**.</span></span> <span data-ttu-id="46b0f-170">许多大数据技术都是高度专用的，并使用对较一般的应用程序体系结构而言不常见的框架和语言。</span><span class="sxs-lookup"><span data-stu-id="46b0f-170">Many big data technologies are highly specialized, and use frameworks and languages that are not typical of more general application architectures.</span></span> <span data-ttu-id="46b0f-171">另一方面，大数据技术在不断发展基于更成熟语言的新 API。</span><span class="sxs-lookup"><span data-stu-id="46b0f-171">On the other hand, big data technologies are evolving new APIs that build on more established languages.</span></span> <span data-ttu-id="46b0f-172">例如，Azure Data Lake Analytics 中的 U-SQL 语言基于 Transact-SQL 和 C# 的组合。</span><span class="sxs-lookup"><span data-stu-id="46b0f-172">For example, the U-SQL language in Azure Data Lake Analytics is based on a combination of Transact-SQL and C#.</span></span> <span data-ttu-id="46b0f-173">类似地，基于 SQL 的 API 可用于 Hive、HBase 和 Spark。</span><span class="sxs-lookup"><span data-stu-id="46b0f-173">Similarly, SQL-based APIs are available for Hive, HBase, and Spark.</span></span>
- <span data-ttu-id="46b0f-174">**技术成熟度**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-174">**Technology maturity**.</span></span> <span data-ttu-id="46b0f-175">大数据中使用的许多技术在不断发展。</span><span class="sxs-lookup"><span data-stu-id="46b0f-175">Many of the technologies used in big data are evolving.</span></span> <span data-ttu-id="46b0f-176">虽然诸如 Hive 和 Pig 的核心 Hadoop 技术已经稳定，但是诸如 Spark 的新兴技术随每个新版本引入了大量的更改和增强。</span><span class="sxs-lookup"><span data-stu-id="46b0f-176">While core Hadoop technologies such as Hive and Pig have stabilized, emerging technologies such as Spark introduce extensive changes and enhancements with each new release.</span></span> <span data-ttu-id="46b0f-177">与其他 Azure 服务相比，诸如 Azure Data Lake Analytics 和 Azure 数据工厂的托管服务相对年轻，并且可能会随时间发展。</span><span class="sxs-lookup"><span data-stu-id="46b0f-177">Managed services such as Azure Data Lake Analytics and Azure Data Factory are relatively young, compared with other Azure services, and will likely evolve over time.</span></span>
- <span data-ttu-id="46b0f-178">**安全性**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-178">**Security**.</span></span> <span data-ttu-id="46b0f-179">大数据解决方案通常依赖于将所有静态数据存储在一个集中式 Data Lake 中。</span><span class="sxs-lookup"><span data-stu-id="46b0f-179">Big data solutions usually rely on storing all static data in a centralized data lake.</span></span> <span data-ttu-id="46b0f-180">确保对此数据的访问安全可能比较困难，尤其是当必须通过多个应用程序和平台引入和使用数据时。</span><span class="sxs-lookup"><span data-stu-id="46b0f-180">Securing access to this data can be challenging, especially when the data must be ingested and consumed by multiple applications and platforms.</span></span>

## <a name="best-practices"></a><span data-ttu-id="46b0f-181">最佳做法</span><span class="sxs-lookup"><span data-stu-id="46b0f-181">Best practices</span></span>

- <span data-ttu-id="46b0f-182">**利用并行**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-182">**Leverage parallelism**.</span></span> <span data-ttu-id="46b0f-183">大多数大数据处理技术会将工作负荷分布到多个处理单元中。</span><span class="sxs-lookup"><span data-stu-id="46b0f-183">Most big data processing technologies distribute the workload across multiple processing units.</span></span> <span data-ttu-id="46b0f-184">这需要以可拆分格式创建和存储静态数据文件。</span><span class="sxs-lookup"><span data-stu-id="46b0f-184">This requires that static data files are created and stored in a splittable format.</span></span> <span data-ttu-id="46b0f-185">分布式文件系统（例如 HDFS）可以优化读取和写入性能，并且通过多个群集节点并行执行实际处理，这降低了整体作业时间。</span><span class="sxs-lookup"><span data-stu-id="46b0f-185">Distributed file systems such as HDFS can optimize read and write performance, and the actual processing is performed by multiple cluster nodes in parallel, which reduces overall job times.</span></span>

- <span data-ttu-id="46b0f-186">**将数据分区**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-186">**Partition data**.</span></span> <span data-ttu-id="46b0f-187">批处理通常按定期计划进行 &mdash; 例如，每周或每月。</span><span class="sxs-lookup"><span data-stu-id="46b0f-187">Batch processing usually happens on a recurring schedule &mdash; for example, weekly or monthly.</span></span> <span data-ttu-id="46b0f-188">请根据与处理计划匹配的时间期间对数据文件和数据结构（例如表）进行分区。</span><span class="sxs-lookup"><span data-stu-id="46b0f-188">Partition data files, and data structures such as tables, based on temporal periods that match the processing schedule.</span></span> <span data-ttu-id="46b0f-189">这可以简化数据引入和作业计划，并且能够更轻松地排除故障。</span><span class="sxs-lookup"><span data-stu-id="46b0f-189">That simplifies data ingestion and job scheduling, and makes it easier to troubleshoot failures.</span></span> <span data-ttu-id="46b0f-190">另外，对在 Hive、U-SQL 或 SQL 查询中使用的表进行分区可以显著提高查询性能。</span><span class="sxs-lookup"><span data-stu-id="46b0f-190">Also, partitioning tables that are used in Hive, U-SQL, or SQL queries can significantly improve query performance.</span></span>

- <span data-ttu-id="46b0f-191">**应用读取时架构语义**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-191">**Apply schema-on-read semantics**.</span></span> <span data-ttu-id="46b0f-192">使用 Data Lake，可以组合使用多种格式的文件存储，无论是结构化的、半结构化的还是非结构化的。</span><span class="sxs-lookup"><span data-stu-id="46b0f-192">Using a data lake lets you to combine storage for files in multiple formats, whether structured, semi-structured, or unstructured.</span></span> <span data-ttu-id="46b0f-193">使用*读取时架构*语义，这些语义在处理数据时而非存储数据时将架构投射到数据上。</span><span class="sxs-lookup"><span data-stu-id="46b0f-193">Use *schema-on-read* semantics, which project a schema onto the data when the data is processing, not when the data is stored.</span></span> <span data-ttu-id="46b0f-194">这增加了解决方案的灵活性，并且可以防止在数据引入期间由于数据验证和类型检查而导致瓶颈。</span><span class="sxs-lookup"><span data-stu-id="46b0f-194">This builds flexibility into the solution, and prevents bottlenecks during data ingestion caused by data validation and type checking.</span></span>

- <span data-ttu-id="46b0f-195">**就地处理数据**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-195">**Process data in-place**.</span></span> <span data-ttu-id="46b0f-196">传统 BI 解决方案通常使用提取、转换和加载 (ETL) 流程将数据移动到数据仓库。</span><span class="sxs-lookup"><span data-stu-id="46b0f-196">Traditional BI solutions often use an extract, transform, and load (ETL) process to move data into a data warehouse.</span></span> <span data-ttu-id="46b0f-197">大数据解决方案用于处理更大的数据量和更多样化的格式，它们通常使用 ETL 的变体，例如转换、提取和加载 (TEL)。</span><span class="sxs-lookup"><span data-stu-id="46b0f-197">With larger volumes data, and a greater variety of formats, big data solutions generally use variations of ETL, such as transform, extract, and load (TEL).</span></span> <span data-ttu-id="46b0f-198">使用此方法时，将在分布式数据存储中处理数据，将其转换为所需的结构，然后将转换后的数据移动到分析数据存储中。</span><span class="sxs-lookup"><span data-stu-id="46b0f-198">With this approach, the data is processed within the distributed data store, transforming it to the required structure, before moving the transformed data into an analytical data store.</span></span>

- <span data-ttu-id="46b0f-199">**平衡利用率和时间成本**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-199">**Balance utilization and time costs**.</span></span> <span data-ttu-id="46b0f-200">对于批处理作业，请务必考虑两个因素：计算节点的每单位成本，以及使用这些节点完成作业的每分钟成本。</span><span class="sxs-lookup"><span data-stu-id="46b0f-200">For batch processing jobs, it's important to consider two factors: The per-unit cost of the compute nodes, and the per-minute cost of using those nodes to complete the job.</span></span> <span data-ttu-id="46b0f-201">例如，某个批处理作业可能需要四个群集节点并花费八个小时。</span><span class="sxs-lookup"><span data-stu-id="46b0f-201">For example, a batch job may take eight hours with four cluster nodes.</span></span> <span data-ttu-id="46b0f-202">但是，该作业可能只是在前两个小时内使用所有四个节点，在那之后，可能只需要两个节点。</span><span class="sxs-lookup"><span data-stu-id="46b0f-202">However, it might turn out that the job uses all four nodes only during the first two hours, and after that, only two nodes are required.</span></span> <span data-ttu-id="46b0f-203">在这种情况下，在两个节点上运行整个作业将增加总的作业时间，但是不会使其翻倍，因此总成本更低。</span><span class="sxs-lookup"><span data-stu-id="46b0f-203">In that case, running the entire job on two nodes would increase the total job time, but would not double it, so the total cost would be less.</span></span> <span data-ttu-id="46b0f-204">在某些业务方案中，与使用利用率低下的群集资源而导致更高的成本相比，延长处理时间可能更为合适。</span><span class="sxs-lookup"><span data-stu-id="46b0f-204">In some business scenarios, a longer processing time may be preferable to the higher cost of using under-utilized cluster resources.</span></span>

- <span data-ttu-id="46b0f-205">**单独的群集资源**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-205">**Separate cluster resources**.</span></span> <span data-ttu-id="46b0f-206">在部署 HDInsight 群集时，通常会通过为每种类型的工作负荷预配单独的群集资源来获得更好的性能。</span><span class="sxs-lookup"><span data-stu-id="46b0f-206">When deploying HDInsight clusters, you will normally achieve better performance by provisioning separate cluster resources for each type of workload.</span></span> <span data-ttu-id="46b0f-207">例如，尽管 Spark 群集包括 Hive，但是，如果需要通过 Hive 和 Spark 执行大量处理，则应当考虑部署单独的专用 Spark 和 Hadoop 群集。</span><span class="sxs-lookup"><span data-stu-id="46b0f-207">For example, although Spark clusters include Hive, if you need to perform extensive processing with both Hive and Spark, you should consider deploying separate dedicated Spark and Hadoop clusters.</span></span> <span data-ttu-id="46b0f-208">类似地，如果使用 HBase 和 Storm 进行低延迟流处理并使用 Hive 进行批处理，请考虑为 Storm、HBase 和 Hadoop 部署单独的群集。</span><span class="sxs-lookup"><span data-stu-id="46b0f-208">Similarly, if you are using HBase and Storm for low latency stream processing and Hive for batch processing, consider separate clusters for Storm, HBase, and Hadoop.</span></span>

- <span data-ttu-id="46b0f-209">**安排数据引入**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-209">**Orchestrate data ingestion**.</span></span> <span data-ttu-id="46b0f-210">在某些情况下，现有业务应用程序可以将用于批处理的数据文件直接写入到 Azure 存储 Blob 容器中，HDInsight 或 Azure Data Lake Analytics 可以从该容器中使用这些数据文件。</span><span class="sxs-lookup"><span data-stu-id="46b0f-210">In some cases, existing business applications may write data files for batch processing directly into Azure storage blob containers, where they can be consumed by HDInsight or Azure Data Lake Analytics.</span></span> <span data-ttu-id="46b0f-211">不过，你通常需要安排将数据从内部或外部数据源引入到 Data Lake 中。</span><span class="sxs-lookup"><span data-stu-id="46b0f-211">However, you will often need to orchestrate the ingestion of data from on-premises or external data sources into the data lake.</span></span> <span data-ttu-id="46b0f-212">可以使用某个业务流程工作流或管道（例如 Azure 数据工厂或 Oozie 支持的那些）以可预测且可集中管理的方式实现此目的。</span><span class="sxs-lookup"><span data-stu-id="46b0f-212">Use an orchestration workflow or pipeline, such as those supported by Azure Data Factory or Oozie, to achieve this in a predictable and centrally manageable fashion.</span></span>

- <span data-ttu-id="46b0f-213">**尽早清理敏感数据**。</span><span class="sxs-lookup"><span data-stu-id="46b0f-213">**Scrub sensitive data early**.</span></span> <span data-ttu-id="46b0f-214">在此过程中，数据引入工作流应当尽早清理敏感数据以避免将其存储在 Data Lake 中。</span><span class="sxs-lookup"><span data-stu-id="46b0f-214">The data ingestion workflow should scrub sensitive data early in the process, to avoid storing it in the data lake.</span></span>

## <a name="iot-architecture"></a><span data-ttu-id="46b0f-215">IoT 架构</span><span class="sxs-lookup"><span data-stu-id="46b0f-215">IoT architecture</span></span>

<span data-ttu-id="46b0f-216">物联网 (IoT) 是大数据解决方案的专用子网。</span><span class="sxs-lookup"><span data-stu-id="46b0f-216">Internet of Things (IoT) is a specialized subset of big data solutions.</span></span> <span data-ttu-id="46b0f-217">下列图表显示 IoT 可能出现的逻辑架构。</span><span class="sxs-lookup"><span data-stu-id="46b0f-217">The following diagram shows a possible logical architecture for IoT.</span></span> <span data-ttu-id="46b0f-218">此图表强调架构的事件流式传输组件。</span><span class="sxs-lookup"><span data-stu-id="46b0f-218">The diagram emphasizes the event-streaming components of the architecture.</span></span>

![IoT 体系结构图](./images/iot.png)

<span data-ttu-id="46b0f-220">云网关使用可靠、低延迟的消息传递系统在云边界引入设备事件。</span><span class="sxs-lookup"><span data-stu-id="46b0f-220">The **cloud gateway** ingests device events at the cloud boundary, using a reliable, low latency messaging system.</span></span>

<span data-ttu-id="46b0f-221">设备可能会直接将事件发送到云网关，或通过现场网关发送。</span><span class="sxs-lookup"><span data-stu-id="46b0f-221">Devices might send events directly to the cloud gateway, or through a **field gateway**.</span></span> <span data-ttu-id="46b0f-222">现场网关是一种专用设备或软件，通常与接收事件并将事件转接到云网关的设备位于同一位置。</span><span class="sxs-lookup"><span data-stu-id="46b0f-222">A field gateway is a specialized device or software, usually colocated with the devices, that receives events and forwards them to the cloud gateway.</span></span> <span data-ttu-id="46b0f-223">现场网关也可预处理原始设备事件，执行过滤、聚合或协议转换等功能。</span><span class="sxs-lookup"><span data-stu-id="46b0f-223">The field gateway might also preprocess the raw device events, performing functions such as filtering, aggregation, or protocol transformation.</span></span>

<span data-ttu-id="46b0f-224">引入后，事件将通过一个或多个流处理器，此处理器可将数据路由到存储等位置，也可执行分析和其他处理。</span><span class="sxs-lookup"><span data-stu-id="46b0f-224">After ingestion, events go through one or more **stream processors** that can route the data (for example, to storage) or perform analytics and other processing.</span></span>

<span data-ttu-id="46b0f-225">下面是一些常见的处理类型。</span><span class="sxs-lookup"><span data-stu-id="46b0f-225">The following are some common types of processing.</span></span> <span data-ttu-id="46b0f-226">（此列表并未囊括所有类型。）</span><span class="sxs-lookup"><span data-stu-id="46b0f-226">(This list is certainly not exhaustive.)</span></span>

- <span data-ttu-id="46b0f-227">将事件数据写入冷存储，用于存档或批处理分析。</span><span class="sxs-lookup"><span data-stu-id="46b0f-227">Writing event data to cold storage, for archiving or batch analytics.</span></span>

- <span data-ttu-id="46b0f-228">热路径分析，实时（或近乎实时）分析事件流，以检测异常，识别滚动时间范围内的模式，或者在流中出现特殊情况时触发警报。</span><span class="sxs-lookup"><span data-stu-id="46b0f-228">Hot path analytics, analyzing the event stream in (near) real time, to detect anomalies, recognize patterns over rolling time windows, or trigger alerts when a specific condition occurs in the stream.</span></span>

- <span data-ttu-id="46b0f-229">处理设备中特殊类型的非遥测消息，例如通知和警报。</span><span class="sxs-lookup"><span data-stu-id="46b0f-229">Handling special types of non-telemetry messages from devices, such as notifications and alarms.</span></span>

- <span data-ttu-id="46b0f-230">机器学习。</span><span class="sxs-lookup"><span data-stu-id="46b0f-230">Machine learning.</span></span>

<span data-ttu-id="46b0f-231">具有灰色阴影的框表示 IoT 系统的组件，虽然这些组件与事件流式传输没有直接关系，但为了完整起见，仍在此处提出。</span><span class="sxs-lookup"><span data-stu-id="46b0f-231">The boxes that are shaded gray show components of an IoT system that are not directly related to event streaming, but are included here for completeness.</span></span>

- <span data-ttu-id="46b0f-232">设备注册表是预配设备的数据库，包括设备 ID 和常见的设备元数据，如位置信息。</span><span class="sxs-lookup"><span data-stu-id="46b0f-232">The **device registry** is a database of the provisioned devices, including the device IDs and usually device metadata, such as location.</span></span>

- <span data-ttu-id="46b0f-233">预配 API 是一种常见的外部接口，用于预配和注册新设备。</span><span class="sxs-lookup"><span data-stu-id="46b0f-233">The **provisioning API** is a common external interface for provisioning and registering new devices.</span></span>

- <span data-ttu-id="46b0f-234">某些 IoT 解决方案可使命令和控制消息发送到设备。</span><span class="sxs-lookup"><span data-stu-id="46b0f-234">Some IoT solutions allow **command and control messages** to be sent to devices.</span></span>

> <span data-ttu-id="46b0f-235">本部分介绍了 IoT 的极高级别视图，需要考虑许多细微问题和挑战。</span><span class="sxs-lookup"><span data-stu-id="46b0f-235">This section has presented a very high-level view of IoT, and there are many subtleties and challenges to consider.</span></span> <span data-ttu-id="46b0f-236">要获取更为详细的参考架构和讨论，请参阅 [Microsoft Azure IoT 参考架构][iot-ref-arch]（PDF 下载）。</span><span class="sxs-lookup"><span data-stu-id="46b0f-236">For a more detailed reference architecture and discussion, see the [Microsoft Azure IoT Reference Architecture][iot-ref-arch] (PDF download).</span></span>

## <a name="next-steps"></a><span data-ttu-id="46b0f-237">后续步骤</span><span class="sxs-lookup"><span data-stu-id="46b0f-237">Next steps</span></span>

- <span data-ttu-id="46b0f-238">详细了解[大数据体系结构](../../data-guide/big-data/index.md)。</span><span class="sxs-lookup"><span data-stu-id="46b0f-238">Learn more about [big data architectures](../../data-guide/big-data/index.md).</span></span>

 <!-- links -->

[iot-ref-arch]: https://azure.microsoft.com/updates/microsoft-azure-iot-reference-architecture-available/
